!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.GSD=t():r.GSD=t()}("undefined"!=typeof self?self:this,function(){return function(r){var t={};function e(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return r[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=r,e.c=t,e.d=function(r,t,n){e.o(r,t)||Object.defineProperty(r,t,{enumerable:!0,get:n})},e.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,t){if(1&t&&(r=e(r)),8&t)return r;if(4&t&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&t&&"string"!=typeof r)for(var o in r)e.d(n,o,function(t){return r[t]}.bind(null,o));return n},e.n=function(r){var t=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(t,"a",t),t},e.o=function(r,t){return Object.prototype.hasOwnProperty.call(r,t)},e.p="",e(e.s=13)}([function(r,t,e){"use strict";e(22);var n=e(7),o=e(3);class i extends(n(Array)){constructor(r,t){var e;if(1===arguments.length&&"number"==typeof r)return new Array(r);if(i.isMatrix(r))return r.clone();if(Number.isInteger(r)&&r>0){if(super(r),!(Number.isInteger(t)&&t>0))throw new TypeError("nColumns must be a positive integer");for(e=0;e<r;e++)this[e]=new Array(t)}else{if(!Array.isArray(r))throw new TypeError("First argument must be a positive number or an array");{const n=r;if(r=n.length,"number"!=typeof(t=n[0].length)||0===t)throw new TypeError("Data must be a 2D array with at least one element");for(super(r),e=0;e<r;e++){if(n[e].length!==t)throw new RangeError("Inconsistent array dimensions");this[e]=[].concat(n[e])}}}return this.rows=r,this.columns=t,this}set(r,t,e){return this[r][t]=e,this}get(r,t){return this[r][t]}clone(){for(var r=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)r.set(t,e,this.get(t,e));return r}removeRow(r){if(o.checkRowIndex(this,r),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(r,1),this.rows-=1,this}addRow(r,t){return void 0===t&&(t=r,r=this.rows),o.checkRowIndex(this,r,!0),t=o.checkRowVector(this,t,!0),this.splice(r,0,t),this.rows+=1,this}removeColumn(r){if(o.checkColumnIndex(this,r),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0;t<this.rows;t++)this[t].splice(r,1);return this.columns-=1,this}addColumn(r,t){void 0===t&&(t=r,r=this.columns),o.checkColumnIndex(this,r,!0),t=o.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)this[e].splice(r,0,t[e]);return this.columns+=1,this}}t.Matrix=i,i.abstractMatrix=n},function(r,t,e){"use strict";var n=e(7),o=e(0);r.exports=class extends(n()){constructor(r,t,e){super(),this.matrix=r,this.rows=t,this.columns=e}static get[Symbol.species](){return o.Matrix}}},function(r,t,e){"use strict";r.exports=e(0).Matrix,r.exports.Decompositions=r.exports.DC=e(35)},function(r,t,e){"use strict";var n=e(0);t.checkRowIndex=function(r,t,e){var n=e?r.rows:r.rows-1;if(t<0||t>n)throw new RangeError("Row index out of range")},t.checkColumnIndex=function(r,t,e){var n=e?r.columns:r.columns-1;if(t<0||t>n)throw new RangeError("Column index out of range")},t.checkRowVector=function(r,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==r.columns)throw new RangeError("vector size must be the same as the number of columns");return t},t.checkColumnVector=function(r,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==r.rows)throw new RangeError("vector size must be the same as the number of rows");return t},t.checkIndices=function(r,t,e){var n=t.some(t=>t<0||t>=r.rows),o=e.some(t=>t<0||t>=r.columns);if(n||o)throw new RangeError("Indices are out of range");if("object"!=typeof t||"object"!=typeof e)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(t)||(t=Array.from(t)),Array.isArray(e)||(t=Array.from(e)),{row:t,column:e}},t.checkRange=function(r,t,e,n,o){if(5!==arguments.length)throw new TypeError("Invalid argument type");var i=Array.from(arguments).slice(1).some(function(r){return"number"!=typeof r});if(i)throw new TypeError("Invalid argument type");if(t>e||n>o||t<0||t>=r.rows||e<0||e>=r.rows||n<0||n>=r.columns||o<0||o>=r.columns)throw new RangeError("Submatrix indices are out of range")},t.getRange=function(r,t){for(var e=new Array(t-r+1),n=0;n<e.length;n++)e[n]=r+n;return e},t.sumByRow=function(r){for(var t=n.Matrix.zeros(r.rows,1),e=0;e<r.rows;++e)for(var o=0;o<r.columns;++o)t.set(e,0,t.get(e,0)+r.get(e,o));return t},t.sumByColumn=function(r){for(var t=n.Matrix.zeros(1,r.columns),e=0;e<r.rows;++e)for(var o=0;o<r.columns;++o)t.set(0,o,t.get(0,o)+r.get(e,o));return t},t.sumAll=function(r){for(var t=0,e=0;e<r.rows;e++)for(var n=0;n<r.columns;n++)t+=r.get(e,n);return t}},function(r,t,e){"use strict";t.hypotenuse=function(r,t){var e;return Math.abs(r)>Math.abs(t)?(e=t/r,Math.abs(r)*Math.sqrt(1+e*e)):0!==t?(e=r/t,Math.abs(t)*Math.sqrt(1+e*e)):0},t.getEmpty2DArray=function(r,t){for(var e=new Array(r),n=0;n<r;n++)e[n]=new Array(t);return e},t.getFilled2DArray=function(r,t,e){for(var n=new Array(r),o=0;o<r;o++){n[o]=new Array(t);for(var i=0;i<t;i++)n[o][i]=e}return n}},function(r,t,e){"use strict";function n(r,t){return r-t}t.sum=function(r){for(var t=0,e=0;e<r.length;e++)t+=r[e];return t},t.max=function(r){for(var t=-1/0,e=r.length,n=0;n<e;n++)r[n]>t&&(t=r[n]);return t},t.min=function(r){for(var t=1/0,e=r.length,n=0;n<e;n++)r[n]<t&&(t=r[n]);return t},t.minMax=function(r){for(var t=1/0,e=-1/0,n=r.length,o=0;o<n;o++)r[o]<t&&(t=r[o]),r[o]>e&&(e=r[o]);return{min:t,max:e}},t.arithmeticMean=function(r){for(var t=0,e=r.length,n=0;n<e;n++)t+=r[n];return t/e},t.mean=t.arithmeticMean,t.geometricMean=function(r){for(var t=1,e=r.length,n=0;n<e;n++)t*=r[n];return Math.pow(t,1/e)},t.logMean=function(r){for(var t=0,e=r.length,n=0;n<e;n++)t+=Math.log(r[n]);return t/e},t.grandMean=function(r,t){for(var e=0,n=0,o=r.length,i=0;i<o;i++)e+=t[i]*r[i],n+=t[i];return e/n},t.truncatedMean=function(r,t,e){void 0===e&&(e=!1),e||(r=r.slice().sort(n));for(var o=r.length,i=Math.floor(o*t),a=0,s=i;s<o-i;s++)a+=r[s];return a/(o-2*i)},t.harmonicMean=function(r){for(var t=0,e=r.length,n=0;n<e;n++){if(0===r[n])throw new RangeError("value at index "+n+"is zero");t+=1/r[n]}return e/t},t.contraHarmonicMean=function(r){for(var t=0,e=0,n=r.length,o=0;o<n;o++)t+=r[o]*r[o],e+=r[o];if(e<0)throw new RangeError("sum of values is negative");return t/e},t.median=function(r,t){void 0===t&&(t=!1),t||(r=r.slice().sort(n));var e=r.length,o=Math.floor(e/2);return e%2==0?.5*(r[o-1]+r[o]):r[o]},t.variance=function(r,e){void 0===e&&(e=!0);for(var n=t.mean(r),o=0,i=r.length,a=0;a<i;a++){var s=r[a]-n;o+=s*s}return e?o/(i-1):o/i},t.standardDeviation=function(r,e){return Math.sqrt(t.variance(r,e))},t.standardError=function(r){return t.standardDeviation(r)/Math.sqrt(r.length)},t.quartiles=function(r,e){void 0===e&&(e=!1),e||(r=r.slice()).sort(n);var o=r.length/4;return{q1:r[Math.ceil(o)-1],q2:t.median(r,!0),q3:r[Math.ceil(3*o)-1]}},t.pooledStandardDeviation=function(r,e){return Math.sqrt(t.pooledVariance(r,e))},t.pooledVariance=function(r,e){void 0===e&&(e=!0);for(var n=0,o=0,i=r.length,a=0;a<i;a++){var s=r[a],h=t.variance(s);n+=(s.length-1)*h,o+=e?s.length-1:s.length}return n/o},t.mode=function(r){var t,e=r.length,n=new Array(e);for(t=0;t<e;t++)n[t]=0;var o=new Array(e),i=0;for(t=0;t<e;t++){var a=o.indexOf(r[t]);a>=0?n[a]++:(o[i]=r[t],n[i]=1,i++)}var s=0,h=0;for(t=0;t<i;t++)n[t]>s&&(s=n[t],h=t);return o[h]},t.covariance=function(r,e,n){void 0===n&&(n=!0);var o=t.mean(r),i=t.mean(e);if(r.length!==e.length)throw"Vectors do not have the same dimensions";for(var a=0,s=r.length,h=0;h<s;h++){a+=(r[h]-o)*(e[h]-i)}return n?a/(s-1):a/s},t.skewness=function(r,e){void 0===e&&(e=!0);for(var n=t.mean(r),o=0,i=0,a=r.length,s=0;s<a;s++){var h=r[s]-n;o+=h*h,i+=h*h*h}var u=o/a,l=i/a/Math.pow(u,1.5);return e?Math.sqrt(a*(a-1))/(a-2)*l:l},t.kurtosis=function(r,e){void 0===e&&(e=!0);for(var n=t.mean(r),o=r.length,i=0,a=0,s=0;s<o;s++){var h=r[s]-n;i+=h*h,a+=h*h*h*h}var u=i/o;if(e){var l=i/(o-1);return o*(o+1)/((o-1)*(o-2)*(o-3))*(a/(l*l))-3*((o-1)*(o-1)/((o-2)*(o-3)))}return a/o/(u*u)-3},t.entropy=function(r,t){void 0===t&&(t=0);for(var e=0,n=r.length,o=0;o<n;o++)e+=r[o]*Math.log(r[o]+t);return-e},t.weightedMean=function(r,t){for(var e=0,n=r.length,o=0;o<n;o++)e+=r[o]*t[o];return e},t.weightedStandardDeviation=function(r,e){return Math.sqrt(t.weightedVariance(r,e))},t.weightedVariance=function(r,e){for(var n=t.weightedMean(r,e),o=0,i=r.length,a=0,s=0,h=0;h<i;h++){var u=r[h]-n,l=e[h];o+=l*(u*u),s+=l,a+=l*l}return o*(s/(s*s-a))},t.center=function(r,e){void 0===e&&(e=!1);var n=r;e||(n=r.slice());for(var o=t.mean(n),i=n.length,a=0;a<i;a++)n[a]-=o},t.standardize=function(r,e,n){void 0===e&&(e=t.standardDeviation(r)),void 0===n&&(n=!1);for(var o=r.length,i=n?r:new Array(o),a=0;a<o;a++)i[a]=r[a]/e;return i},t.cumulativeSum=function(r){var t=r.length,e=new Array(t);e[0]=r[0];for(var n=1;n<t;n++)e[n]=e[n-1]+r[n];return e}},function(r,t,e){"use strict";var n=e(20),o=n.Matrix.algebra,i=e(2);function a(r,t,e){var n,o,a,s,h=t.length/3,u=r.rows,l=i.zeros(r.length,1);for(o=0;o<h;o++)for(s=Math.pow(t[o+2*h][0]/2,2),n=t[o+h][0]*s,a=0;a<u;a++)l[a][0]+=n/(Math.pow(r[a][0]-t[o][0],2)+s);return l}function s(r,t,e){for(var n=t[1][0]*Math.pow(t[2][0]/2,2),o=r.rows,a=new i(r.rows,r.columns),s=0;s<o;s++)a[s][0]=n/(Math.pow(r[s][0]-t[0][0],2)+Math.pow(t[2][0]/2,2));return a}function h(r,t,e){for(var n=t[2][0]*t[2][0]/2,o=r.rows,a=new i(r.rows,r.columns),s=0;s<o;s++)a[s][0]=t[1][0]*Math.exp(-(r[s][0]-t[0][0])*(r[s][0]-t[0][0])/n);return a}function u(r,t,e){var o=f(r,(e=e||{}).percentage||0);if(null===o||o[0].rows<3)return null;var a=o[0],h=o[1],u=o[2],l=[a.rows/Math.sqrt(h.dot(h))],c=(e=Object.create(e.LMOptions||[3,100,.001,.001,.001,.01,.01,11,9,1]),Math.abs(a[0][0]-a[1][0])),m=new i([[-c/1e4],[-.001],[-c/1e4]]),v=new i([[t.x],[1],[t.width]]),g=new i([[t.x-c],[.75],[t.width/4]]),w=new i([[t.x+c],[1.25],[4*t.width]]),d=n.optimize(s,v,a,h,l,m,g,w,[],e);return[(d=d.p)[0],[d[1][0]*u],d[2]]}function l(r,t,e){var o=f(r,(e=e||{}).percentage||0);if(null===o||o[0].rows<3)return null;var a=o[0],s=o[1],u=o[2],l=[a.rows/Math.sqrt(s.dot(s))],c=(e=Object.create(e.LMOptions||[3,100,.001,.001,.001,.01,.01,11,9,1]),Math.abs(a[0][0]-a[1][0])),m=new i([[-c/1e4],[-.001],[-c/1e4]]),v=(m=new i([[-Math.abs(a[0][0]-a[1][0])/1e3],[-.001],[-t.width/1e3]]),new i([[t.x],[1],[t.width]])),g=new i([[t.x-c],[.75],[t.width/4]]),w=new i([[t.x+c],[1.25],[4*t.width]]),d=n.optimize(h,v,a,s,l,m,g,w,[],e);return[(d=d.p)[0],[d[1][0]*u],d[2]]}function f(r,t){var e,n,o,a=r.length,s=null,h=null,u=0;if(2==a){var l=r[0].length;if(s=new Array(l),h=new Array(l),e=r[0],n=r[1],"number"==typeof e[0])for(o=0;o<l;o++)s[o]=e[o],h[o]=n[o],n[o]>u&&(u=n[o]);else if("object"==typeof e[0])for(o=0;o<l;o++)s[o]=e[o][0],h[o]=n[o][0],n[o][0]>u&&(u=n[o][0])}else{l=a;for(s=new Array(l),h=new Array(l),o=0;o<l;o++)s[o]=r[o][0],h[o]=r[o][1],h[o]>u&&(u=h[o])}for(o=0;o<l;o++)h[o]/=u;if(t)for(o=l-1;o>=0;o--)h[o]<t&&(h.splice(o,1),s.splice(o,1));return s.length>0?[new i([s]).transpose(),new i([h]).transpose(),u]:null}r.exports.optimizeSingleLorentzian=u,r.exports.optimizeLorentzianSum=function(r,t,e){var s=f(r);if(null===s||s[0].rows<3)return null;var h,u=s[0],l=s[1],c=s[2],m=[u.rows/o.sqrt(l.dot(l))],v=(e=Object.create(e||[3,100,.001,.001,.001,.01,.01,11,9,1]),t.length),g=new i(3*v,1),w=new i(3*v,1),d=new i(3*v,1),p=new i(3*v,1),M=Math.abs(u[0][0]-u[1][0]);for(h=0;h<v;h++)g[h][0]=t[h].x,g[h+v][0]=1,g[h+2*v][0]=t[h].width,w[h][0]=t[h].x-M,w[h+v][0]=0,w[h+2*v][0]=t[h].width/4,d[h][0]=t[h].x+M,d[h+v][0]=1.5,d[h+2*v][0]=4*t[h].width,p[h][0]=-M/1e3,p[h+v][0]=-.001,p[h+2*v][0]=-M/1e3;p=-Math.abs(u[0][0]-u[1][0])/1e4;var x=n.optimize(a,g,u,l,m,p,w,d,[],e);x=x.p;var y=new Array(v);for(h=0;h<v;h++)y[h]=[x[h],[x[h+v][0]*c],x[h+2*v]];return y},r.exports.optimizeSingleGaussian=l,r.exports.optimizeGaussianSum=function(r,t,e){var s=f(r);if(null===s||s[0].rows<3)return null;var h,u=s[0],l=s[1],c=s[2],m=u.rows,v=new i(m,1),g=m/o.sqrt(l.dot(l));for(h=0;h<m;h++)v[h][0]=g;e=Object.create(e||[3,100,.001,.001,.001,.01,.01,11,9,2]);var w=t.length,d=new i(3*w,1),p=new i(3*w,1),M=new i(3*w,1),x=new i(3*w,1),y=Math.abs(u[0][0]-u[1][0]);for(h=0;h<w;h++)d[h][0]=t[h].x,d[h+w][0]=t[h].y/c,d[h+2*w][0]=t[h].width,p[h][0]=t[h].x-y,p[h+w][0]=.8*t[h].y/c,p[h+2*w][0]=t[h].width/2,M[h][0]=t[h].x+y,M[h+w][0]=1.2*t[h].y/c,M[h+2*w][0]=2*t[h].width,x[h][0]=-y/1e3,x[h+w][0]=-.001,x[h+2*w][0]=-y/1e3;var b=n.optimize(a,d,u,l,v,x,p,M,[],e);b=b.p;var A=new Array(w);for(h=0;h<w;h++)A[h]=[b[h],[b[h+w][0]*c],b[h+2*w]];return A},r.exports.singleGaussian=h,r.exports.singleLorentzian=s,r.exports.optimizeGaussianTrain=function(r,t,e){var n=f(r);if(null===n||n[0].rows<3)return null;for(var o,i,a,s,h=n[0],u=n[1],c=n[2],m=0,v=h.length,g=[],w=0;w<t.length;w++){for(o=t[w].x-1.5*t[w].width;h[m++]<o&&m<v;);for(o=t[w].x+1.5*t[w].width,i=[],a=[];h[m]<=o&&m<v;)i.push(h[m][0]),a.push(u[m][0]*c),m++;(s=l([i,a],t[w],e))?g.push({x:s[0][0],y:s[1][0],width:s[2][0],opt:!0}):g.push({x:t[w].x,y:t[w].y,width:t[w].width,opt:!1})}return g},r.exports.optimizeLorentzianTrain=function(r,t,e){var n=f(r);if(null===n||n[0].rows<3)return null;for(var o,i,a,s,h=n[0],l=n[1],c=n[2],m=0,v=h.length,g=[],w=0;w<t.length;w++){for(o=t[w].x-1.5*t[w].width;h[m++]<o&&m<v;);for(o=t[w].x+1.5*t[w].width,i=[],a=[];h[m]<=o&&m<v;)i.push(h[m][0]),a.push(l[m][0]*c),m++;(s=u([i,a],t[w],e))?g.push({x:s[0][0],y:s[1][0],width:s[2][0],opt:!0}):g.push({x:t[w].x,y:t[w].y,width:t[w].width,opt:!1})}return g}},function(module,exports,__webpack_require__){"use strict";module.exports=abstractMatrix;var LuDecomposition=__webpack_require__(8),SvDecomposition=__webpack_require__(9),arrayUtils=__webpack_require__(23),util=__webpack_require__(3),MatrixTransposeView=__webpack_require__(28),MatrixRowView=__webpack_require__(29),MatrixSubView=__webpack_require__(30),MatrixSelectionView=__webpack_require__(31),MatrixColumnView=__webpack_require__(32),MatrixFlipRowView=__webpack_require__(33),MatrixFlipColumnView=__webpack_require__(34);function abstractMatrix(superCtor){void 0===superCtor&&(superCtor=Object);class Matrix extends superCtor{static get[Symbol.species](){return this}static from1DArray(r,t,e){if(r*t!==e.length)throw new RangeError("Data length does not match given dimensions");for(var n=new this(r,t),o=0;o<r;o++)for(var i=0;i<t;i++)n.set(o,i,e[o*t+i]);return n}static rowVector(r){for(var t=new this(1,r.length),e=0;e<r.length;e++)t.set(0,e,r[e]);return t}static columnVector(r){for(var t=new this(r.length,1),e=0;e<r.length;e++)t.set(e,0,r[e]);return t}static empty(r,t){return new this(r,t)}static zeros(r,t){return this.empty(r,t).fill(0)}static ones(r,t){return this.empty(r,t).fill(1)}static rand(r,t,e){void 0===e&&(e=Math.random);for(var n=this.empty(r,t),o=0;o<r;o++)for(var i=0;i<t;i++)n.set(o,i,e());return n}static randInt(r,t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=Math.random);for(var o=this.empty(r,t),i=0;i<r;i++)for(var a=0;a<t;a++){var s=Math.floor(n()*e);o.set(i,a,s)}return o}static eye(r,t,e){void 0===t&&(t=r),void 0===e&&(e=1);for(var n=Math.min(r,t),o=this.zeros(r,t),i=0;i<n;i++)o.set(i,i,e);return o}static diag(r,t,e){var n=r.length;void 0===t&&(t=n),void 0===e&&(e=t);for(var o=Math.min(n,t,e),i=this.zeros(t,e),a=0;a<o;a++)i.set(a,a,r[a]);return i}static min(r,t){r=this.checkMatrix(r),t=this.checkMatrix(t);for(var e=r.rows,n=r.columns,o=new this(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)o.set(i,a,Math.min(r.get(i,a),t.get(i,a)));return o}static max(r,t){r=this.checkMatrix(r),t=this.checkMatrix(t);for(var e=r.rows,n=r.columns,o=new this(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)o.set(i,a,Math.max(r.get(i,a),t.get(i,a)));return o}static checkMatrix(r){return Matrix.isMatrix(r)?r:new this(r)}static isMatrix(r){return null!=r&&"Matrix"===r.klass}get size(){return this.rows*this.columns}apply(r){if("function"!=typeof r)throw new TypeError("callback must be a function");for(var t=this.rows,e=this.columns,n=0;n<t;n++)for(var o=0;o<e;o++)r.call(this,n,o);return this}to1DArray(){for(var r=new Array(this.size),t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)r[t*this.columns+e]=this.get(t,e);return r}to2DArray(){for(var r=new Array(this.rows),t=0;t<this.rows;t++){r[t]=new Array(this.columns);for(var e=0;e<this.columns;e++)r[t][e]=this.get(t,e)}return r}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var r=0;r<this.rows;r++)for(var t=0;t<=r;t++)if(this.get(r,t)!==this.get(t,r))return!1;return!0}return!1}set(r,t,e){throw new Error("set method is unimplemented")}get(r,t){throw new Error("get method is unimplemented")}repeat(r,t){r=r||1,t=t||1;for(var e=new this.constructor[Symbol.species](this.rows*r,this.columns*t),n=0;n<r;n++)for(var o=0;o<t;o++)e.setSubMatrix(this,this.rows*n,this.columns*o);return e}fill(r){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,r);return this}neg(){return this.mulS(-1)}getRow(r){util.checkRowIndex(this,r);for(var t=new Array(this.columns),e=0;e<this.columns;e++)t[e]=this.get(r,e);return t}getRowVector(r){return this.constructor.rowVector(this.getRow(r))}setRow(r,t){util.checkRowIndex(this,r),t=util.checkRowVector(this,t);for(var e=0;e<this.columns;e++)this.set(r,e,t[e]);return this}swapRows(r,t){util.checkRowIndex(this,r),util.checkRowIndex(this,t);for(var e=0;e<this.columns;e++){var n=this.get(r,e);this.set(r,e,this.get(t,e)),this.set(t,e,n)}return this}getColumn(r){util.checkColumnIndex(this,r);for(var t=new Array(this.rows),e=0;e<this.rows;e++)t[e]=this.get(e,r);return t}getColumnVector(r){return this.constructor.columnVector(this.getColumn(r))}setColumn(r,t){util.checkColumnIndex(this,r),t=util.checkColumnVector(this,t);for(var e=0;e<this.rows;e++)this.set(e,r,t[e]);return this}swapColumns(r,t){util.checkColumnIndex(this,r),util.checkColumnIndex(this,t);for(var e=0;e<this.rows;e++){var n=this.get(e,r);this.set(e,r,this.get(e,t)),this.set(e,t,n)}return this}addRowVector(r){r=util.checkRowVector(this,r);for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)+r[e]);return this}subRowVector(r){r=util.checkRowVector(this,r);for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)-r[e]);return this}mulRowVector(r){r=util.checkRowVector(this,r);for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r[e]);return this}divRowVector(r){r=util.checkRowVector(this,r);for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)/r[e]);return this}addColumnVector(r){r=util.checkColumnVector(this,r);for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)+r[t]);return this}subColumnVector(r){r=util.checkColumnVector(this,r);for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)-r[t]);return this}mulColumnVector(r){r=util.checkColumnVector(this,r);for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r[t]);return this}divColumnVector(r){r=util.checkColumnVector(this,r);for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)/r[t]);return this}mulRow(r,t){util.checkRowIndex(this,r);for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t);return this}mulColumn(r,t){util.checkColumnIndex(this,r);for(var e=0;e<this.rows;e++)this.set(e,r,this.get(e,r)*t);return this}max(){for(var r=this.get(0,0),t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.get(t,e)>r&&(r=this.get(t,e));return r}maxIndex(){for(var r=this.get(0,0),t=[0,0],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>r&&(r=this.get(e,n),t[0]=e,t[1]=n);return t}min(){for(var r=this.get(0,0),t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.get(t,e)<r&&(r=this.get(t,e));return r}minIndex(){for(var r=this.get(0,0),t=[0,0],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<r&&(r=this.get(e,n),t[0]=e,t[1]=n);return t}maxRow(r){util.checkRowIndex(this,r);for(var t=this.get(r,0),e=1;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}maxRowIndex(r){util.checkRowIndex(this,r);for(var t=this.get(r,0),e=[r,0],n=1;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[1]=n);return e}minRow(r){util.checkRowIndex(this,r);for(var t=this.get(r,0),e=1;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}minRowIndex(r){util.checkRowIndex(this,r);for(var t=this.get(r,0),e=[r,0],n=1;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[1]=n);return e}maxColumn(r){util.checkColumnIndex(this,r);for(var t=this.get(0,r),e=1;e<this.rows;e++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxColumnIndex(r){util.checkColumnIndex(this,r);for(var t=this.get(0,r),e=[0,r],n=1;n<this.rows;n++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n);return e}minColumn(r){util.checkColumnIndex(this,r);for(var t=this.get(0,r),e=1;e<this.rows;e++)this.get(e,r)<t&&(t=this.get(e,r));return t}minColumnIndex(r){util.checkColumnIndex(this,r);for(var t=this.get(0,r),e=[0,r],n=1;n<this.rows;n++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n);return e}diag(){for(var r=Math.min(this.rows,this.columns),t=new Array(r),e=0;e<r;e++)t[e]=this.get(e,e);return t}sum(r){switch(r){case"row":return util.sumByRow(this);case"column":return util.sumByColumn(this);default:return util.sumAll(this)}}mean(){return this.sum()/this.size}prod(){for(var r=1,t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)r*=this.get(t,e);return r}cumulativeSum(){for(var r=0,t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)r+=this.get(t,e),this.set(t,e,r);return this}dot(r){Matrix.isMatrix(r)&&(r=r.to1DArray());var t=this.to1DArray();if(t.length!==r.length)throw new RangeError("vectors do not have the same size");for(var e=0,n=0;n<t.length;n++)e+=t[n]*r[n];return e}mmul(r){r=this.constructor.checkMatrix(r),this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var t=this.rows,e=this.columns,n=r.columns,o=new this.constructor[Symbol.species](t,n),i=new Array(e),a=0;a<n;a++){for(var s=0;s<e;s++)i[s]=r.get(s,a);for(var h=0;h<t;h++){var u=0;for(s=0;s<e;s++)u+=this.get(h,s)*i[s];o.set(h,a,u)}}return o}strassen2x2(r){var t=new this.constructor[Symbol.species](2,2);const e=this.get(0,0),n=r.get(0,0),o=this.get(0,1),i=r.get(0,1),a=this.get(1,0),s=r.get(1,0),h=this.get(1,1),u=r.get(1,1),l=(e+h)*(n+u),f=(a+h)*n,c=e*(i-u),m=h*(s-n),v=(e+o)*u,g=l+m-v+(o-h)*(s+u),w=c+v,d=f+m,p=l-f+c+(a-e)*(n+i);return t.set(0,0,g),t.set(0,1,w),t.set(1,0,d),t.set(1,1,p),t}strassen3x3(r){var t=new this.constructor[Symbol.species](3,3);const e=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),h=this.get(2,0),u=this.get(2,1),l=this.get(2,2),f=r.get(0,0),c=r.get(0,1),m=r.get(0,2),v=r.get(1,0),g=r.get(1,1),w=r.get(1,2),d=r.get(2,0),p=r.get(2,1),M=r.get(2,2),x=(e-i)*(-c+g),y=(-e+i+a)*(f-c+g),b=(i+a)*(-f+c),A=e*f,S=(-e+h+u)*(f-m+w),k=(-e+h)*(m-w),R=(h+u)*(-f+m),V=(-o+u+l)*(g+d-p),_=(o-l)*(g-p),z=o*d,E=(u+l)*(-d+p),C=(-o+a+s)*(w+d-M),q=(o-s)*(w-M),D=(a+s)*(-d+M),I=A+z+n*v,j=(e+n+o-i-a-u-l)*g+y+b+A+V+z+E,O=A+S+R+(e+n+o-a-s-h-u)*w+z+C+D,W=x+a*(-f+c+v-g-w-d+M)+y+A+z+C+q,T=x+y+b+A+s*p,L=z+C+q+D+i*m,F=A+S+k+u*(-f+m+v-g-w-d+p)+V+_+z,N=V+_+z+E+h*c,P=A+S+k+R+l*M;return t.set(0,0,I),t.set(0,1,j),t.set(0,2,O),t.set(1,0,W),t.set(1,1,T),t.set(1,2,L),t.set(2,0,F),t.set(2,1,N),t.set(2,2,P),t}mmulStrassen(r){var t=this.clone(),e=t.rows,n=t.columns,o=r.rows,i=r.columns;function a(r,t,e){var n=r.rows,o=r.columns;if(n===t&&o===e)return r;var i=Matrix.zeros(t,e);return i=i.setSubMatrix(r,0,0)}n!==o&&console.warn("Multiplying ".concat(e," x ").concat(n," and ").concat(o," x ").concat(i," matrix: dimensions do not match."));var s=Math.max(e,o),h=Math.max(n,i);return function r(t,e,n,o){if(n<=512||o<=512)return t.mmul(e);n%2==1&&o%2==1?(t=a(t,n+1,o+1),e=a(e,n+1,o+1)):n%2==1?(t=a(t,n+1,o),e=a(e,n+1,o)):o%2==1&&(t=a(t,n,o+1),e=a(e,n,o+1));var i=parseInt(t.rows/2),s=parseInt(t.columns/2),h=t.subMatrix(0,i-1,0,s-1),u=e.subMatrix(0,i-1,0,s-1),l=t.subMatrix(0,i-1,s,t.columns-1),f=e.subMatrix(0,i-1,s,e.columns-1),c=t.subMatrix(i,t.rows-1,0,s-1),m=e.subMatrix(i,e.rows-1,0,s-1),v=t.subMatrix(i,t.rows-1,s,t.columns-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),w=r(Matrix.add(h,v),Matrix.add(u,g),i,s),d=r(Matrix.add(c,v),u,i,s),p=r(h,Matrix.sub(f,g),i,s),M=r(v,Matrix.sub(m,u),i,s),x=r(Matrix.add(h,l),g,i,s),y=r(Matrix.sub(c,h),Matrix.add(u,f),i,s),b=r(Matrix.sub(l,v),Matrix.add(m,g),i,s),A=Matrix.add(w,M);A.sub(x),A.add(b);var S=Matrix.add(p,x),k=Matrix.add(d,M),R=Matrix.sub(w,d);R.add(p),R.add(y);var V=Matrix.zeros(2*A.rows,2*A.columns);return(V=(V=(V=(V=V.setSubMatrix(A,0,0)).setSubMatrix(S,A.rows,0)).setSubMatrix(k,0,A.columns)).setSubMatrix(R,A.rows,A.columns)).subMatrix(0,n-1,0,o-1)}(t=a(t,s,h),r=a(r,s,h),s,h)}scaleRows(r,t){if((r=void 0===r?0:r)>=(t=void 0===t?1:t))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),n=0;n<this.rows;n++){var o=arrayUtils.scale(this.getRow(n),{min:r,max:t});e.setRow(n,o)}return e}scaleColumns(r,t){if((r=void 0===r?0:r)>=(t=void 0===t?1:t))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),n=0;n<this.columns;n++){var o=arrayUtils.scale(this.getColumn(n),{min:r,max:t});e.setColumn(n,o)}return e}kroneckerProduct(r){r=this.constructor.checkMatrix(r);for(var t=this.rows,e=this.columns,n=r.rows,o=r.columns,i=new this.constructor[Symbol.species](t*n,e*o),a=0;a<t;a++)for(var s=0;s<e;s++)for(var h=0;h<n;h++)for(var u=0;u<o;u++)i[n*a+h][o*s+u]=this.get(a,s)*r.get(h,u);return i}transpose(){for(var r=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)r.set(e,t,this.get(t,e));return r}sortRows(r){void 0===r&&(r=compareNumbers);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(r));return this}sortColumns(r){void 0===r&&(r=compareNumbers);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(r));return this}subMatrix(r,t,e,n){util.checkRange(this,r,t,e,n);for(var o=new this.constructor[Symbol.species](t-r+1,n-e+1),i=r;i<=t;i++)for(var a=e;a<=n;a++)o[i-r][a-e]=this.get(i,a);return o}subMatrixRow(r,t,e){if(void 0===t&&(t=0),void 0===e&&(e=this.columns-1),t>e||t<0||t>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](r.length,e-t+1),o=0;o<r.length;o++)for(var i=t;i<=e;i++){if(r[o]<0||r[o]>=this.rows)throw new RangeError("Row index out of range: "+r[o]);n.set(o,i-t,this.get(r[o],i))}return n}subMatrixColumn(r,t,e){if(void 0===t&&(t=0),void 0===e&&(e=this.rows-1),t>e||t<0||t>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](e-t+1,r.length),o=0;o<r.length;o++)for(var i=t;i<=e;i++){if(r[o]<0||r[o]>=this.columns)throw new RangeError("Column index out of range: "+r[o]);n.set(i-t,o,this.get(i,r[o]))}return n}setSubMatrix(r,t,e){var n=t+(r=this.constructor.checkMatrix(r)).rows-1,o=e+r.columns-1;util.checkRange(this,t,n,e,o);for(var i=0;i<r.rows;i++)for(var a=0;a<r.columns;a++)this[t+i][e+a]=r.get(i,a);return this}selection(r,t){for(var e=util.checkIndices(this,r,t),n=new this.constructor[Symbol.species](r.length,t.length),o=0;o<e.row.length;o++)for(var i=e.row[o],a=0;a<e.column.length;a++){var s=e.column[a];n[o][a]=this.get(i,s)}return n}trace(){for(var r=Math.min(this.rows,this.columns),t=0,e=0;e<r;e++)t+=this.get(e,e);return t}transposeView(){return new MatrixTransposeView(this)}rowView(r){return util.checkRowIndex(this,r),new MatrixRowView(this,r)}columnView(r){return util.checkColumnIndex(this,r),new MatrixColumnView(this,r)}flipRowView(){return new MatrixFlipRowView(this)}flipColumnView(){return new MatrixFlipColumnView(this)}subMatrixView(r,t,e,n){return new MatrixSubView(this,r,t,e,n)}selectionView(r,t){return new MatrixSelectionView(this,r,t)}det(){var r,t,e,n,o,i;if(this.isSquare())return 2===this.columns?(r=this.get(0,0),t=this.get(0,1),e=this.get(1,0),r*this.get(1,1)-t*e):3===this.columns?(n=this.selectionView([1,2],[1,2]),o=this.selectionView([1,2],[0,2]),i=this.selectionView([1,2],[0,1]),r=this.get(0,0),t=this.get(0,1),e=this.get(0,2),r*n.det()-t*o.det()+e*i.det()):new LuDecomposition(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(r){void 0===r&&(r=Number.EPSILON);for(var t=new SvDecomposition(this,{autoTranspose:!0}),e=t.leftSingularVectors,n=t.rightSingularVectors,o=t.diagonal,i=0;i<o.length;i++)Math.abs(o[i])>r?o[i]=1/o[i]:o[i]=0;return o=this.constructor[Symbol.species].diag(o),n.mmul(o.mmul(e.transposeView()))}}function checkDimensions(r,t){if(r.rows!==t.rows||r.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal")}function compareNumbers(r,t){return r-t}Matrix.prototype.klass="Matrix",Matrix.random=Matrix.rand,Matrix.diagonal=Matrix.diag,Matrix.prototype.diagonal=Matrix.prototype.diag,Matrix.identity=Matrix.eye,Matrix.prototype.negate=Matrix.prototype.neg,Matrix.prototype.tensorProduct=Matrix.prototype.kroneckerProduct,Matrix.prototype.determinant=Matrix.prototype.det;var inplaceOperator="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",inplaceOperatorScalar="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",inplaceOperatorMatrix="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",staticOperator="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",inplaceMethod="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",staticMethod="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",inplaceMethodWithArgs="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",staticMethodWithArgs="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",inplaceMethodWithOneArgScalar="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",inplaceMethodWithOneArgMatrix="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",inplaceMethodWithOneArg="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",staticMethodWithOneArg=staticMethodWithArgs,operators=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],i;for(var operator of operators){var inplaceOp=eval(fillTemplateFunction(inplaceOperator,{name:operator[1],op:operator[0]})),inplaceOpS=eval(fillTemplateFunction(inplaceOperatorScalar,{name:operator[1]+"S",op:operator[0]})),inplaceOpM=eval(fillTemplateFunction(inplaceOperatorMatrix,{name:operator[1]+"M",op:operator[0]})),staticOp=eval(fillTemplateFunction(staticOperator,{name:operator[1]}));for(i=1;i<operator.length;i++)Matrix.prototype[operator[i]]=inplaceOp,Matrix.prototype[operator[i]+"S"]=inplaceOpS,Matrix.prototype[operator[i]+"M"]=inplaceOpM,Matrix[operator[i]]=staticOp}var methods=[["~","not"]];for(var method of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(r){methods.push(["Math."+r,r])}),methods)){var inplaceMeth=eval(fillTemplateFunction(inplaceMethod,{name:method[1],method:method[0]})),staticMeth=eval(fillTemplateFunction(staticMethod,{name:method[1]}));for(i=1;i<method.length;i++)Matrix.prototype[method[i]]=inplaceMeth,Matrix[method[i]]=staticMeth}var methodsWithArgs=[["Math.pow",1,"pow"]];for(var methodWithArg of methodsWithArgs){var args="arg0";for(i=1;i<methodWithArg[1];i++)args+=", arg".concat(i);if(1!==methodWithArg[1]){var inplaceMethWithArgs=eval(fillTemplateFunction(inplaceMethodWithArgs,{name:methodWithArg[2],method:methodWithArg[0],args:args})),staticMethWithArgs=eval(fillTemplateFunction(staticMethodWithArgs,{name:methodWithArg[2],args:args}));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethWithArgs,Matrix[methodWithArg[i]]=staticMethWithArgs}else{var tmplVar={name:methodWithArg[2],args:args,method:methodWithArg[0]},inplaceMethod2=eval(fillTemplateFunction(inplaceMethodWithOneArg,tmplVar)),inplaceMethodS=eval(fillTemplateFunction(inplaceMethodWithOneArgScalar,tmplVar)),inplaceMethodM=eval(fillTemplateFunction(inplaceMethodWithOneArgMatrix,tmplVar)),staticMethod2=eval(fillTemplateFunction(staticMethodWithOneArg,tmplVar));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethod2,Matrix.prototype[methodWithArg[i]+"M"]=inplaceMethodM,Matrix.prototype[methodWithArg[i]+"S"]=inplaceMethodS,Matrix[methodWithArg[i]]=staticMethod2}}function fillTemplateFunction(r,t){for(var e in t)r=r.replace(new RegExp("%"+e+"%","g"),t[e]);return r}return Matrix}},function(r,t,e){"use strict";var n=e(0);function o(r){if(!(this instanceof o))return new o(r);var t,e,i,a,s,h,u,l,f,c,m=(r=n.Matrix.checkMatrix(r)).clone(),v=m.rows,g=m.columns,w=new Array(v),d=1;for(t=0;t<v;t++)w[t]=t;for(f=new Array(v),e=0;e<g;e++){for(t=0;t<v;t++)f[t]=m[t][e];for(t=0;t<v;t++){for(l=m[t],c=Math.min(t,e),s=0,i=0;i<c;i++)s+=l[i]*f[i];l[e]=f[t]-=s}for(a=e,t=e+1;t<v;t++)Math.abs(f[t])>Math.abs(f[a])&&(a=t);if(a!==e){for(i=0;i<g;i++)h=m[a][i],m[a][i]=m[e][i],m[e][i]=h;u=w[a],w[a]=w[e],w[e]=u,d=-d}if(e<v&&0!==m[e][e])for(t=e+1;t<v;t++)m[t][e]/=m[e][e]}this.LU=m,this.pivotVector=w,this.pivotSign=d}o.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,e=0;e<t;e++)if(0===r[e][e])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,e=r.columns,n=0;n<e;n++)t*=r[n][n];return t},get lowerTriangularMatrix(){for(var r=this.LU,t=r.rows,e=r.columns,o=new n.Matrix(t,e),i=0;i<t;i++)for(var a=0;a<e;a++)o[i][a]=i>a?r[i][a]:i===a?1:0;return o},get upperTriangularMatrix(){for(var r=this.LU,t=r.rows,e=r.columns,o=new n.Matrix(t,e),i=0;i<t;i++)for(var a=0;a<e;a++)o[i][a]=i<=a?r[i][a]:0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=n.Matrix.checkMatrix(r);var t=this.LU;if(t.rows!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var e,o,i,a=r.columns,s=r.subMatrixRow(this.pivotVector,0,a-1),h=t.columns;for(i=0;i<h;i++)for(e=i+1;e<h;e++)for(o=0;o<a;o++)s[e][o]-=s[i][o]*t[e][i];for(i=h-1;i>=0;i--){for(o=0;o<a;o++)s[i][o]/=t[i][i];for(e=0;e<i;e++)for(o=0;o<a;o++)s[e][o]-=s[i][o]*t[e][i]}return s}},r.exports=o},function(r,t,e){"use strict";var n=e(0),o=e(4),i=o.hypotenuse,a=o.getFilled2DArray;function s(r,t){if(!(this instanceof s))return new s(r,t);t=t||{};var e=(r=n.Matrix.checkMatrix(r)).rows,o=r.columns,h=Math.min(e,o),u=!0,l=!0;!1===t.computeLeftSingularVectors&&(u=!1),!1===t.computeRightSingularVectors&&(l=!1);var f,c=!0===t.autoTranspose,m=!1;if(e<o)if(c){e=(f=r.transpose()).rows,o=f.columns,m=!0;var v=u;u=l,l=v}else f=r.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else f=r.clone();var g,w,d,p,M,x,y,b,A,S,k,R,V,_,z,E,C,q,D,I,j,O=new Array(Math.min(e+1,o)),W=a(e,h,0),T=a(o,o,0),L=new Array(o),F=new Array(e),N=Math.min(e-1,o),P=Math.max(0,Math.min(o-2,e));for(d=0,S=Math.max(N,P);d<S;d++){if(d<N){for(O[d]=0,g=d;g<e;g++)O[d]=i(O[d],f[g][d]);if(0!==O[d]){for(f[d][d]<0&&(O[d]=-O[d]),g=d;g<e;g++)f[g][d]/=O[d];f[d][d]+=1}O[d]=-O[d]}for(w=d+1;w<o;w++){if(d<N&&0!==O[d]){for(M=0,g=d;g<e;g++)M+=f[g][d]*f[g][w];for(M=-M/f[d][d],g=d;g<e;g++)f[g][w]+=M*f[g][d]}L[w]=f[d][w]}if(u&&d<N)for(g=d;g<e;g++)W[g][d]=f[g][d];if(d<P){for(L[d]=0,g=d+1;g<o;g++)L[d]=i(L[d],L[g]);if(0!==L[d]){for(L[d+1]<0&&(L[d]=0-L[d]),g=d+1;g<o;g++)L[g]/=L[d];L[d+1]+=1}if(L[d]=-L[d],d+1<e&&0!==L[d]){for(g=d+1;g<e;g++)F[g]=0;for(w=d+1;w<o;w++)for(g=d+1;g<e;g++)F[g]+=L[w]*f[g][w];for(w=d+1;w<o;w++)for(M=-L[w]/L[d+1],g=d+1;g<e;g++)f[g][w]+=M*F[g]}if(l)for(g=d+1;g<o;g++)T[g][d]=L[g]}}if(p=Math.min(o,e+1),N<o&&(O[N]=f[N][N]),e<p&&(O[p-1]=0),P+1<p&&(L[P]=f[P][p-1]),L[p-1]=0,u){for(w=N;w<h;w++){for(g=0;g<e;g++)W[g][w]=0;W[w][w]=1}for(d=N-1;d>=0;d--)if(0!==O[d]){for(w=d+1;w<h;w++){for(M=0,g=d;g<e;g++)M+=W[g][d]*W[g][w];for(M=-M/W[d][d],g=d;g<e;g++)W[g][w]+=M*W[g][d]}for(g=d;g<e;g++)W[g][d]=-W[g][d];for(W[d][d]=1+W[d][d],g=0;g<d-1;g++)W[g][d]=0}else{for(g=0;g<e;g++)W[g][d]=0;W[d][d]=1}}if(l)for(d=o-1;d>=0;d--){if(d<P&&0!==L[d])for(w=d+1;w<o;w++){for(M=0,g=d+1;g<o;g++)M+=T[g][d]*T[g][w];for(M=-M/T[d+1][d],g=d+1;g<o;g++)T[g][w]+=M*T[g][d]}for(g=0;g<o;g++)T[g][d]=0;T[d][d]=1}for(var U=p-1,J=Math.pow(2,-52);p>0;){for(d=p-2;d>=-1&&-1!==d;d--)if(Math.abs(L[d])<=J*(Math.abs(O[d])+Math.abs(O[d+1]))){L[d]=0;break}if(d===p-2)k=4;else{for(x=p-1;x>=d&&x!==d;x--)if(M=(x!==p?Math.abs(L[x]):0)+(x!==d+1?Math.abs(L[x-1]):0),Math.abs(O[x])<=J*M){O[x]=0;break}x===d?k=3:x===p-1?k=1:(k=2,d=x)}switch(d++,k){case 1:for(y=L[p-2],L[p-2]=0,w=p-2;w>=d;w--)if(M=i(O[w],y),b=O[w]/M,A=y/M,O[w]=M,w!==d&&(y=-A*L[w-1],L[w-1]=b*L[w-1]),l)for(g=0;g<o;g++)M=b*T[g][w]+A*T[g][p-1],T[g][p-1]=-A*T[g][w]+b*T[g][p-1],T[g][w]=M;break;case 2:for(y=L[d-1],L[d-1]=0,w=d;w<p;w++)if(M=i(O[w],y),b=O[w]/M,A=y/M,O[w]=M,y=-A*L[w],L[w]=b*L[w],u)for(g=0;g<e;g++)M=b*W[g][w]+A*W[g][d-1],W[g][d-1]=-A*W[g][w]+b*W[g][d-1],W[g][w]=M;break;case 3:for(R=Math.max(Math.max(Math.max(Math.max(Math.abs(O[p-1]),Math.abs(O[p-2])),Math.abs(L[p-2])),Math.abs(O[d])),Math.abs(L[d])),V=O[p-1]/R,_=O[p-2]/R,z=L[p-2]/R,E=O[d]/R,C=L[d]/R,D=V*z*(V*z),I=0,0===(q=((_+V)*(_-V)+z*z)/2)&&0===D||(I=Math.sqrt(q*q+D),q<0&&(I=-I),I=D/(q+I)),y=(E+V)*(E-V)+I,j=E*C,w=d;w<p-1;w++){if(b=y/(M=i(y,j)),A=j/M,w!==d&&(L[w-1]=M),y=b*O[w]+A*L[w],L[w]=b*L[w]-A*O[w],j=A*O[w+1],O[w+1]=b*O[w+1],l)for(g=0;g<o;g++)M=b*T[g][w]+A*T[g][w+1],T[g][w+1]=-A*T[g][w]+b*T[g][w+1],T[g][w]=M;if(b=y/(M=i(y,j)),A=j/M,O[w]=M,y=b*L[w]+A*O[w+1],O[w+1]=-A*L[w]+b*O[w+1],j=A*L[w+1],L[w+1]=b*L[w+1],u&&w<e-1)for(g=0;g<e;g++)M=b*W[g][w]+A*W[g][w+1],W[g][w+1]=-A*W[g][w]+b*W[g][w+1],W[g][w]=M}L[p-2]=y,1;break;case 4:if(O[d]<=0&&(O[d]=O[d]<0?-O[d]:0,l))for(g=0;g<=U;g++)T[g][d]=-T[g][d];for(;d<U&&!(O[d]>=O[d+1]);){if(M=O[d],O[d]=O[d+1],O[d+1]=M,l&&d<o-1)for(g=0;g<o;g++)M=T[g][d+1],T[g][d+1]=T[g][d],T[g][d]=M;if(u&&d<e-1)for(g=0;g<e;g++)M=W[g][d+1],W[g][d+1]=W[g][d],W[g][d]=M;d++}0,p--}}if(m){var G=T;T=W,W=G}this.m=e,this.n=o,this.s=O,this.U=W,this.V=T}s.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,e=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>t&&e++;return e},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return n.Matrix.isMatrix(this.U)||(this.U=new n.Matrix(this.U)),this.U},get rightSingularVectors(){return n.Matrix.isMatrix(this.V)||(this.V=new n.Matrix(this.V)),this.V},get diagonalMatrix(){return n.Matrix.diag(this.s)},solve:function(r){var t,e=r,o=this.threshold,i=this.s.length,a=n.Matrix.zeros(i,i);for(t=0;t<i;t++)Math.abs(this.s[t])<=o?a[t][t]=0:a[t][t]=1/this.s[t];var s,h,u,l=this.U,f=this.rightSingularVectors,c=f.mmul(a),m=f.rows,v=l.length,g=n.Matrix.zeros(m,v);for(t=0;t<m;t++)for(s=0;s<v;s++){for(u=0,h=0;h<i;h++)u+=c[t][h]*l[s][h];g[t][s]=u}return g.mmul(e)},solveForDiagonal:function(r){return this.solve(n.Matrix.diag(r))},inverse:function(){var r,t,e=this.V,o=this.threshold,i=e.length,a=e[0].length,s=new n.Matrix(i,this.s.length);for(r=0;r<i;r++)for(t=0;t<a;t++)Math.abs(this.s[t])>o?s[r][t]=e[r][t]/this.s[t]:s[r][t]=0;var h,u,l=this.U,f=l.length,c=l[0].length,m=new n.Matrix(i,f);for(r=0;r<i;r++)for(t=0;t<f;t++){for(u=0,h=0;h<c;h++)u+=s[r][h]*l[t][h];m[r][t]=u}return m}},r.exports=s},function(r,t,e){"use strict";t.array=e(11),t.matrix=e(25)},function(r,t,e){"use strict";function n(r,t){return r-t}t.sum=function(r){for(var t=0,e=0;e<r.length;e++)t+=r[e];return t},t.max=function(r){for(var t=r[0],e=r.length,n=1;n<e;n++)r[n]>t&&(t=r[n]);return t},t.min=function(r){for(var t=r[0],e=r.length,n=1;n<e;n++)r[n]<t&&(t=r[n]);return t},t.minMax=function(r){for(var t=r[0],e=r[0],n=r.length,o=1;o<n;o++)r[o]<t&&(t=r[o]),r[o]>e&&(e=r[o]);return{min:t,max:e}},t.arithmeticMean=function(r){for(var t=0,e=r.length,n=0;n<e;n++)t+=r[n];return t/e},t.mean=t.arithmeticMean,t.geometricMean=function(r){for(var t=1,e=r.length,n=0;n<e;n++)t*=r[n];return Math.pow(t,1/e)},t.logMean=function(r){for(var t=0,e=r.length,n=0;n<e;n++)t+=Math.log(r[n]);return t/e},t.grandMean=function(r,t){for(var e=0,n=0,o=r.length,i=0;i<o;i++)e+=t[i]*r[i],n+=t[i];return e/n},t.truncatedMean=function(r,t,e){void 0===e&&(e=!1),e||(r=[].concat(r).sort(n));for(var o=r.length,i=Math.floor(o*t),a=0,s=i;s<o-i;s++)a+=r[s];return a/(o-2*i)},t.harmonicMean=function(r){for(var t=0,e=r.length,n=0;n<e;n++){if(0===r[n])throw new RangeError("value at index "+n+"is zero");t+=1/r[n]}return e/t},t.contraHarmonicMean=function(r){for(var t=0,e=0,n=r.length,o=0;o<n;o++)t+=r[o]*r[o],e+=r[o];if(e<0)throw new RangeError("sum of values is negative");return t/e},t.median=function(r,t){void 0===t&&(t=!1),t||(r=[].concat(r).sort(n));var e=r.length,o=Math.floor(e/2);return e%2==0?.5*(r[o-1]+r[o]):r[o]},t.variance=function(r,e){void 0===e&&(e=!0);for(var n=t.mean(r),o=0,i=r.length,a=0;a<i;a++){var s=r[a]-n;o+=s*s}return e?o/(i-1):o/i},t.standardDeviation=function(r,e){return Math.sqrt(t.variance(r,e))},t.standardError=function(r){return t.standardDeviation(r)/Math.sqrt(r.length)},t.robustMeanAndStdev=function(r){var t=0,e=r.length,o=0;for(o=0;o<e;o++)t+=r[o];t/=e;var i=new Array(e);for(o=0;o<e;o++)i[o]=Math.abs(r[o]-t);return i.sort(n),{mean:t,stdev:e%2==1?i[(e-1)/2]/.6745:.5*(i[e/2]+i[e/2-1])/.6745}},t.quartiles=function(r,e){void 0===e&&(e=!1),e||(r=[].concat(r).sort(n));var o=r.length/4;return{q1:r[Math.ceil(o)-1],q2:t.median(r,!0),q3:r[Math.ceil(3*o)-1]}},t.pooledStandardDeviation=function(r,e){return Math.sqrt(t.pooledVariance(r,e))},t.pooledVariance=function(r,e){void 0===e&&(e=!0);for(var n=0,o=0,i=r.length,a=0;a<i;a++){var s=r[a],h=t.variance(s);n+=(s.length-1)*h,o+=e?s.length-1:s.length}return n/o},t.mode=function(r){var t,e=r.length,n=new Array(e);for(t=0;t<e;t++)n[t]=0;var o=new Array(e),i=0;for(t=0;t<e;t++){var a=o.indexOf(r[t]);a>=0?n[a]++:(o[i]=r[t],n[i]=1,i++)}var s=0,h=0;for(t=0;t<i;t++)n[t]>s&&(s=n[t],h=t);return o[h]},t.covariance=function(r,e,n){void 0===n&&(n=!0);var o=t.mean(r),i=t.mean(e);if(r.length!==e.length)throw"Vectors do not have the same dimensions";for(var a=0,s=r.length,h=0;h<s;h++){a+=(r[h]-o)*(e[h]-i)}return n?a/(s-1):a/s},t.skewness=function(r,e){void 0===e&&(e=!0);for(var n=t.mean(r),o=0,i=0,a=r.length,s=0;s<a;s++){var h=r[s]-n;o+=h*h,i+=h*h*h}var u=o/a,l=i/a/Math.pow(u,1.5);return e?Math.sqrt(a*(a-1))/(a-2)*l:l},t.kurtosis=function(r,e){void 0===e&&(e=!0);for(var n=t.mean(r),o=r.length,i=0,a=0,s=0;s<o;s++){var h=r[s]-n;i+=h*h,a+=h*h*h*h}var u=i/o;if(e){var l=i/(o-1);return o*(o+1)/((o-1)*(o-2)*(o-3))*(a/(l*l))-3*((o-1)*(o-1)/((o-2)*(o-3)))}return a/o/(u*u)-3},t.entropy=function(r,t){void 0===t&&(t=0);for(var e=0,n=r.length,o=0;o<n;o++)e+=r[o]*Math.log(r[o]+t);return-e},t.weightedMean=function(r,t){for(var e=0,n=r.length,o=0;o<n;o++)e+=r[o]*t[o];return e},t.weightedStandardDeviation=function(r,e){return Math.sqrt(t.weightedVariance(r,e))},t.weightedVariance=function(r,e){for(var n=t.weightedMean(r,e),o=0,i=r.length,a=0,s=0,h=0;h<i;h++){var u=r[h]-n,l=e[h];o+=l*(u*u),s+=l,a+=l*l}return o*(s/(s*s-a))},t.center=function(r,e){void 0===e&&(e=!1);var n=r;e||(n=[].concat(r));for(var o=t.mean(n),i=n.length,a=0;a<i;a++)n[a]-=o},t.standardize=function(r,e,n){void 0===e&&(e=t.standardDeviation(r)),void 0===n&&(n=!1);for(var o=r.length,i=n?r:new Array(o),a=0;a<o;a++)i[a]=r[a]/e;return i},t.cumulativeSum=function(r){var t=r.length,e=new Array(t);e[0]=r[0];for(var n=1;n<t;n++)e[n]=e[n-1]+r[n];return e}},function(r,t,e){"use strict";var n=e(2);r.exports={transpose:function(r){return"number"==typeof r?r:r.clone().transpose()},add:function(r,t){return"number"==typeof r&&"number"==typeof t?r+t:"number"==typeof r?this.add(t,r):r.clone().add(t)},subtract:function(r,t){return"number"==typeof r&&"number"==typeof t?r-t:"number"==typeof r?this.subtract(t,r):r.clone().sub(t)},multiply:function(r,t){if("number"==typeof r&&"number"==typeof t)return r*t;if("number"==typeof r)return this.multiply(t,r);var e=r.clone();return"number"==typeof t?e.mul(t):e=e.mmul(t),1==e.rows&&1==e.columns?e[0][0]:e},dotMultiply:function(r,t){return r.clone().mul(t)},dotDivide:function(r,t){return r.clone().div(t)},diag:function(r){var t,e,o=null,i=r.rows,a=r.columns;if(void 0===a&&"object"==typeof r)if(r[0]&&r[0].length)for(i=r.length,a=r[0].length,e=Math.min(i,a),o=n.zeros(a,a),t=0;t<a;t++)o[t][t]=r[t][t];else for(a=r.length,o=n.zeros(a,a),t=0;t<a;t++)o[t][t]=r[t];if(1==i)for(o=n.zeros(a,a),t=0;t<a;t++)o[t][t]=r[0][t];else if(i>0&&a>0)for(e=Math.min(i,a),o=new Array(e),t=0;t<e;t++)o[t]=r[t][t];return o},min:function(r,t){if("number"==typeof r&&"number"==typeof t)return Math.min(r,t);for(var e=r.rows,o=r.columns,i=new n(e,o),a=0;a<e;a++)for(var s=0;s<o;s++)r[a][s]<t[a][s]?i[a][s]=r[a][s]:i[a][s]=t[a][s];return i},max:function(r,t){if("number"==typeof r&&"number"==typeof t)return Math.max(r,t);for(var e=r.rows,o=r.columns,i=new n(e,o),a=0;a<e;a++)for(var s=0;s<o;s++)r[a][s]>t[a][s]?i[a][s]=r[a][s]:i[a][s]=t[a][s];return i},solve:function(r,t){return r.solve(t)},inv:function(r){return"number"==typeof r?1/r:r.inverse()},sqrt:function(r){if("number"==typeof r)return Math.sqrt(r);for(var t=r.rows,e=r.columns,o=new n(t,e),i=0;i<t;i++)for(var a=0;a<e;a++)o[i][a]=Math.sqrt(r[i][a]);return o},exp:function(r){if("number"==typeof r)return Math.sqrt(r);for(var t=r.rows,e=r.columns,o=new n(t,e),i=0;i<t;i++)for(var a=0;a<e;a++)o[i][a]=Math.exp(r[i][a]);return o},dotPow:function(r,t){if("number"==typeof r)return Math.pow(r,t);for(var e=r.rows,o=r.columns,i=new n(e,o),a=0;a<e;a++)for(var s=0;s<o;s++)i[a][s]=Math.pow(r[a][s],t);return i},abs:function(r){if("number"==typeof r)return Math.abs(r);for(var t=r.rows,e=r.columns,o=new n(t,e),i=0;i<t;i++)for(var a=0;a<e;a++)o[i][a]=Math.abs(r[i][a]);return o},matrix:function(r,t){return new n(r,t)},ones:function(r,t){return n.ones(r,t)},zeros:function(r,t){return n.zeros(r,t)},random:function(r,t){return n.rand(r,t)},eye:function(r,t){return n.eye(r,t)}}},function(r,t,e){"use strict";r.exports.gsd=e(14),r.exports.post={optimizePeaks:e(19),joinBroadPeaks:e(39),broadenPeaks:e(40)}},function(r,t,e){"use strict";const n=e(15),o={sgOptions:{windowSize:9,polynomial:3},minMaxRatio:25e-5,broadRatio:0,maxCriteria:!0,smoothY:!0,realTopDetection:!1,heightFactor:0,boundaries:!1,derivativeThreshold:-1};r.exports=function(r,t,e){let i=(e=Object.assign({},o,e)).sgOptions;const a=[].concat(t);if(!("noiseLevel"in e)){var s,h=0,u=Number.MAX_VALUE;for(let t=0;t<r.length-1;++t)(s=Math.abs(r[t+1]-r[t]))<u&&(u=s),s>h&&(h=s);e.noiseLevel=(h-u)/h<.05?function(r){var t=0,e=0,n=r.length;for(let e=0;e<n;++e)t+=r[e];t/=n;var o=new Array(n);for(let e=0;e<n;++e)o[e]=Math.abs(r[e]-t);o.sort((r,t)=>r-t),e=n%2==1?o[(n-1)/2]/.6745:.5*(o[n/2]+o[n/2-1])/.6745;return e}(a):0}const l={m:1,b:e.noiseLevel};e.maxCriteria||(l.m=-1,l.b*=-1);for(let r=0;r<a.length;r++)a[r]=l.m*a[r]-l.b;for(let r=0;r<a.length;r++)a[r]<0&&(a[r]=0);let f,c,m=a;(h-u)/h<.05?(e.smoothY&&(m=n(a,r[1]-r[0],{windowSize:i.windowSize,polynomial:i.polynomial,derivative:0})),f=n(a,r[1]-r[0],{windowSize:i.windowSize,polynomial:i.polynomial,derivative:1}),c=n(a,r[1]-r[0],{windowSize:i.windowSize,polynomial:i.polynomial,derivative:2})):(e.smoothY&&(m=n(a,r,{windowSize:i.windowSize,polynomial:i.polynomial,derivative:0})),f=n(a,r,{windowSize:i.windowSize,polynomial:i.polynomial,derivative:1}),c=n(a,r,{windowSize:i.windowSize,polynomial:i.polynomial,derivative:2}));const v=r,g=r[1]-r[0];var w=0,d=0;for(let r=0;r<m.length;r++)Math.abs(c[r])>w&&(w=Math.abs(c[r])),Math.abs(m[r])>d&&(d=Math.abs(m[r]));var p=null,M=null,x=new Array(m.length-2),y=new Array(m.length),b=new Array(m.length),A=new Array(m.length-2),S=0,k=0,R=0,V=0;for(let r=1;r<m.length-1;++r)Math.abs(f[r])>e.derivativeThreshold&&((f[r]<f[r-1]&&f[r]<=f[r+1]||f[r]<=f[r-1]&&f[r]<f[r+1])&&(M={x:v[r],index:r},g>0&&null!==p&&(y[k++]=p,b[R++]=M)),(f[r]>=f[r-1]&&f[r]>f[r+1]||f[r]>f[r-1]&&f[r]>=f[r+1])&&(p={x:v[r],index:r},g<0&&null!==M&&(y[k++]=p,b[R++]=M))),c[r]<c[r-1]&&c[r]<c[r+1]&&(x[S++]=r,A[V++]=Math.abs(c[r])<=e.broadRatio*w);x.length=S,y.length=k,b.length=R,A.length=V;let _,z,E,C,q,D=new Array(x.length),I=0,j=-1;for(let r=0;r<x.length;++r){z=v[x[r]],_=-1;let t=j+1;for(C=Number.MAX_VALUE,E=0,q=!0;-1===_&&t<y.length&&q;)(E=Math.abs(z-(y[t].x+b[t].x)/2))<C?C=E:q=!1,E<Math.abs(y[t].x-b[t].x)/2&&(_=t,j=t),++t;if(-1!==_&&Math.abs(m[x[r]])>e.minMaxRatio*d&&(D[I++]={index:x[r],x:z,y:(m[x[r]]+l.b)/l.m,width:Math.abs(b[_].x-y[_].x),soft:A[r]},e.boundaries&&(D[I-1].left=y[_],D[I-1].right=b[_]),e.heightFactor)){let r=m[y[_].index],t=m[b[_].index];D[I-1].height=e.heightFactor*(D[I-1].y-(r+t)/2)}}D.length=I,e.realTopDetection&&function(r,t,e){for(var n,o,i,a,s,h=0;h<r.length;h++)s=r[h].index,e[s-1]>=e[s-2]&&e[s-1]>=e[s]?s--:e[s+1]>=e[s]&&e[s+1]>=e[s+2]?s++:e[s-2]>=e[s-3]&&e[s-2]>=e[s-1]?s-=2:e[s+2]>=e[s+1]&&e[s+2]>=e[s+3]&&(s+=2),e[s-1]>0&&e[s+1]>0&&e[s]>=e[s-1]&&e[s]>=e[s+1]&&(n=20*Math.log10(e[s-1]),o=20*Math.log10(e[s]),i=20*Math.log10(e[s+1]),a=.5*(n-i)/(n-2*o+i),r[h].x=t[s]+(t[s]-t[s-1])*a,r[h].y=e[s]-.25*(e[s-1]-e[s+1])*a)}(D,v,m);for(let r=0;r<D.length;r++)D[r].base=e.noiseLevel;return D.sort(function(r,t){return r.x-t.x}),D}},function(r,t,e){var n=e(16),o=(e(17),{windowSize:9,derivative:0,polynomial:3});function i(r,t,e,n){for(var o=0,i=0,a=t-e;a<t+e;a++)a>=0&&a<r.length-1&&(o+=r[a+1]-r[a],i++);return Math.pow(o/i,n)}function a(r,t,e,n){return e>0?(4*e-2)/(e*(2*t-e+1))*(r*a(r,t,e-1,n)+n*a(r,t,e-1,n-1))-(e-1)*(2*t+e)/(e*(2*t-e+1))*a(r,t,e-2,n):0==e&&0==n?1:0}function s(r,t){var e=1;if(r>=t)for(var n=r-t+1;n<=r;n++)e*=n;return e}function h(r,t,e,n,o){for(var i=0,h=0;h<=n;h++)i+=(2*h+1)*(s(2*e,h)/s(2*e+h+1,h+1))*a(r,e,h,0)*a(t,e,h,o);return i}r.exports=function(r,t,e){if((e=n({},o,e)).windowSize%2==0||e.windowSize<5||!Number.isInteger(e.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(e.windowSize>r.length)throw new RangeError("Window size is higher than the data length "+e.windowSize+">"+r.length);if(e.derivative<0||!Number.isInteger(e.derivative))throw new RangeError("Derivative should be a positive integer");if(e.polynomial<1||!Number.isInteger(e.polynomial))throw new RangeError("Polynomial should be a positive integer");e.polynomial>=6&&console.warn("You should not use polynomial grade higher than 5 if you are not sure that your data arises from such a model. Possible polynomial oscillation problems");var a=e.windowSize,s=Math.floor(a/2),u=r.length,l=new Array(u),f=function(r,t,e){for(var n=new Array(r),o=Math.floor(r/2),i=-o;i<=o;i++){n[i+o]=new Array(r);for(var a=-o;a<=o;a++)n[i+o][a+o]=h(a,i,o,t,e)}return n}(a,e.polynomial,e.derivative),c=0,m=!0;"[object Array]"===Object.prototype.toString.call(t)?m=!1:c=Math.pow(t,e.derivative);for(var v=0;v<s;v++){for(var g=f[s-v-1],w=f[s+v+1],d=0,p=0,M=0;M<a;M++)d+=g[M]*r[M],p+=w[M]*r[u-a+M-1];m?(l[s-v-1]=d/c,l[u-s+v]=p/c):(c=i(t,s-v-1,s,e.derivative),l[s-v-1]=d/c,c=i(t,u-s+v,s,e.derivative),l[u-s+v]=p/c)}var x=f[s];for(v=a;v<u+1;v++){var y=0;for(M=0;M<a;M++)y+=x[M]*r[M+v-a];m||(c=i(t,v-s-1,s,e.derivative)),l[v-s-1]=y/c}return l}},function(r,t,e){"use strict";var n=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=Object.defineProperty,a=Object.getOwnPropertyDescriptor,s=function(r){return"function"==typeof Array.isArray?Array.isArray(r):"[object Array]"===o.call(r)},h=function(r){if(!r||"[object Object]"!==o.call(r))return!1;var t,e=n.call(r,"constructor"),i=r.constructor&&r.constructor.prototype&&n.call(r.constructor.prototype,"isPrototypeOf");if(r.constructor&&!e&&!i)return!1;for(t in r);return void 0===t||n.call(r,t)},u=function(r,t){i&&"__proto__"===t.name?i(r,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):r[t.name]=t.newValue},l=function(r,t){if("__proto__"===t){if(!n.call(r,t))return;if(a)return a(r,t).value}return r[t]};r.exports=function r(){var t,e,n,o,i,a,f=arguments[0],c=1,m=arguments.length,v=!1;for("boolean"==typeof f&&(v=f,f=arguments[1]||{},c=2),(null==f||"object"!=typeof f&&"function"!=typeof f)&&(f={});c<m;++c)if(null!=(t=arguments[c]))for(e in t)n=l(f,e),f!==(o=l(t,e))&&(v&&o&&(h(o)||(i=s(o)))?(i?(i=!1,a=n&&s(n)?n:[]):a=n&&h(n)?n:{},u(f,{name:e,newValue:r(v,a,o)})):void 0!==o&&u(f,{name:e,newValue:o}));return f}},function(r,t,e){"use strict";t.array=e(5),t.matrix=e(18)},function(r,t,e){"use strict";var n=e(5);function o(r,t){void 0===t&&(t=0);var e,n,o,i,a=r.length,s=r[0].length;if(-1===t){for(e=[0],n=a*s,o=0;o<a;o++)for(i=0;i<s;i++)e[0]+=r[o][i];e[0]/=n}else if(0===t)for(e=new Array(s),n=a,i=0;i<s;i++){for(e[i]=0,o=0;o<a;o++)e[i]+=r[o][i];e[i]/=n}else{if(1!==t)throw new Error("Invalid dimension");for(e=new Array(a),n=s,i=0;i<a;i++){for(e[i]=0,o=0;o<s;o++)e[i]+=r[i][o];e[i]/=n}}return e}function i(r,t,e){for(var n=a(r,t,e),o=n.length,i=0;i<o;i++)n[i]=Math.sqrt(n[i]);return n}function a(r,t,e){void 0===e&&(e=!0),t=t||o(r);var n=r.length;if(0===n)return[];for(var i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0,f=0;f<n;f++)h+=l=r[f][s]-t[s],u+=l*l;a[s]=e?(u-h*h/n)/(n-1):(u-h*h/n)/n}return a}function s(r,t,e){void 0===e&&(e=0),void 0===t&&(0===e?t=r.length-1:1===e&&(t=r[0].length-1));var n=o(r,e),i=r.length;if(0===i)return[[]];var a,s,h,u,l,f=r[0].length;if(0===e){for(a=new Array(f),s=0;s<f;s++)a[s]=new Array(f);for(s=0;s<f;s++)for(h=s;h<f;h++){for(u=0,l=0;l<i;l++)u+=(r[l][h]-n[h])*(r[l][s]-n[s]);u/=t,a[s][h]=u,a[h][s]=u}}else{if(1!==e)throw new Error("Invalid dimension");for(a=new Array(i),s=0;s<i;s++)a[s]=new Array(i);for(s=0;s<i;s++)for(h=s;h<i;h++){for(u=0,l=0;l<f;l++)u+=(r[h][l]-n[h])*(r[s][l]-n[s]);u/=t,a[s][h]=u,a[h][s]=u}}return a}function h(r,t,e){return t=t||o(r),void 0===e&&(e=i(r,!0,t)),l(u(r,t,!1),e,!0)}function u(r,t,e){t=t||o(r);var n,i,a,s=r,h=r.length;if(!e)for(s=new Array(h),n=0;n<h;n++)s[n]=new Array(r[n].length);for(n=0;n<h;n++){var u=s[n];for(i=0,a=u.length;i<a;i++)u[i]=r[n][i]-t[i]}return s}function l(r,t,e){void 0===t&&(t=i(r));var n,o,a,s=r,h=r.length;if(!e)for(s=new Array(h),n=0;n<h;n++)s[n]=new Array(r[n].length);for(n=0;n<h;n++){var u=s[n],l=r[n];for(o=0,a=u.length;o<a;o++)0===t[o]||isNaN(t[o])||(u[o]=l[o]/t[o])}return s}function f(r,t,e){void 0===e&&(e=0);var o=r.length;if(0===o)return[];var i,a,s,h,u,l,f=r[0].length;if(0===e){for(i=new Array(f),a=0;a<f;a++)i[a]=0;for(a=0;a<o;a++)for(l=r[a],u=t[a],h=0;h<f;h++)i[h]+=l[h]*u}else{if(1!==e)throw new Error("Invalid dimension");for(i=new Array(o),a=0;a<o;a++)i[a]=0;for(h=0;h<o;h++)for(l=r[h],u=t[h],a=0;a<f;a++)i[h]+=l[a]*u}var c=n.sum(t);if(0!==c)for(a=0,s=i.length;a<s;a++)i[a]/=c;return i}function c(r,t,e,n,o){o=o||0,e=e||f(r,t,o),void 0===n&&(n=1);var i=r.length;if(0===i)return[[]];var a,s,h,u,l,c=r[0].length;if(0===o){for(a=new Array(c),s=0;s<c;s++)a[s]=new Array(c);for(s=0;s<c;s++)for(h=s;h<c;h++){for(l=0,u=0;u<i;u++)l+=t[u]*(r[u][h]-e[h])*(r[u][s]-e[s]);a[s][h]=l*n,a[h][s]=l*n}}else{if(1!==o)throw new Error("Invalid dimension");for(a=new Array(i),s=0;s<i;s++)a[s]=new Array(i);for(s=0;s<i;s++)for(h=s;h<i;h++){for(l=0,u=0;u<c;u++)l+=t[u]*(r[h][u]-e[h])*(r[s][u]-e[s]);a[s][h]=l*n,a[h][s]=l*n}}return a}r.exports={entropy:function(r,t){void 0===t&&(t=0);for(var e=0,n=r.length,o=r[0].length,i=0;i<n;i++)for(var a=0;a<o;a++)e+=r[i][a]*Math.log(r[i][a]+t);return-e},mean:o,standardDeviation:i,variance:a,median:function(r){for(var t=r.length,e=r[0].length,n=new Array(e),o=0;o<e;o++){for(var i=new Array(t),a=0;a<t;a++)i[a]=r[a][o];i.sort();var s=i.length;n[o]=s%2==0?.5*(i[s/2]+i[s/2-1]):i[Math.floor(s/2)]}return n},mode:function(r){var t,e,n=r.length,o=r[0].length,i=new Array(o);for(t=0;t<o;t++){for(var a=new Array(n),s=0;s<n;s++)a[s]=0;var h=new Array(n),u=0;for(e=0;e<n;e++){var l=h.indexOf(r[e][t]);l>=0?a[l]++:(h[u]=r[e][t],a[u]=1,u++)}var f=0,c=0;for(e=0;e<u;e++)a[e]>f&&(f=a[e],c=e);i[t]=h[c]}return i},skewness:function(r,t){void 0===t&&(t=!0);for(var e=o(r),n=r.length,i=e.length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0;l<n;l++){var f=r[l][s]-e[s];h+=f*f,u+=f*f*f}var c=h/n,m=u/n/Math.pow(c,1.5);if(t){var v=Math.sqrt(n*(n-1)),g=n-2;a[s]=v/g*m}else a[s]=m}return a},kurtosis:function(r,t){void 0===t&&(t=!0);for(var e=o(r),n=r.length,i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0;l<n;l++){var f=r[l][s]-e[s];h+=f*f,u+=f*f*f*f}var c=h/n,m=u/n;if(t){var v=h/(n-1),g=n*(n+1)/((n-1)*(n-2)*(n-3)),w=u/(v*v),d=(n-1)*(n-1)/((n-2)*(n-3));a[s]=g*w-3*d}else a[s]=m/(c*c)-3}return a},standardError:function(r){for(var t=r.length,e=i(r),n=e.length,o=new Array(n),a=Math.sqrt(t),s=0;s<n;s++)o[s]=e[s]/a;return o},covariance:function(r,t){return s(r,void 0,t)},scatter:s,correlation:function(r){var t,e,n=o(r),a=h(r,n,i(r,!0,n)),s=r.length,u=r[0].length,l=new Array(u);for(t=0;t<u;t++)l[t]=new Array(u);for(t=0;t<u;t++)for(e=t;e<u;e++){for(var f=0,c=0,m=a.length;c<m;c++)f+=a[c][e]*a[c][t];f/=s-1,l[t][e]=f,l[e][t]=f}return l},zScores:h,center:u,standardize:l,weightedVariance:function(r,t){var e=o(r),n=r.length;if(0===n)return[];for(var i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0,f=0;f<n;f++){var c=r[f][s]-e[s],m=t[f];h+=m*(c*c),l+=m,u+=m*m}a[s]=h*(l/(l*l-u))}return a},weightedMean:f,weightedCovariance:function(r,t,e,n){n=n||0,e=e||f(r,t,n);for(var o=0,i=0,a=0,s=t.length;a<s;a++)o+=t[a],i+=t[a]*t[a];return c(r,t,e,o/(o*o-i),n)},weightedScatter:c}},function(r,t,e){"use strict";var n=e(6);function o(r,t,e,n,o){var i=e.length,a=[],s=[],h=Math.sign(e[1]-e[0]);-1===h&&(o[0]=e.length-1);for(var u=Math.abs(t-r)/2,l=(r+t)/2,f=!1,c=o[0];!f&&c<i&&c>=0;)Math.abs(e[c]-l)<=u?(a.push(e[c]),s.push(n[c]),c+=h):1===Math.sign(l-e[c])?c+=h:f=!0;return o[0]=c,[a,s]}r.exports=function(r,t,e,i,a){var s,h,u,l,f,c=[0],m=function(r,t){var e,n,o,i,a=[],s=[],h=[r[0].x,t*r[0].width];for(e=0;e<r.length;e++)Math.abs(r[e].x-h[0])<t*r[e].width+h[1]?(a.push(r[e]),o=h[0]+h[1],r[e].x+t*r[e].width>o&&(o=r[e].x+t*r[e].width),i=h[0]-h[1],r[e].x-t*r[e].width<i&&(i=r[e].x-t*r[e].width),h=[(o+i)/2,Math.abs(o-i)/2]):(s.push({limits:h,group:a}),a=[r[e]],h=[r[e].x,t*r[e].width]);for(s.push({limits:h,group:a}),e=s.length-2;e>=0;e--)if(Math.abs(s[e].limits[0]-s[e+1].limits[0])<(s[e].limits[1]+s[e+1].limits[1])/2){for(n=0;n<s[e+1].group.length;n++)s[e].group.push(s[e+1].group[n]);o=s[e].limits[0]+s[e].limits[1],s[e+1].limits[0]+s[e+1].limits[1]>o&&(o=s[e+1].limits[0]+s[e+1].limits[1]),i=s[e].limits[0]-s[e].limits[1],s[e+1].limits[0]-s[e+1].limits[1]<i&&(i=s[e+1].limits[0]-s[e+1].limits[1]),s[e].limits=[(o+i)/2,Math.abs(o-i)/2],s.splice(e+1,1)}return s}(r,i),v=[],g=1;for("gaussian"===a&&(g=1.17741),s=0;s<m.length;s++){var w=m[s].group;if(w.length>1){if((u=o(m[s].limits[0]-m[s].limits[1],m[s].limits[0]+m[s].limits[1],t,e,c))[0].length>5){f=[3,100,l=w[0].width/1e3,l,l,10*l,10*l,11,9,1];var d=[];for("gaussian"===a?d=n.optimizeGaussianSum(u,w,f):"lorentzian"===a&&(d=n.optimizeLorentzianSum(u,w,f)),h=0;h<d.length;h++)v.push({x:d[h][0][0],y:d[h][1][0],width:d[h][2][0]*g})}}else if((u=o((w=w[0]).x-i*w.width,w.x+i*w.width,t,e,c))[0].length>5){f=[3,100,l=w.width/1e3,l,l,10*l,10*l,11,9,1];var p=[];"gaussian"===a?p=n.optimizeSingleGaussian([u[0],u[1]],w,f):"lorentzian"===a&&(p=n.optimizeSingleLorentzian([u[0],u[1]],w,f)),v.push({x:p[0][0],y:p[1][0],width:p[2][0]*g})}}return v}},function(r,t,e){"use strict";r.exports=e(21),r.exports.Matrix=e(2),r.exports.Matrix.algebra=e(12)},function(r,t,e){var n=e(2),o=e(12),i={optimize:function(r,t,e,i,a,s,h,u,l,f){var c=0;if("object"!=typeof t[0])for(var m=0;m<t.length;m++)t[m]=[t[m]];var v=t.length,g=i.length,w=n.zeros(v,1),d=n.zeros(g,1),p=-2e-4,M=-2e-4,x=n.zeros(g,v);if(e.length==i.length){a=a||Math.sqrt((g-v+1)/o.multiply(o.transpose(i),i)),s=s||.001,h=h||o.multiply(Math.abs(t),-100),u=u||o.multiply(Math.abs(t),100),l=l||1;(f=f||[3,10*v,.001,.001,.001,.01,.01,11,9,1])[0];var y=f[1],b=f[2],A=(f[3],f[4],f[5]),S=f[6],k=f[7],R=f[8],V=f[9];if(!s.length||1==s.length){var _=new Array(v);for(m=0;m<v;m++)_[m]=[s];s=_}var z=[];for(m=0;m<s.length;m++)0!=s[m][0]&&z.push(m);var E=z.length,C=!1,q=null;if(!a.length||a.length<g){var D=o.multiply(n.ones(g,1),a[0]);q=o.dotMultiply(D,D)}else q=o.dotMultiply(a,a);var I=this.lm_matx(r,e,w,d,1,x,t,i,q,s,l),j=I.JtWJ,O=I.JtWdy,W=(p=I.Chi_sq,I.y_hat);x=I.J;switch(Math.max(Math.abs(O))<b&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",b),C=!0),V){case 1:lambda=S;break;default:lambda=S*Math.max(o.diag(j)),nu=2}M=p;for(var T=null;!C&&c<=y;){switch(c+=1,V){case 1:T=o.solve(o.add(j,o.multiply(o.diag(o.diag(j)),lambda)),O);break;default:T=o.solve(o.add(j,o.multiply(n.eye(v),lambda)),O)}var L=new Array(z.length);for(G=0;G<z.length;G++)L[G]=T[z[G]];var F=o.add(t,L);for(G=0;G<F.length;G++)F[G][0]=Math.min(Math.max(h[G][0],F[G][0]),u[G][0]);var N=o.subtract(i,r(e,F,l)),P=o.multiply(o.transpose(N),o.dotMultiply(N,q));if(2==V){var U=o.multiply(o.transpose(O),T),J=o.multiply(U,o.inv(o.add(o.multiply(o.subtract(P-p),.5)),o.multiply(U,2)));T=o.multiply(J,T);for(var G=0;G<z.length;G++)L[G]=T[z[G]];F=o.add(t,L),F=o.min(o.max(h,F),u),N=o.subtract(i,r(e,F,l)),P=o.multiply(o.transpose(N),mat.dotMultiply(N,q))}var X=(p-P)/o.multiply(o.multiply(o.transpose(T),2),o.add(o.multiply(lambda,T),O));if(X>A)switch(dX2=p-M,M=p,w=t,d=W,t=F,j=(I=this.lm_matx(r,e,w,d,dX2,x,t,i,q,s,l)).JtWJ,O=I.JtWdy,p=I.Chi_sq,W=I.y_hat,x=I.J,V){case 1:lambda=Math.max(lambda/R,1e-7);break;case 2:lambda=Math.max(lambda/(1+J),1e-7);break;case 3:lambda=o.multiply(Math.max(1/3,1-(2*X-1)^3),lambda),nu=2}else switch(p=M,c%(2*v)==0&&(j=(I=this.lm_matx(r,e,w,d,-1,x,t,i,q,s,l)).JtWJ,O=I.JtWdy,dX2=I.Chi_sq,W=I.y_hat,x=I.J),V){case 1:lambda=Math.min(lambda*k,1e7);break;case 2:lambda+=Math.abs((P-p)/2/J);break;case 3:lambda*=nu,nu*=2}}return(q=o.multiply(o.multiply(o.transpose(N),N),n.ones(g,1))).apply(function(r,t){q[r][t]=(g-E+1)/q[r][t]}),j=(I=this.lm_matx(r,e,w,d,-1,x,t,i,q,s,l)).JtWJ,O=I.JtWdy,p=I.Chi_sq,W=I.y_hat,x=I.J,{p:t,X2:p}}console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=e.length,length_y_dat=i.length;var p=0},lm_FD_J:function(r,t,e,i,a,s){var h=i.length,u=e.length;a=a||o.multiply(n.ones(u,1),.001);for(var l=e.clone(),f=new n(h,u),c=new Array(u),m=0;m<u;m++){if(c[m]=a[m]*(1+Math.abs(e[m][0])),e[m]=[l[m][0]+c[m]],0!=c[m])if(y1=r(t,e,s),a[m][0]<0)for(var v=o.dotDivide(o.subtract(y1,i),c[m]),g=0;g<h;g++)f[g][m]=v[g][0];else{e[m][0]=l[m][0]-c[m];for(v=o.dotDivide(o.subtract(y1,r(t,e,s)),2*c[m]),g=0;g<h;g++)f[g][m]=v[g][0]}e[m]=l[m]}return f},lm_Broyden_J:function(r,t,e,n,i){var a=o.subtract(n,r),s=o.transpose(a);return s.div(o.multiply(s,a)),e=o.add(e,o.multiply(o.subtract(i,o.add(t,o.multiply(e,a))),s))},lm_matx:function(r,t,e,i,a,s,h,u,l,f,c,m){u.length;var v=h.length;f=f||.001;var g=r(t,h,c);s=m%(2*v)==0||a>0?this.lm_FD_J(r,t,h,g,f,c):this.lm_Broyden_J(e,i,s,h,g);var w=o.subtract(u,g),d=o.multiply(o.transpose(w),o.dotMultiply(w,l)),p=o.transpose(s);return{JtWJ:o.multiply(p,o.dotMultiply(s,o.multiply(l,n.ones(1,v)))),JtWdy:o.multiply(p,o.dotMultiply(l,w)),Chi_sq:d,y_hat:g,J:s}}};r.exports=i},function(r,t,e){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(r,t,e){r.exports=t=e(24),t.getEquallySpacedData=e(26).getEquallySpacedData,t.SNV=e(27).SNV},function(r,t,e){"use strict";const n=e(10).array;function o(r){for(var t=new Array(r[0].length),e=0;e<t.length;++e)t[e]=new Array(r.length);for(e=0;e<r.length;++e)for(var n=0;n<r[0].length;++n)t[n][e]=r[e][n];return t}r.exports={coordArrayToPoints:function(r,t){if(r.length%t!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var e=r.length/t,n=new Array(e),o=0,i=0;i<r.length;i+=t){for(var a=new Array(t),s=0;s<t;++s)a[s]=r[i+s];n[o]=a,o++}return n},coordArrayToCoordMatrix:function(r,t){if(r.length%t!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var e=new Array(t),n=r.length/t,o=0;o<e.length;o++)e[o]=new Array(n);for(o=0;o<r.length;o+=t)for(var i=0;i<t;++i){var a=Math.floor(o/t);e[i][a]=r[o+i]}return e},coordMatrixToCoordArray:function(r){for(var t=new Array(r.length*r[0].length),e=0,n=0;n<r[0].length;++n)for(var o=0;o<r.length;++o)t[e]=r[o][n],++e;return t},coordMatrixToPoints:o,pointsToCoordArray:function(r){for(var t=new Array(r.length*r[0].length),e=0,n=0;n<r.length;++n)for(var o=0;o<r[0].length;++o)t[e]=r[n][o],++e;return t},pointsToCoordMatrix:o,applyDotProduct:function(r,t){var e,n;r.length<=t.length?(n=r,e=t):(n=t,e=r);for(var o=e.length-n.length+1,i=new Array(o),a=0;a<o;++a){for(var s=0,h=0;h<n.length;++h)s+=n[h]*e[a+h];i[a]=s}return i},scale:function(r,t){var e;e=t.inPlace?r:new Array(r.length);const o=t.max,i=t.min;if("number"==typeof o)if("number"==typeof i)for(var a=n.minMax(r),s=(o-i)/(a.max-a.min),h=0;h<e.length;h++)e[h]=(r[h]-a.min)*s+i;else for(s=o/n.max(r),h=0;h<e.length;h++)e[h]=r[h]*s;else if("number"==typeof i)for(s=i/n.min(r),h=0;h<e.length;h++)e[h]=r[h]*s;return e}}},function(r,t,e){"use strict";var n=e(11);function o(r,t){return r-t}t.max=function(r){for(var t=-1/0,e=0;e<r.length;e++)for(var n=0;n<r[e].length;n++)r[e][n]>t&&(t=r[e][n]);return t},t.min=function(r){for(var t=1/0,e=0;e<r.length;e++)for(var n=0;n<r[e].length;n++)r[e][n]<t&&(t=r[e][n]);return t},t.minMax=function(r){for(var t=1/0,e=-1/0,n=0;n<r.length;n++)for(var o=0;o<r[n].length;o++)r[n][o]<t&&(t=r[n][o]),r[n][o]>e&&(e=r[n][o]);return{min:t,max:e}},t.entropy=function(r,t){void 0===t&&(t=0);for(var e=0,n=r.length,o=r[0].length,i=0;i<n;i++)for(var a=0;a<o;a++)e+=r[i][a]*Math.log(r[i][a]+t);return-e},t.mean=function(r,t){void 0===t&&(t=0);var e,n,o,i,a=r.length,s=r[0].length;if(-1===t){for(e=[0],n=a*s,o=0;o<a;o++)for(i=0;i<s;i++)e[0]+=r[o][i];e[0]/=n}else if(0===t)for(e=new Array(s),n=a,i=0;i<s;i++){for(e[i]=0,o=0;o<a;o++)e[i]+=r[o][i];e[i]/=n}else{if(1!==t)throw new Error("Invalid dimension");for(e=new Array(a),n=s,i=0;i<a;i++){for(e[i]=0,o=0;o<s;o++)e[i]+=r[i][o];e[i]/=n}}return e},t.sum=function(r,t){void 0===t&&(t=0);var e,n,o,i=r.length,a=r[0].length;if(-1===t)for(e=[0],n=0;n<i;n++)for(o=0;o<a;o++)e[0]+=r[n][o];else if(0===t)for(e=new Array(a),o=0;o<a;o++)for(e[o]=0,n=0;n<i;n++)e[o]+=r[n][o];else{if(1!==t)throw new Error("Invalid dimension");for(e=new Array(i),o=0;o<i;o++)for(e[o]=0,n=0;n<a;n++)e[o]+=r[o][n]}return e},t.product=function(r,t){void 0===t&&(t=0);var e,n,o,i=r.length,a=r[0].length;if(-1===t)for(e=[1],n=0;n<i;n++)for(o=0;o<a;o++)e[0]*=r[n][o];else if(0===t)for(e=new Array(a),o=0;o<a;o++)for(e[o]=1,n=0;n<i;n++)e[o]*=r[n][o];else{if(1!==t)throw new Error("Invalid dimension");for(e=new Array(i),o=0;o<i;o++)for(e[o]=1,n=0;n<a;n++)e[o]*=r[o][n]}return e},t.standardDeviation=function(r,e,n){for(var o=t.variance(r,e,n),i=o.length,a=0;a<i;a++)o[a]=Math.sqrt(o[a]);return o},t.variance=function(r,e,n){void 0===n&&(n=!0),e=e||t.mean(r);var o=r.length;if(0===o)return[];for(var i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0,f=0;f<o;f++)h+=l=r[f][s]-e[s],u+=l*l;a[s]=n?(u-h*h/o)/(o-1):(u-h*h/o)/o}return a},t.median=function(r){for(var t=r.length,e=r[0].length,n=new Array(e),i=0;i<e;i++){for(var a=new Array(t),s=0;s<t;s++)a[s]=r[s][i];a.sort(o);var h=a.length;n[i]=h%2==0?.5*(a[h/2]+a[h/2-1]):a[Math.floor(h/2)]}return n},t.mode=function(r){var t,e,n=r.length,o=r[0].length,i=new Array(o);for(t=0;t<o;t++){for(var a=new Array(n),s=0;s<n;s++)a[s]=0;var h=new Array(n),u=0;for(e=0;e<n;e++){var l=h.indexOf(r[e][t]);l>=0?a[l]++:(h[u]=r[e][t],a[u]=1,u++)}var f=0,c=0;for(e=0;e<u;e++)a[e]>f&&(f=a[e],c=e);i[t]=h[c]}return i},t.skewness=function(r,e){void 0===e&&(e=!0);for(var n=t.mean(r),o=r.length,i=n.length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0;l<o;l++){var f=r[l][s]-n[s];h+=f*f,u+=f*f*f}var c=h/o,m=u/o/Math.pow(c,1.5);if(e){var v=Math.sqrt(o*(o-1)),g=o-2;a[s]=v/g*m}else a[s]=m}return a},t.kurtosis=function(r,e){void 0===e&&(e=!0);for(var n=t.mean(r),o=r.length,i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0;l<o;l++){var f=r[l][s]-n[s];h+=f*f,u+=f*f*f*f}var c=h/o,m=u/o;if(e){var v=h/(o-1),g=o*(o+1)/((o-1)*(o-2)*(o-3)),w=u/(v*v),d=(o-1)*(o-1)/((o-2)*(o-3));a[s]=g*w-3*d}else a[s]=m/(c*c)-3}return a},t.standardError=function(r){for(var e=r.length,n=t.standardDeviation(r),o=n.length,i=new Array(o),a=Math.sqrt(e),s=0;s<o;s++)i[s]=n[s]/a;return i},t.covariance=function(r,e){return t.scatter(r,void 0,e)},t.scatter=function(r,e,n){void 0===n&&(n=0),void 0===e&&(0===n?e=r.length-1:1===n&&(e=r[0].length-1));var o=t.mean(r,n),i=r.length;if(0===i)return[[]];var a,s,h,u,l,f=r[0].length;if(0===n){for(a=new Array(f),s=0;s<f;s++)a[s]=new Array(f);for(s=0;s<f;s++)for(h=s;h<f;h++){for(u=0,l=0;l<i;l++)u+=(r[l][h]-o[h])*(r[l][s]-o[s]);u/=e,a[s][h]=u,a[h][s]=u}}else{if(1!==n)throw new Error("Invalid dimension");for(a=new Array(i),s=0;s<i;s++)a[s]=new Array(i);for(s=0;s<i;s++)for(h=s;h<i;h++){for(u=0,l=0;l<f;l++)u+=(r[h][l]-o[h])*(r[s][l]-o[s]);u/=e,a[s][h]=u,a[h][s]=u}}return a},t.correlation=function(r){var e,n,o=t.mean(r),i=t.standardDeviation(r,!0,o),a=t.zScores(r,o,i),s=r.length,h=r[0].length,u=new Array(h);for(e=0;e<h;e++)u[e]=new Array(h);for(e=0;e<h;e++)for(n=e;n<h;n++){for(var l=0,f=0,c=a.length;f<c;f++)l+=a[f][n]*a[f][e];l/=s-1,u[e][n]=l,u[n][e]=l}return u},t.zScores=function(r,e,n){return e=e||t.mean(r),void 0===n&&(n=t.standardDeviation(r,!0,e)),t.standardize(t.center(r,e,!1),n,!0)},t.center=function(r,e,n){e=e||t.mean(r);var o,i,a,s=r,h=r.length;if(!n)for(s=new Array(h),o=0;o<h;o++)s[o]=new Array(r[o].length);for(o=0;o<h;o++){var u=s[o];for(i=0,a=u.length;i<a;i++)u[i]=r[o][i]-e[i]}return s},t.standardize=function(r,e,n){void 0===e&&(e=t.standardDeviation(r));var o,i,a,s=r,h=r.length;if(!n)for(s=new Array(h),o=0;o<h;o++)s[o]=new Array(r[o].length);for(o=0;o<h;o++){var u=s[o],l=r[o];for(i=0,a=u.length;i<a;i++)0===e[i]||isNaN(e[i])||(u[i]=l[i]/e[i])}return s},t.weightedVariance=function(r,e){var n=t.mean(r),o=r.length;if(0===o)return[];for(var i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0,f=0;f<o;f++){var c=r[f][s]-n[s],m=e[f];h+=m*(c*c),l+=m,u+=m*m}a[s]=h*(l/(l*l-u))}return a},t.weightedMean=function(r,t,e){void 0===e&&(e=0);var o=r.length;if(0===o)return[];var i,a,s,h,u,l,f=r[0].length;if(0===e){for(i=new Array(f),a=0;a<f;a++)i[a]=0;for(a=0;a<o;a++)for(l=r[a],u=t[a],h=0;h<f;h++)i[h]+=l[h]*u}else{if(1!==e)throw new Error("Invalid dimension");for(i=new Array(o),a=0;a<o;a++)i[a]=0;for(h=0;h<o;h++)for(l=r[h],u=t[h],a=0;a<f;a++)i[h]+=l[a]*u}var c=n.sum(t);if(0!==c)for(a=0,s=i.length;a<s;a++)i[a]/=c;return i},t.weightedCovariance=function(r,e,n,o){o=o||0,n=n||t.weightedMean(r,e,o);for(var i=0,a=0,s=0,h=e.length;s<h;s++)i+=e[s],a+=e[s]*e[s];var u=i/(i*i-a);return t.weightedScatter(r,e,n,u,o)},t.weightedScatter=function(r,e,n,o,i){i=i||0,n=n||t.weightedMean(r,e,i),void 0===o&&(o=1);var a=r.length;if(0===a)return[[]];var s,h,u,l,f,c=r[0].length;if(0===i){for(s=new Array(c),h=0;h<c;h++)s[h]=new Array(c);for(h=0;h<c;h++)for(u=h;u<c;u++){for(f=0,l=0;l<a;l++)f+=e[l]*(r[l][u]-n[u])*(r[l][h]-n[h]);s[h][u]=f*o,s[u][h]=f*o}}else{if(1!==i)throw new Error("Invalid dimension");for(s=new Array(a),h=0;h<a;h++)s[h]=new Array(a);for(h=0;h<a;h++)for(u=h;u<a;u++){for(f=0,l=0;l<c;l++)f+=e[l]*(r[u][l]-n[u])*(r[h][l]-n[h]);s[h][u]=f*o,s[u][h]=f*o}}return s}},function(r,t,e){"use strict";function n(r,t,e,n){return.5*e*t*t+n*t-(.5*e*r*r+n*r)}t.getEquallySpacedData=function(r,t,e){if(r.length>1&&r[0]>r[1]&&(r=r.slice().reverse(),t=t.slice().reverse()),r.length!==t.length)throw new RangeError("the x and y vector doesn't have the same size.");void 0===e&&(e={});var o=void 0===e.from?r[0]:e.from;if(isNaN(o)||!isFinite(o))throw new RangeError("'From' value must be a number");var i=void 0===e.to?r[r.length-1]:e.to;if(isNaN(i)||!isFinite(i))throw new RangeError("'To' value must be a number");var a=o>i;if(a){var s=o;o=i,i=s}var h=void 0===e.numberOfPoints?100:e.numberOfPoints;if(isNaN(h)||!isFinite(h))throw new RangeError("'Number of points' value must be a number");if(h<1)throw new RangeError("the number of point must be higher than 1");var u="slot"===("slot"===e.variant?"slot":"smooth")?function(r,t,e,n,o){var i=r.length,a=(n-e)/(o-1),s=a/2,h=r[r.length-1]-r[r.length-2],u=e-s,l=new Array(o),f=u,c=u+a,m=-Number.MAX_VALUE,v=0,g=r[0],w=t[0],d=0,p=!0,M=0,x=0,y=1,b=0;r:for(;;){if(m>=g)throw new Error("x must be an increasing serie");for(;m-c>0;){if(p&&(x++,p=!1),l[b]=x<=0?0:M/x,++b===o)break r;f=c,c+=a,M=0,x=0}m>f&&(M+=v,x++),(m===-Number.MAX_VALUE||d>1)&&x--,m=g,v=w,y<i?(g=r[y],w=t[y],y++):(g+=h,w=0,d++)}return l}(r,t,o,i,h):function(r,t,e,o,i){var a=r.length,s=(o-e)/(i-1),h=e-s/2,u=new Array(i),l=r[1]-r[0],f=r[r.length-1]-r[r.length-2],c=h,m=h+s,v=Number.MIN_VALUE,g=0,w=r[0]-l,d=0,p=0,M=0,x=0,y=0,b=0,A=0,S=0;function k(r,t,e,n){return(n-t)/(e-r)}r:for(;;){for(;w-m>=0;){var R=n(0,m-v,M,g);if(b=p+R,u[S]=(b-y)/s,++S===i)break r;c=m,m+=s,y=b}v<=c&&c<=w&&(R=n(0,c-v,M,g),y=p+R),p+=n(v,w,M,x),v=w,g=d,A<a?(w=r[A],d=t[A],A++):A===a&&(w+=f,d=0),M=k(v,g,w,d),x=-M*v+g}return u}(r,t,o,i,h);return a?u.reverse():u},t.integral=n},function(r,t,e){"use strict";t.SNV=function(r){for(var t=n.mean(r),e=n.standardDeviation(r),o=r.slice(),i=0;i<r.length;i++)o[i]=(o[i]-t)/e;return o};var n=e(10).array},function(r,t,e){"use strict";var n=e(1);r.exports=class extends n{constructor(r){super(r,r.columns,r.rows)}set(r,t,e){return this.matrix.set(t,r,e),this}get(r,t){return this.matrix.get(t,r)}}},function(r,t,e){"use strict";var n=e(1);r.exports=class extends n{constructor(r,t){super(r,1,r.columns),this.row=t}set(r,t,e){return this.matrix.set(this.row,t,e),this}get(r,t){return this.matrix.get(this.row,t)}}},function(r,t,e){"use strict";var n=e(1),o=e(3);r.exports=class extends n{constructor(r,t,e,n,i){o.checkRange(r,t,e,n,i),super(r,e-t+1,i-n+1),this.startRow=t,this.startColumn=n}set(r,t,e){return this.matrix.set(this.startRow+r,this.startColumn+t,e),this}get(r,t){return this.matrix.get(this.startRow+r,this.startColumn+t)}}},function(r,t,e){"use strict";var n=e(1),o=e(3);r.exports=class extends n{constructor(r,t,e){var n=o.checkIndices(r,t,e);super(r,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(r,t,e){return this.matrix.set(this.rowIndices[r],this.columnIndices[t],e),this}get(r,t){return this.matrix.get(this.rowIndices[r],this.columnIndices[t])}}},function(r,t,e){"use strict";var n=e(1);r.exports=class extends n{constructor(r,t){super(r,r.rows,1),this.column=t}set(r,t,e){return this.matrix.set(r,this.column,e),this}get(r){return this.matrix.get(r,this.column)}}},function(r,t,e){"use strict";var n=e(1);r.exports=class extends n{constructor(r){super(r,r.rows,r.columns)}set(r,t,e){return this.matrix.set(this.rows-r-1,t,e),this}get(r,t){return this.matrix.get(this.rows-r-1,t)}}},function(r,t,e){"use strict";var n=e(1);r.exports=class extends n{constructor(r){super(r,r.rows,r.columns)}set(r,t,e){return this.matrix.set(r,this.columns-t-1,e),this}get(r,t){return this.matrix.get(r,this.columns-t-1)}}},function(r,t,e){"use strict";var n=e(0).Matrix,o=e(9),i=e(36),a=e(8),s=e(37),h=e(38);function u(r){return l(r=n.checkMatrix(r),n.eye(r.rows))}function l(r,t){return r=n.checkMatrix(r),t=n.checkMatrix(t),r.isSquare()?new a(r).solve(t):new s(r).solve(t)}n.inverse=n.inv=u,n.prototype.inverse=n.prototype.inv=function(){return u(this)},n.solve=l,n.prototype.solve=function(r){return l(this,r)},r.exports={SingularValueDecomposition:o,SVD:o,EigenvalueDecomposition:i,EVD:i,LuDecomposition:a,LU:a,QrDecomposition:s,QR:s,CholeskyDecomposition:h,CHO:h,inverse:u,solve:l}},function(r,t,e){"use strict";const n=e(0).Matrix,o=e(4),i=o.hypotenuse,a=o.getFilled2DArray,s={assumeSymmetric:!1};function h(r,t){if(t=Object.assign({},s,t),!(this instanceof h))return new h(r,t);if(!(r=n.checkMatrix(r)).isSquare())throw new Error("Matrix is not a square matrix");var e,o,l=r.columns,f=a(l,l,0),c=new Array(l),m=new Array(l),v=r;if(!!t.assumeSymmetric||r.isSymmetric()){for(e=0;e<l;e++)for(o=0;o<l;o++)f[e][o]=v.get(e,o);!function(r,t,e,n){var o,i,a,s,h,u,l,f;for(h=0;h<r;h++)e[h]=n[r-1][h];for(s=r-1;s>0;s--){for(f=0,a=0,u=0;u<s;u++)f+=Math.abs(e[u]);if(0===f)for(t[s]=e[s-1],h=0;h<s;h++)e[h]=n[s-1][h],n[s][h]=0,n[h][s]=0;else{for(u=0;u<s;u++)e[u]/=f,a+=e[u]*e[u];for(o=e[s-1],i=Math.sqrt(a),o>0&&(i=-i),t[s]=f*i,a-=o*i,e[s-1]=o-i,h=0;h<s;h++)t[h]=0;for(h=0;h<s;h++){for(o=e[h],n[h][s]=o,i=t[h]+n[h][h]*o,u=h+1;u<=s-1;u++)i+=n[u][h]*e[u],t[u]+=n[u][h]*o;t[h]=i}for(o=0,h=0;h<s;h++)t[h]/=a,o+=t[h]*e[h];for(l=o/(a+a),h=0;h<s;h++)t[h]-=l*e[h];for(h=0;h<s;h++){for(o=e[h],i=t[h],u=h;u<=s-1;u++)n[u][h]-=o*t[u]+i*e[u];e[h]=n[s-1][h],n[s][h]=0}}e[s]=a}for(s=0;s<r-1;s++){if(n[r-1][s]=n[s][s],n[s][s]=1,0!==(a=e[s+1])){for(u=0;u<=s;u++)e[u]=n[u][s+1]/a;for(h=0;h<=s;h++){for(i=0,u=0;u<=s;u++)i+=n[u][s+1]*n[u][h];for(u=0;u<=s;u++)n[u][h]-=i*e[u]}}for(u=0;u<=s;u++)n[u][s+1]=0}for(h=0;h<r;h++)e[h]=n[r-1][h],n[r-1][h]=0;n[r-1][r-1]=1,t[0]=0}(l,m,c,f),function(r,t,e,n){var o,a,s,h,u,l,f,c,m,v,g,w,d,p,M,x;for(s=1;s<r;s++)t[s-1]=t[s];t[r-1]=0;var y=0,b=0,A=Math.pow(2,-52);for(l=0;l<r;l++){for(b=Math.max(b,Math.abs(e[l])+Math.abs(t[l])),f=l;f<r&&!(Math.abs(t[f])<=A*b);)f++;if(f>l){0;do{for(1,o=e[l],c=(e[l+1]-o)/(2*t[l]),m=i(c,1),c<0&&(m=-m),e[l]=t[l]/(c+m),e[l+1]=t[l]*(c+m),v=e[l+1],a=o-e[l],s=l+2;s<r;s++)e[s]-=a;for(y+=a,c=e[f],w=g=1,d=g,p=t[l+1],M=0,x=0,s=f-1;s>=l;s--)for(d=w,w=g,x=M,o=g*t[s],a=g*c,m=i(c,t[s]),t[s+1]=M*m,M=t[s]/m,c=(g=c/m)*e[s]-M*o,e[s+1]=a+M*(g*o+M*e[s]),u=0;u<r;u++)a=n[u][s+1],n[u][s+1]=M*n[u][s]+g*a,n[u][s]=g*n[u][s]-M*a;c=-M*x*d*p*t[l]/v,t[l]=M*c,e[l]=g*c}while(Math.abs(t[l])>A*b)}e[l]=e[l]+y,t[l]=0}for(s=0;s<r-1;s++){for(u=s,c=e[s],h=s+1;h<r;h++)e[h]<c&&(u=h,c=e[h]);if(u!==s)for(e[u]=e[s],e[s]=c,h=0;h<r;h++)c=n[h][s],n[h][s]=n[h][u],n[h][u]=c}}(l,m,c,f)}else{var g=a(l,l,0),w=new Array(l);for(o=0;o<l;o++)for(e=0;e<l;e++)g[e][o]=v.get(e,o);!function(r,t,e,n){var o,i,a,s,h,u,l,f=r-1;for(u=1;u<=f-1;u++){for(l=0,s=u;s<=f;s++)l+=Math.abs(t[s][u-1]);if(0!==l){for(a=0,s=f;s>=u;s--)e[s]=t[s][u-1]/l,a+=e[s]*e[s];for(i=Math.sqrt(a),e[u]>0&&(i=-i),a-=e[u]*i,e[u]=e[u]-i,h=u;h<r;h++){for(o=0,s=f;s>=u;s--)o+=e[s]*t[s][h];for(o/=a,s=u;s<=f;s++)t[s][h]-=o*e[s]}for(s=0;s<=f;s++){for(o=0,h=f;h>=u;h--)o+=e[h]*t[s][h];for(o/=a,h=u;h<=f;h++)t[s][h]-=o*e[h]}e[u]=l*e[u],t[u][u-1]=l*i}}for(s=0;s<r;s++)for(h=0;h<r;h++)n[s][h]=s===h?1:0;for(u=f-1;u>=1;u--)if(0!==t[u][u-1]){for(s=u+1;s<=f;s++)e[s]=t[s][u-1];for(h=u;h<=f;h++){for(i=0,s=u;s<=f;s++)i+=e[s]*n[s][h];for(i=i/e[u]/t[u][u-1],s=u;s<=f;s++)n[s][h]+=i*e[s]}}}(l,g,w,f),function(r,t,e,n,o){var i,a,s,h,l,f,c,m,v,g,w,d,p,M,x,y=r-1,b=r-1,A=Math.pow(2,-52),S=0,k=0,R=0,V=0,_=0,z=0,E=0,C=0;for(i=0;i<r;i++)for((i<0||i>b)&&(e[i]=o[i][i],t[i]=0),a=Math.max(i-1,0);a<r;a++)k+=Math.abs(o[i][a]);for(;y>=0;){for(h=y;h>0&&(0===(z=Math.abs(o[h-1][h-1])+Math.abs(o[h][h]))&&(z=k),!(Math.abs(o[h][h-1])<A*z));)h--;if(h===y)o[y][y]=o[y][y]+S,e[y]=o[y][y],t[y]=0,y--,C=0;else if(h===y-1){if(c=o[y][y-1]*o[y-1][y],R=(o[y-1][y-1]-o[y][y])/2,V=R*R+c,E=Math.sqrt(Math.abs(V)),o[y][y]=o[y][y]+S,o[y-1][y-1]=o[y-1][y-1]+S,m=o[y][y],V>=0){for(E=R>=0?R+E:R-E,e[y-1]=m+E,e[y]=e[y-1],0!==E&&(e[y]=m-c/E),t[y-1]=0,t[y]=0,m=o[y][y-1],z=Math.abs(m)+Math.abs(E),R=m/z,V=E/z,_=Math.sqrt(R*R+V*V),R/=_,V/=_,a=y-1;a<r;a++)E=o[y-1][a],o[y-1][a]=V*E+R*o[y][a],o[y][a]=V*o[y][a]-R*E;for(i=0;i<=y;i++)E=o[i][y-1],o[i][y-1]=V*E+R*o[i][y],o[i][y]=V*o[i][y]-R*E;for(i=0;i<=b;i++)E=n[i][y-1],n[i][y-1]=V*E+R*n[i][y],n[i][y]=V*n[i][y]-R*E}else e[y-1]=m+R,e[y]=m+R,t[y-1]=E,t[y]=-E;y-=2,C=0}else{if(m=o[y][y],v=0,c=0,h<y&&(v=o[y-1][y-1],c=o[y][y-1]*o[y-1][y]),10===C){for(S+=m,i=0;i<=y;i++)o[i][i]-=m;z=Math.abs(o[y][y-1])+Math.abs(o[y-1][y-2]),m=v=.75*z,c=-.4375*z*z}if(30===C&&(z=(z=(v-m)/2)*z+c)>0){for(z=Math.sqrt(z),v<m&&(z=-z),z=m-c/((v-m)/2+z),i=0;i<=y;i++)o[i][i]-=z;S+=z,m=v=c=.964}for(C+=1,l=y-2;l>=h&&(E=o[l][l],R=((_=m-E)*(z=v-E)-c)/o[l+1][l]+o[l][l+1],V=o[l+1][l+1]-E-_-z,_=o[l+2][l+1],z=Math.abs(R)+Math.abs(V)+Math.abs(_),R/=z,V/=z,_/=z,l!==h)&&!(Math.abs(o[l][l-1])*(Math.abs(V)+Math.abs(_))<A*(Math.abs(R)*(Math.abs(o[l-1][l-1])+Math.abs(E)+Math.abs(o[l+1][l+1]))));)l--;for(i=l+2;i<=y;i++)o[i][i-2]=0,i>l+2&&(o[i][i-3]=0);for(s=l;s<=y-1&&(M=s!==y-1,s!==l&&(R=o[s][s-1],V=o[s+1][s-1],_=M?o[s+2][s-1]:0,0!==(m=Math.abs(R)+Math.abs(V)+Math.abs(_))&&(R/=m,V/=m,_/=m)),0!==m);s++)if(z=Math.sqrt(R*R+V*V+_*_),R<0&&(z=-z),0!==z){for(s!==l?o[s][s-1]=-z*m:h!==l&&(o[s][s-1]=-o[s][s-1]),m=(R+=z)/z,v=V/z,E=_/z,V/=R,_/=R,a=s;a<r;a++)R=o[s][a]+V*o[s+1][a],M&&(R+=_*o[s+2][a],o[s+2][a]=o[s+2][a]-R*E),o[s][a]=o[s][a]-R*m,o[s+1][a]=o[s+1][a]-R*v;for(i=0;i<=Math.min(y,s+3);i++)R=m*o[i][s]+v*o[i][s+1],M&&(R+=E*o[i][s+2],o[i][s+2]=o[i][s+2]-R*_),o[i][s]=o[i][s]-R,o[i][s+1]=o[i][s+1]-R*V;for(i=0;i<=b;i++)R=m*n[i][s]+v*n[i][s+1],M&&(R+=E*n[i][s+2],n[i][s+2]=n[i][s+2]-R*_),n[i][s]=n[i][s]-R,n[i][s+1]=n[i][s+1]-R*V}}}if(0===k)return;for(y=r-1;y>=0;y--)if(R=e[y],0===(V=t[y]))for(h=y,o[y][y]=1,i=y-1;i>=0;i--){for(c=o[i][i]-R,_=0,a=h;a<=y;a++)_+=o[i][a]*o[a][y];if(t[i]<0)E=c,z=_;else if(h=i,0===t[i]?o[i][y]=0!==c?-_/c:-_/(A*k):(m=o[i][i+1],v=o[i+1][i],V=(e[i]-R)*(e[i]-R)+t[i]*t[i],f=(m*z-E*_)/V,o[i][y]=f,o[i+1][y]=Math.abs(m)>Math.abs(E)?(-_-c*f)/m:(-z-v*f)/E),f=Math.abs(o[i][y]),A*f*f>1)for(a=i;a<=y;a++)o[a][y]=o[a][y]/f}else if(V<0)for(h=y-1,Math.abs(o[y][y-1])>Math.abs(o[y-1][y])?(o[y-1][y-1]=V/o[y][y-1],o[y-1][y]=-(o[y][y]-R)/o[y][y-1]):(x=u(0,-o[y-1][y],o[y-1][y-1]-R,V),o[y-1][y-1]=x[0],o[y-1][y]=x[1]),o[y][y-1]=0,o[y][y]=1,i=y-2;i>=0;i--){for(g=0,w=0,a=h;a<=y;a++)g+=o[i][a]*o[a][y-1],w+=o[i][a]*o[a][y];if(c=o[i][i]-R,t[i]<0)E=c,_=g,z=w;else if(h=i,0===t[i]?(x=u(-g,-w,c,V),o[i][y-1]=x[0],o[i][y]=x[1]):(m=o[i][i+1],v=o[i+1][i],d=(e[i]-R)*(e[i]-R)+t[i]*t[i]-V*V,p=2*(e[i]-R)*V,0===d&&0===p&&(d=A*k*(Math.abs(c)+Math.abs(V)+Math.abs(m)+Math.abs(v)+Math.abs(E))),x=u(m*_-E*g+V*w,m*z-E*w-V*g,d,p),o[i][y-1]=x[0],o[i][y]=x[1],Math.abs(m)>Math.abs(E)+Math.abs(V)?(o[i+1][y-1]=(-g-c*o[i][y-1]+V*o[i][y])/m,o[i+1][y]=(-w-c*o[i][y]-V*o[i][y-1])/m):(x=u(-_-v*o[i][y-1],-z-v*o[i][y],E,V),o[i+1][y-1]=x[0],o[i+1][y]=x[1])),f=Math.max(Math.abs(o[i][y-1]),Math.abs(o[i][y])),A*f*f>1)for(a=i;a<=y;a++)o[a][y-1]=o[a][y-1]/f,o[a][y]=o[a][y]/f}for(i=0;i<r;i++)if(i<0||i>b)for(a=i;a<r;a++)n[i][a]=o[i][a];for(a=r-1;a>=0;a--)for(i=0;i<=b;i++){for(E=0,s=0;s<=Math.min(a,b);s++)E+=n[i][s]*o[s][a];n[i][a]=E}}(l,m,c,f,g)}this.n=l,this.e=m,this.d=c,this.V=f}function u(r,t,e,n){var o,i;return Math.abs(e)>Math.abs(n)?[(r+(o=n/e)*t)/(i=e+o*n),(t-o*r)/i]:[((o=e/n)*r+t)/(i=n+o*e),(o*t-r)/i]}h.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return n.isMatrix(this.V)||(this.V=new n(this.V)),this.V},get diagonalMatrix(){var r,t,e=this.n,o=this.e,i=this.d,a=new n(e,e);for(r=0;r<e;r++){for(t=0;t<e;t++)a[r][t]=0;a[r][r]=i[r],o[r]>0?a[r][r+1]=o[r]:o[r]<0&&(a[r][r-1]=o[r])}return a}},r.exports=h},function(r,t,e){"use strict";var n=e(0).Matrix,o=e(4).hypotenuse;function i(r){if(!(this instanceof i))return new i(r);var t,e,a,s,h=(r=n.checkMatrix(r)).clone(),u=r.rows,l=r.columns,f=new Array(l);for(a=0;a<l;a++){var c=0;for(t=a;t<u;t++)c=o(c,h[t][a]);if(0!==c){for(h[a][a]<0&&(c=-c),t=a;t<u;t++)h[t][a]/=c;for(h[a][a]+=1,e=a+1;e<l;e++){for(s=0,t=a;t<u;t++)s+=h[t][a]*h[t][e];for(s=-s/h[a][a],t=a;t<u;t++)h[t][e]+=s*h[t][a]}}f[a]=-c}this.QR=h,this.Rdiag=f}i.prototype={solve:function(r){r=n.checkMatrix(r);var t=this.QR,e=t.rows;if(r.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,i,a,s,h=r.columns,u=r.clone(),l=t.columns;for(a=0;a<l;a++)for(i=0;i<h;i++){for(s=0,o=a;o<e;o++)s+=t[o][a]*u[o][i];for(s=-s/t[a][a],o=a;o<e;o++)u[o][i]+=s*t[o][a]}for(a=l-1;a>=0;a--){for(i=0;i<h;i++)u[a][i]/=this.Rdiag[a];for(o=0;o<a;o++)for(i=0;i<h;i++)u[o][i]-=u[a][i]*t[o][a]}return u.subMatrix(0,l-1,0,h-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;t<r;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularMatrix(){var r,t,e=this.QR,o=e.columns,i=new n(o,o);for(r=0;r<o;r++)for(t=0;t<o;t++)i[r][t]=r<t?e[r][t]:r===t?this.Rdiag[r]:0;return i},get orthogonalMatrix(){var r,t,e,o,i=this.QR,a=i.rows,s=i.columns,h=new n(a,s);for(e=s-1;e>=0;e--){for(r=0;r<a;r++)h[r][e]=0;for(h[e][e]=1,t=e;t<s;t++)if(0!==i[e][e]){for(o=0,r=e;r<a;r++)o+=i[r][e]*h[r][t];for(o=-o/i[e][e],r=e;r<a;r++)h[r][t]+=o*i[r][e]}}return h}},r.exports=i},function(r,t,e){"use strict";var n=e(0).Matrix;function o(r){if(!(this instanceof o))return new o(r);if(!(r=n.checkMatrix(r)).isSymmetric())throw new Error("Matrix is not symmetric");var t,e,i,a=r,s=a.rows,h=new n(s,s),u=!0;for(e=0;e<s;e++){var l=h[e],f=0;for(i=0;i<e;i++){var c=h[i],m=0;for(t=0;t<i;t++)m+=c[t]*l[t];l[i]=m=(a[e][i]-m)/h[i][i],f+=m*m}for(u&=(f=a[e][e]-f)>0,h[e][e]=Math.sqrt(Math.max(f,0)),i=e+1;i<s;i++)h[e][i]=0}if(!u)throw new Error("Matrix is not positive definite");this.L=h}o.prototype={get lowerTriangularMatrix(){return this.L},solve:function(r){r=n.checkMatrix(r);var t=this.L,e=t.rows;if(r.rows!==e)throw new Error("Matrix dimensions do not match");var o,i,a,s=r.columns,h=r.clone();for(a=0;a<e;a++)for(i=0;i<s;i++){for(o=0;o<a;o++)h[a][i]-=h[o][i]*t[a][o];h[a][i]/=t[a][a]}for(a=e-1;a>=0;a--)for(i=0;i<s;i++){for(o=a+1;o<e;o++)h[a][i]-=h[o][i]*t[o][a];h[a][i]/=t[a][a]}return h}},r.exports=o},function(r,t,e){"use strict";var n=e(6);r.exports=function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var e=t.width,o=[],i=0,a=0,s=1;for(let t=r.length-1;t>=0;t--)r[t].soft&&o.push(r.splice(t,1)[0]);o.push({x:Number.MAX_VALUE});var h=[[o[0].x,o[0].y]],u=[0];for(let t=1;t<o.length;t++)if(Math.abs(o[t-1].x-o[t].x)<e)h.push([o[t].x,o[t].y]),o[t].y>i&&(i=o[t].y,a=t),u.push(t),s++;else{if(s>2){var l=n.optimizeSingleLorentzian(h,{x:o[a].x,y:i,width:Math.abs(h[0][0]-h[h.length-1][0])});r.push({x:l[0][0],y:l[1][0],width:l[2][0],soft:!1})}else u.forEach(t=>{r.push(o[t])});h=[[o[t].x,o[t].y]],u=[t],i=o[t].y,a=t,s=1}return r.sort(function(r,t){return r.x-t.x}),r}},function(r,t,e){"use strict";r.exports=function(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{factor:e=2,overlap:n=!1}=t;for(let t of r)t.from=t.x-t.width/2*e,t.to=t.x+t.width/2*e;if(!n)for(let t=0;t<r.length-1;t++){let e=r[t],n=r[t+1];e.to>n.from&&(e.to=n.from=(e.to+n.from)/2)}for(let t of r)t.width=t.to-t.from;return r}}])});
//# sourceMappingURL=ml-gsd.min.js.map