!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.GSD=r():t.GSD=r()}(this,function(){return function(t){function r(n){if(o[n])return o[n].exports;var e=o[n]={exports:{},id:n,loaded:!1};return t[n].call(e.exports,e,e.exports,r),e.loaded=!0,e.exports}var o={};return r.m=t,r.c=o,r.p="",r(0)}([function(t,r,o){t.exports.optimize=o(1),t.exports.gsd=o(15)},function(t,r,o){function n(t,r,o,n,e){var i=o.length,s=[],a=[],h=Math.sign(o[1]-o[0]);-1==h&&(e[0]=o.length-1);for(var u=Math.abs(r-t)/2,f=(t+r)/2,c=!1,l=e[0];!c&&i>l&&l>=0;)Math.abs(o[l]-f)<=u?(s.push(o[l]),a.push(n[l]),l+=h):1==Math.sign(f-o[l])?l+=h:c=!0;return e[0]=l,[s,a]}function e(t,r,o,e,a){var h,u,f=[0],c=i(t,e),l=[],m=1;for("gaussian"==a&&(m=1.17741),h=0;h<c.length;h++){var p=c[h].group;if(p.length>1){var w=n(c[h].limits[0]-c[h].limits[1],c[h].limits[0]+c[h].limits[1],r,o,f);if(w[0].length>5){var v=p[0].width/1e3,y=[3,100,v,v,v,10*v,10*v,11,9,1],b=[];for("gaussian"==a?b=s.optimizeGaussianSum(w,p,y):"lorentzian"==a&&(b=s.optimizeLorentzianSum(w,p,y)),u=0;u<b.length;u++)l.push({x:b[u][0][0],y:b[u][1][0],width:b[u][2][0]*m})}}else{p=p[0];var w=n(p.x-e*p.width,p.x+e*p.width,r,o,f);if(w[0].length>5){var v=p.width/1e3,y=[3,100,v,v,v,10*v,10*v,11,9,1],d=[];if("gaussian"==a)var d=s.optimizeSingleGaussian([w[0],w[1]],p,y);else if("lorentzian"==a)var d=s.optimizeSingleLorentzian([w[0],w[1]],p,y);l.push({x:d[0][0],y:d[1][0],width:d[2][0]*m})}}}return l}function i(t,r){var o,n,e,i,s=[],a=[],h=[t[0].x,r*t[0].width];for(o=0;o<t.length;o++)Math.abs(t[o].x-h[0])<r*t[o].width+h[1]?(s.push(t[o]),e=h[0]+h[1],t[o].x+r*t[o].width>e&&(e=t[o].x+r*t[o].width),i=h[0]-h[1],t[o].x-r*t[o].width<i&&(i=t[o].x-r*t[o].width),h=[(e+i)/2,Math.abs(e-i)/2]):(a.push({limits:h,group:s}),s=[t[o]],h=[t[o].x,r*t[o].width]);for(a.push({limits:h,group:s}),o=a.length-2;o>=0;o--)if(Math.abs(a[o].limits[0]-a[o+1].limits[0])<(a[o].limits[1]+a[o+1].limits[1])/2){for(n=0;n<a[o+1].group.length;n++)a[o].group.push(a[o+1].group[n]);e=a[o].limits[0]+a[o].limits[1],a[o+1].limits[0]+a[o+1].limits[1]>e&&(e=a[o+1].limits[0]+a[o+1].limits[1]),i=a[o].limits[0]-a[o].limits[1],a[o+1].limits[0]-a[o+1].limits[1]<i&&(i=a[o+1].limits[0]-a[o+1].limits[1]),a[o].limits=[(e+i)/2,Math.abs(e-i)/2],a.splice(o+1,1)}return a}var s=o(2);t.exports=e},function(t,r,o){"use strict";function n(t,r,o){var n,e,i,s,a=r.length/3,h=t.rows,u=m.zeros(t.length,1);for(e=0;a>e;e++)for(s=Math.pow(r[e+2*a][0]/2,2),n=r[e+a][0]*s,i=0;h>i;i++)u[i][0]+=n/(Math.pow(t[i][0]-r[e][0],2)+s);return u}function e(t,r,o){for(var n=r[1][0]*Math.pow(r[2][0]/2,2),e=t.rows,i=new m(t.rows,t.columns),s=0;e>s;s++)i[s][0]=n/(Math.pow(t[s][0]-r[0][0],2)+Math.pow(r[2][0]/2,2));return i}function i(t,r,o){for(var n=r[2][0]*r[2][0]/2,e=t.rows,i=new m(t.rows,t.columns),s=0;e>s;s++)i[s][0]=r[1][0]*Math.exp(-(t[s][0]-r[0][0])*(t[s][0]-r[0][0])/n);return i}function s(t,r,o){var n=f(t),i=n[0],s=n[1],a=n[2],h=i.columns,u=[h/Math.sqrt(s.dot(s))],o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,1]),l=[],p=Math.abs(i[0][0]-i[1][0]),w=new m([[-p/1e4],[-.001],[-p/1e4]]),v=new m([[r.x],[1],[r.width]]),y=new m([[r.x-p],[.75],[r.width/4]]),b=new m([[r.x+p],[1.25],[4*r.width]]),d=c.optimize(e,v,i,s,u,w,y,b,l,o);return d=d.p,[d[0],[d[1][0]*a],d[2]]}function a(t,r,o){var n=f(t),e=n[0],s=n[1],a=n[2],h=e.columns,u=[h/Math.sqrt(s.dot(s))],o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,1]),l=[],p=Math.abs(e[0][0]-e[1][0]),w=new m([[-p/1e4],[-.001],[-p/1e4]]),w=new m([[-Math.abs(e[0][0]-e[1][0])/1e3],[-.001],[-r.width/1e3]]),v=new m([[r.x],[1],[r.width]]),y=new m([[r.x-p],[.75],[r.width/4]]),b=new m([[r.x+p],[1.25],[4*r.width]]),d=c.optimize(i,v,e,s,u,w,y,b,l,o);return d=d.p,[d[0],[d[1][0]*a],d[2]]}function h(t,r,o){var e,i=f(t),s=i[0],a=i[1],h=i[2],u=s.columns,p=[u/l.sqrt(a.dot(a))],o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,1]),w=[],v=r.length,y=new m(3*v,1),b=new m(3*v,1),d=new m(3*v,1),M=new m(3*v,1),g=Math.abs(s[0][0]-s[1][0]);for(e=0;v>e;e++)y[e][0]=r[e].x,y[e+v][0]=1,y[e+2*v][0]=r[e].width,b[e][0]=r[e].x-g,b[e+v][0]=0,b[e+2*v][0]=r[e].width/4,d[e][0]=r[e].x+g,d[e+v][0]=1.5,d[e+2*v][0]=4*r[e].width,M[e][0]=-g/1e3,M[e+v][0]=-.001,M[e+2*v][0]=-g/1e3;var M=-Math.abs(s[0][0]-s[1][0])/1e4,x=c.optimize(n,y,s,a,p,M,b,d,w,o);x=x.p;var R=new Array(v);for(e=0;v>e;e++)R[e]=[x[e],[x[e+v][0]*h],x[e+2*v]];return R}function u(t,r,o){var e,i=f(t),s=i[0],a=i[1],h=i[2],u=s.rows,p=new m(u,1),w=u/l.sqrt(a.dot(a));for(e=0;u>e;e++)p[e][0]=w;var o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,2]),v=[],y=r.length,b=new m(3*y,1),d=new m(3*y,1),M=new m(3*y,1),g=new m(3*y,1),x=Math.abs(s[0][0]-s[1][0]);for(e=0;y>e;e++)b[e][0]=r[e].x,b[e+y][0]=r[e].y/h,b[e+2*y][0]=r[e].width,d[e][0]=r[e].x-x,d[e+y][0]=.8*r[e].y/h,d[e+2*y][0]=r[e].width/2,M[e][0]=r[e].x+x,M[e+y][0]=1.2*r[e].y/h,M[e+2*y][0]=2*r[e].width,g[e][0]=-x/1e3,g[e+y][0]=-.001,g[e+2*y][0]=-x/1e3;var R=c.optimize(n,b,s,a,p,g,d,M,v,o);R=R.p;var k=new Array(y);for(e=0;y>e;e++)k[e]=[R[e],[R[e+y][0]*h],R[e+2*y]];return k}function f(t){var r,o,n,e=t.length,i=null,s=null,a=0;if(2==e){var h=t[0].length;if(3>h)throw new SizeException(h);if(i=new m(h,1),s=new m(h,1),r=t[0],o=t[1],"number"==typeof r[0])for(n=0;h>n;n++)i[n][0]=r[n],s[n][0]=o[n],o[n]>a&&(a=o[n]);else if("object"==typeof r[0])for(n=0;h>n;n++)i[n][0]=r[n][0],s[n][0]=o[n][0],o[n][0]>a&&(a=o[n][0])}else{var h=e;if(3>h)throw new SizeException(h);for(i=new m(h,1),s=new m(h,1),n=0;h>n;n++)i[n][0]=t[n][0],s[n][0]=t[n][1],s[n][0]>a&&(a=s[n][0])}for(n=0;h>n;n++)s[n][0]/=a;return[i,s,a]}var c=o(3),l=c.Matrix.algebra,m=o(5);t.exports.optimizeSingleLorentzian=s,t.exports.optimizeLorentzianSum=h,t.exports.optimizeSingleGaussian=a,t.exports.optimizeGaussianSum=u,t.exports.singleGaussian=i,t.exports.singleLorentzian=e},function(t,r,o){"use strict";t.exports=o(4),t.exports.Matrix=o(5),t.exports.Matrix.algebra=o(14)},function(t,r,o){var n=o(5),e=o(14),i={optimize:function(t,r,o,i,s,a,h,u,f,c){var l=0,m=0;if("object"!=typeof r[0])for(var p=0;p<r.length;p++)r[p]=[r[p]];var p,w,v=-50,y=r.length,b=i.length,d=n.zeros(y,1),M=n.zeros(b,1),g=.01/v,x=.01/v,R=n.zeros(b,y);if(o.length!=i.length){console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=o.length,length_y_dat=i.length;var g=0;if(!l)return}s=s||Math.sqrt((b-y+1)/e.multiply(e.transpose(i),i)),a=a||.001,h=h||e.multiply(Math.abs(r),-100),u=u||e.multiply(Math.abs(r),100),f=f||1,c=c||[3,10*y,.001,.001,.001,.01,.01,11,9,1];var k=c[0],A=c[1],z=c[2],j=(c[3],c[4],c[5]),C=c[6],V=c[7],E=c[8],S=c[9];if(l&&3==k&&(k=2),!a.length||1==a.length){for(var q=new Array(y),p=0;y>p;p++)q[p]=[a];a=q}var D=[];for(p=0;p<a.length;p++)0!=a[p][0]&&D.push(p);var I=D.length,_=!1,O=null;if(!s.length||s.length<b){var J=e.multiply(n.ones(b,1),s[0]);O=e.dotMultiply(J,J)}else O=e.dotMultiply(s,s);var L=this.lm_matx(t,o,d,M,1,R,r,i,O,a,f),U=L.JtWJ,W=L.JtWdy,g=L.Chi_sq,T=L.y_hat,R=L.J;switch(Math.max(Math.abs(W))<z&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",z),_=!0),S){case 1:lambda=C;break;default:lambda=C*Math.max(e.diag(U)),nu=2}x=g;for(var G=null;!_&&A>=m;){switch(m+=1,S){case 1:G=e.solve(e.add(U,e.multiply(e.diag(e.diag(U)),lambda)),W);break;default:G=e.solve(e.add(U,e.multiply(n.eye(y),lambda)),W)}var Q=new Array(D.length);for(w=0;w<D.length;w++)Q[w]=G[D[w]];var X=e.add(r,Q);for(w=0;w<X.length;w++)X[w][0]=Math.min(Math.max(h[w][0],X[w][0]),u[w][0]);var F=e.subtract(i,t(o,X,f)),P=e.multiply(e.transpose(F),e.dotMultiply(F,O));if(2==S){var Y=e.multiply(e.transpose(W),G),B=e.multiply(Y,e.inv(e.add(e.multiply(e.subtract(P-g),.5)),e.multiply(Y,2)));G=e.multiply(B,G);for(var w=0;w<D.length;w++)Q[w]=G[D[w]];X=e.add(r,Q),X=e.min(e.max(h,X),u),F=e.subtract(i,t(o,X,f)),P=e.multiply(e.transpose(F),mat.dotMultiply(F,O))}var N=(g-P)/e.multiply(e.multiply(e.transpose(G),2),e.add(e.multiply(lambda,G),W));if(N>j)switch(dX2=g-x,x=g,d=r,M=T,r=X,L=this.lm_matx(t,o,d,M,dX2,R,r,i,O,a,f),U=L.JtWJ,W=L.JtWdy,g=L.Chi_sq,T=L.y_hat,R=L.J,S){case 1:lambda=Math.max(lambda/E,1e-7);break;case 2:lambda=Math.max(lambda/(1+B),1e-7);break;case 3:lambda=e.multiply(Math.max(1/3,1-(2*N-1)^3),lambda),nu=2}else switch(g=x,m%(2*y)==0&&(L=this.lm_matx(t,o,d,M,-1,R,r,i,O,a,f),U=L.JtWJ,W=L.JtWdy,dX2=L.Chi_sq,T=L.y_hat,R=L.J),S){case 1:lambda=Math.min(lambda*V,1e7);break;case 2:lambda+=Math.abs((P-g)/2/B);break;case 3:lambda*=nu,nu=2*nu}}return O=e.multiply(e.multiply(e.transpose(F),F),n.ones(b,1)),O.apply(function(t,r){O[t][r]=(b-I+1)/O[t][r]}),L=this.lm_matx(t,o,d,M,-1,R,r,i,O,a,f),U=L.JtWJ,W=L.JtWdy,g=L.Chi_sq,T=L.y_hat,R=L.J,{p:r,X2:g}},lm_FD_J:function(t,r,o,i,s,a){var h=i.length,u=o.length;s=s||e.multiply(n.ones(u,1),.001);for(var f=o.clone(),c=new n(h,u),l=new Array(u),m=0;u>m;m++){if(l[m]=s[m]*(1+Math.abs(o[m][0])),o[m]=[f[m][0]+l[m]],0!=l[m])if(y1=t(r,o,a),s[m][0]<0)for(var p=e.dotDivide(e.subtract(y1,i),l[m]),w=0;h>w;w++)c[w][m]=p[w][0];else{o[m][0]=f[m][0]-l[m];for(var p=e.dotDivide(e.subtract(y1,t(r,o,a)),2*l[m]),w=0;h>w;w++)c[w][m]=p[w][0]}o[m]=f[m]}return c},lm_Broyden_J:function(t,r,o,n,i){var s=e.subtract(n,t),a=e.transpose(s);return a.div(e.multiply(a,s)),o=e.add(o,e.multiply(e.subtract(i,e.add(r,e.multiply(o,s))),a))},lm_matx:function(t,r,o,i,s,a,h,u,f,c,l,m){var p=(u.length,h.length);c=c||.001;var w=t(r,h,l);a=m%(2*p)==0||s>0?this.lm_FD_J(t,r,h,w,c,l):this.lm_Broyden_J(o,i,a,h,w);var v=e.subtract(u,w),y=e.multiply(e.transpose(v),e.dotMultiply(v,f)),b=e.transpose(a),d=e.multiply(b,e.dotMultiply(a,e.multiply(f,n.ones(1,p)))),M=e.multiply(b,e.dotMultiply(f,v));return{JtWJ:d,JtWdy:M,Chi_sq:y,y_hat:w,J:a}}};t.exports=i},function(t,r,o){"use strict";t.exports=o(6),t.exports.Decompositions=t.exports.DC=o(7)},function(t,r){"use strict";function o(t){for(var r=0,o=t.length,n=new Array(o);o>r;r++)n[r]=t[r];return n}function n(t,r){var e,i,s=0;if(Array.isArray(t)){if(i=r,e=i?o(t):t,t=e.length,r=e[0].length,"undefined"==typeof r)throw new TypeError("Data must be a 2D array");if(!(t>0&&r>0))throw new RangeError("Invalid dimensions: "+t+"x"+r);for(;t>s;s++){if(e[s].length!==r)throw new RangeError("Inconsistent array dimensions");i&&(e[s]=o(e[s]))}}else{if("number"!=typeof t)throw new TypeError("Invalid arguments");if(!(t>0&&r>0))throw new RangeError("Invalid dimensions: "+t+"x"+r);for(e=new Array(t);t>s;s++)e[s]=new Array(r)}return Object.defineProperty(e,"rows",{writable:!0,value:t}),Object.defineProperty(e,"columns",{writable:!0,value:r}),e.__proto__=n.prototype,e}var e=Array.prototype.splice,i=Array.prototype.concat;n.from1DArray=function(t,r,o){var e,i,s=0;if(e=t*r,e!==o.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(t);t>s;s++)i[s]=o.slice(s*r,(s+1)*r);return new n(i)},n.rowVector=function(t){return new n([t])},n.columnVector=function(t){for(var r=t.length,o=new Array(r),e=0;r>e;e++)o[e]=[t[e]];return new n(o)},n.empty=function(t,r){return new n(t,r)},n.zeros=function(t,r){return n.empty(t,r).fill(0)},n.ones=function(t,r){return n.empty(t,r).fill(1)},n.rand=function(t,r){for(var o=n.empty(t,r),e=0,i=o.rows;i>e;e++)for(var s=0,a=o.columns;a>s;s++)o[e][s]=Math.random();return o},n.eye=function(t){for(var r=n.zeros(t,t),o=r.rows,e=0;o>e;e++)r[e][e]=1;return r},n.diag=function(t){for(var r=t.length,o=n.zeros(r,r),e=0;r>e;e++)o[e][e]=t[e];return o},n.indices=function(t,r){for(var o=new Array(r-t),n=0;n<o.length;n++)o[n]=t++;return o},n.stack=function(t){var r,o,e;if(n.isMatrix(t)){var i=0,s=0;for(r=0;r<arguments.length;r++)i+=arguments[r].rows,arguments[r].columns>s&&(s=arguments[r].columns);var a=n.zeros(i,s),h=0;for(r=0;r<arguments.length;r++){var u=arguments[r];for(o=0;o<u.rows;o++){for(e=0;e<u.columns;e++)a[h][e]=u[o][e];h++}}return a}if(Array.isArray(t)){var f=n.empty(arguments.length,t.length);for(r=0;r<arguments.length;r++)f.setRow(r,arguments[r]);return f}},n.expand=function(t,r){for(var o=[],e=0;e<r.length;e++)for(var i=0;i<r[e];i++)o.push(t[e]);return new n(o)},n.checkMatrix=function(t){if(!t)throw new TypeError("Argument has to be a matrix");return"Matrix"!==t.klass&&(t=new n(t)),t},n.isMatrix=function(t){return t?"Matrix"===t.klass:!1},Object.defineProperty(n.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(n.prototype,"size",{get:function(){return this.rows*this.columns}}),n.prototype.checkRowIndex=function(t){if(0>t||t>this.rows-1)throw new RangeError("Row index out of range.")},n.prototype.checkColumnIndex=function(t){if(0>t||t>this.columns-1)throw new RangeError("Column index out of range.")},n.prototype.checkDimensions=function(t){if(this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal.")},n.prototype.apply=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)t.call(this,n,e);return this},n.prototype.clone=function(){return new n(this.to2DArray())},n.prototype.to1DArray=function(){return i.apply([],this)},n.prototype.to2DArray=function(){for(var t=this.rows,r=new Array(t),n=0;t>n;n++)r[n]=o(this[n]);return r},n.prototype.isRowVector=function(){return 1===this.rows},n.prototype.isColumnVector=function(){return 1===this.columns},n.prototype.isVector=function(){return 1===this.rows||1===this.columns},n.prototype.isSquare=function(){return this.rows===this.columns},n.prototype.isSymmetric=function(){if(this.isSquare()){for(var t=this.rows,r=0;t>r;r++)for(var o=0;r>=o;o++)if(this[r][o]!==this[o][r])return!1;return!0}return!1},n.prototype.set=function(t,r,o){return this[t][r]=o,this},n.prototype.get=function(t,r){return this[t][r]},n.prototype.fill=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]=t;return this},n.prototype.neg=function(){return this.mulS(-1)},n.prototype.add=function(t){return"number"==typeof t?this.addS(t):(t=n.checkMatrix(t),this.addM(t))},n.prototype.addS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t;return this},n.prototype.addM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t[n][e];return this},n.prototype.sub=function(t){return"number"==typeof t?this.subS(t):(t=n.checkMatrix(t),this.subM(t))},n.prototype.subS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t;return this},n.prototype.subM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t[n][e];return this},n.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):(t=n.checkMatrix(t),this.mulM(t))},n.prototype.mulS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t;return this},n.prototype.mulM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t[n][e];return this},n.prototype.div=function(t){return"number"==typeof t?this.divS(t):(t=n.checkMatrix(t),this.divM(t))},n.prototype.divS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t;return this},n.prototype.divM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t[n][e];return this},n.prototype.getRow=function(t){return this.checkRowIndex(t),o(this[t])},n.prototype.getRowVector=function(t){return n.rowVector(this.getRow(t))},n.prototype.setRow=function(t,r){if(this.checkRowIndex(t),n.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("Invalid row size");return this[t]=o(r),this},n.prototype.removeRow=function(t){if(this.checkRowIndex(t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return e.call(this,t,1),this.rows-=1,this},n.prototype.addRow=function(t,r){if("undefined"==typeof r&&(r=t,t=this.rows),0>t||t>this.rows)throw new RangeError("Row index out of range.");if(n.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("Invalid row size");return e.call(this,t,0,o(r)),this.rows+=1,this},n.prototype.swapRows=function(t,r){this.checkRowIndex(t),this.checkRowIndex(r);var o=this[t];return this[t]=this[r],this[r]=o,this},n.prototype.getColumn=function(t){this.checkColumnIndex(t);for(var r=this.rows,o=new Array(r),n=0;r>n;n++)o[n]=this[n][t];return o},n.prototype.getColumnVector=function(t){return n.columnVector(this.getColumn(t))},n.prototype.setColumn=function(t,r){this.checkColumnIndex(t),n.isMatrix(r)&&(r=r.to1DArray());var o=this.rows;if(r.length!==o)throw new RangeError("Invalid column size");for(var e=0;o>e;e++)this[e][t]=r[e];return this},n.prototype.removeColumn=function(t){if(this.checkColumnIndex(t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var r=0,o=this.rows;o>r;r++)this[r].splice(t,1);return this.columns-=1,this},n.prototype.addColumn=function(t,r){if("undefined"==typeof r&&(r=t,t=this.columns),0>t||t>this.columns)throw new RangeError("Column index out of range.");n.isMatrix(r)&&(r=r.to1DArray());var o=this.rows;if(r.length!==o)throw new RangeError("Invalid column size");for(var e=0;o>e;e++)this[e].splice(t,0,r[e]);return this.columns+=1,this},n.prototype.swapColumns=function(t,r){this.checkRowIndex(t),this.checkRowIndex(r);for(var o,n,e=this.rows,i=0;e>i;i++)n=this[i],o=n[t],n[t]=n[r],n[r]=o;return this},n.prototype.checkRowVector=function(t){if(n.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return t},n.prototype.checkColumnVector=function(t){if(n.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return t},n.prototype.addRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t[e];return this},n.prototype.subRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t[e];return this},n.prototype.mulRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t[e];return this},n.prototype.divRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t[e];return this},n.prototype.addColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t[n];return this},n.prototype.subColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t[n];return this},n.prototype.mulColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t[n];return this},n.prototype.divColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t[n];return this},n.prototype.mulRow=function(t,r){this.checkRowIndex(t);for(var o=0,n=this.columns;n>o;o++)this[t][o]*=r;return this},n.prototype.mulColumn=function(t,r){this.checkColumnIndex(t);for(var o=0,n=this.rows;n>o;o++)this[o][t]*=r},n.prototype.max=function(){for(var t=-(1/0),r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]>t&&(t=this[n][e]);return t},n.prototype.maxIndex=function(){for(var t=-(1/0),r={},o=this.rows,n=this.columns,e=0;o>e;e++)for(var i=0;n>i;i++)this[e][i]>t&&(t=this[e][i],r.row=e,r.column=i);return r},n.prototype.min=function(){for(var t=1/0,r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]<t&&(t=this[n][e]);return t},n.prototype.minIndex=function(){for(var t=1/0,r={},o=this.rows,n=this.columns,e=0;o>e;e++)for(var i=0;n>i;i++)this[e][i]<t&&(t=this[e][i],r.row=e,r.column=i);return r},n.prototype.maxRow=function(t){this.checkRowIndex(t);for(var r=-(1/0),o=0,n=this.columns;n>o;o++)this[t][o]>r&&(r=this[t][o]);return r},n.prototype.maxRowIndex=function(t){this.checkRowIndex(t);for(var r=-(1/0),o={row:t},n=0,e=this.columns;e>n;n++)this[t][n]>r&&(r=this[t][n],o.column=n);return o},n.prototype.minRow=function(t){this.checkRowIndex(t);for(var r=1/0,o=0,n=this.columns;n>o;o++)this[t][o]<r&&(r=this[t][o]);return r},n.prototype.minRowIndex=function(t){this.checkRowIndex(t);for(var r=1/0,o={row:t,column:0},n=0,e=this.columns;e>n;n++)this[t][n]<r&&(r=this[t][n],o.column=n);return o},n.prototype.maxColumn=function(t){this.checkColumnIndex(t);for(var r=-(1/0),o=0,n=this.rows;n>o;o++)this[o][t]>r&&(r=this[o][t]);return r},n.prototype.maxColumnIndex=function(t){this.checkColumnIndex(t);for(var r=-(1/0),o={row:0,column:t},n=0,e=this.rows;e>n;n++)this[n][t]>r&&(r=this[n][t],o.row=n);return o},n.prototype.minColumn=function(t){this.checkColumnIndex(t);for(var r=1/0,o=0,n=this.rows;n>o;o++)this[o][t]<r&&(r=this[o][t]);return r},n.prototype.minColumnIndex=function(t){this.checkColumnIndex(t);for(var r=1/0,o={row:0,column:t},n=0,e=this.rows;e>n;n++)this[n][t]<r&&(r=this[n][t],o.row=n);return o},n.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),t=0,r=this.rows;r>t;t++)s[t]=this[t][t];return s},n.prototype.sum=function(){for(var t=0,r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)t+=this[n][e];return t},n.prototype.mean=function(){return this.sum()/this.size},n.prototype.prod=function a(){for(var a=1,t=this.rows,r=this.columns,o=0;t>o;o++)for(var n=0;r>n;n++)a*=this[o][n];return a},n.prototype.cumulativeSum=function(){for(var t=0,r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)t+=this[n][e],this[n][e]=t;return this},n.prototype.dot=function h(t){if(this.size!==t.size)throw new RangeError("vectors do not have the same size");for(var r=this.to1DArray(),o=t.to1DArray(),h=0,n=r.length,e=0;n>e;e++)h+=r[e]*o[e];return h},n.prototype.mmul=function(t){if(!n.isMatrix(t))throw new TypeError('parameter "other" must be a matrix');this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var r,o,e,i=this.rows,s=this.columns,a=t.columns,h=new n(i,a),u=new Array(s);for(o=0;a>o;o++){for(e=0;s>e;e++)u[e]=t[e][o];for(r=0;i>r;r++){var f=this[r],c=0;for(e=0;s>e;e++)c+=f[e]*u[e];h[r][o]=c}}return h},n.prototype.sortRows=function(t){for(var r=0,o=this.rows;o>r;r++)this[r].sort(t);return this},n.prototype.sortColumns=function(t){for(var r=0,o=this.columns;o>r;r++)this.setColumn(r,this.getColumn(r).sort(t));return this},n.prototype.transpose=function(){for(var t=new n(this.columns,this.rows),r=this.rows,o=this.columns,e=0;r>e;e++)for(var i=0;o>i;i++)t[i][e]=this[e][i];return t},n.prototype.subMatrix=function(t,r,o,e){if(t>r||o>e||0>t||t>=this.rows||0>r||r>=this.rows||0>o||o>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range");for(var i=new n(r-t+1,e-o+1),s=t;r>=s;s++)for(var a=o;e>=a;a++)i[s-t][a-o]=this[s][a];return i},n.prototype.subMatrixRow=function(t,r,o){if("undefined"==typeof r?(r=0,o=this.columns-1):"undefined"==typeof o&&(o=this.columns-1),r>o||0>r||r>=this.columns||0>o||o>=this.columns)throw new RangeError("Argument out of range.");for(var e=t.length,i=this.rows,s=new n(e,o-r+1),a=0;e>a;a++)for(var h=r;o>=h;h++){if(t[a]<0||t[a]>=i)throw new RangeError("Argument out of range.");s[a][h-r]=this[t[a]][h]}return s},n.prototype.subMatrixColumn=function(t,r,o){if("undefined"==typeof r?(r=0,o=this.rows-1):"undefined"==typeof o&&(o=this.rows-1),r>o||0>r||r>=this.rows||0>o||o>=this.rows)throw new RangeError("Argument out of range.");for(var e=t.length,i=this.columns,s=new n(o-r+1,e),a=0;e>a;a++)for(var h=r;o>=h;h++){if(t[a]<0||t[a]>=i)throw new RangeError("Argument out of range.");s[h-r][a]=this[h][t[a]]}return s},n.prototype.trace=function u(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var u=0,t=0,r=this.rows;r>t;t++)u+=this[t][t];return u},n.prototype.abs=function(){for(var t=this.rows,r=this.columns,o=0;t>o;o++)for(var n=0;r>n;n++)this[o][n]=Math.abs(this[o][n])},t.exports=n},function(t,r,o){"use strict";function n(t){return e(t,i.eye(t.rows))}function e(t,r){return t.isSquare()?new h(t).solve(r):new u(t).solve(r)}var i=o(6),s=o(8),a=o(10),h=o(11),u=o(12),f=o(13);i.prototype.inverse=function(){return n(this)},i.prototype.solve=function(t){return e(this,t)},t.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:h,LU:h,QrDecomposition:u,QR:u,CholeskyDecomposition:f,CHO:f,inverse:n,solve:e}},function(t,r,o){"use strict";function n(t,r){if(!(this instanceof n))return new n(t,r);t=e.checkMatrix(t),r=r||{};var o=t.clone(),s=t.rows,a=t.columns,h=Math.min(s,a),u=!0,f=!0;r.computeLeftSingularVectors===!1&&(u=!1),r.computeRightSingularVectors===!1&&(f=!1);var c=r.autoTranspose===!0,l=!1;if(a>s)if(c){o=o.transpose(),s=o.rows,a=o.columns,l=!0;var m=u;u=f,f=m}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,w,v,y,b,d,M,g,x,R,k,A,z,j,C,V,E,S,q,D,I,_=new Array(Math.min(s+1,a)),O=e.zeros(s,h),J=e.zeros(a,a),L=new Array(a),U=new Array(s),W=Math.min(s-1,a),T=Math.max(0,Math.min(a-2,s));for(v=0,R=Math.max(W,T);R>v;v++){if(W>v){for(_[v]=0,p=v;s>p;p++)_[v]=i(_[v],o[p][v]);if(0!==_[v]){for(o[v][v]<0&&(_[v]=-_[v]),p=v;s>p;p++)o[p][v]/=_[v];o[v][v]+=1}_[v]=-_[v]}for(w=v+1;a>w;w++){if(W>v&&0!==_[v]){for(b=0,p=v;s>p;p++)b+=o[p][v]*o[p][w];for(b=-b/o[v][v],p=v;s>p;p++)o[p][w]+=b*o[p][v]}L[w]=o[v][w]}if(u&&W>v)for(p=v;s>p;p++)O[p][v]=o[p][v];if(T>v){for(L[v]=0,p=v+1;a>p;p++)L[v]=i(L[v],L[p]);if(0!==L[v]){for(L[v+1]<0&&(L[v]=-L[v]),p=v+1;a>p;p++)L[p]/=L[v];L[v+1]+=1}if(L[v]=-L[v],s>v+1&&0!==L[v]){for(p=v+1;s>p;p++)U[p]=0;for(w=v+1;a>w;w++)for(p=v+1;s>p;p++)U[p]+=L[w]*o[p][w];for(w=v+1;a>w;w++)for(b=-L[w]/L[v+1],p=v+1;s>p;p++)o[p][w]+=b*U[p]}if(f)for(p=v+1;a>p;p++)J[p][v]=L[p]}}if(y=Math.min(a,s+1),a>W&&(_[W]=o[W][W]),y>s&&(_[y-1]=0),y>T+1&&(L[T]=o[T][y-1]),L[y-1]=0,u){for(w=W;h>w;w++){for(p=0;s>p;p++)O[p][w]=0;O[w][w]=1}for(v=W-1;v>=0;v--)if(0!==_[v]){for(w=v+1;h>w;w++){for(b=0,p=v;s>p;p++)b+=O[p][v]*O[p][w];for(b=-b/O[v][v],p=v;s>p;p++)O[p][w]+=b*O[p][v]}for(p=v;s>p;p++)O[p][v]=-O[p][v];for(O[v][v]=1+O[v][v],p=0;v-1>p;p++)O[p][v]=0}else{for(p=0;s>p;p++)O[p][v]=0;O[v][v]=1}}if(f)for(v=a-1;v>=0;v--){if(T>v&&0!==L[v])for(w=v+1;a>w;w++){for(b=0,p=v+1;a>p;p++)b+=J[p][v]*J[p][w];for(b=-b/J[v+1][v],p=v+1;a>p;p++)J[p][w]+=b*J[p][v]}for(p=0;a>p;p++)J[p][v]=0;J[v][v]=1}for(var G=y-1,Q=0,X=Math.pow(2,-52);y>0;){for(v=y-2;v>=-1&&-1!==v;v--)if(Math.abs(L[v])<=X*(Math.abs(_[v])+Math.abs(_[v+1]))){L[v]=0;break}if(v===y-2)k=4;else{for(d=y-1;d>=v&&d!==v;d--)if(b=(d!==y?Math.abs(L[d]):0)+(d!==v+1?Math.abs(L[d-1]):0),Math.abs(_[d])<=X*b){_[d]=0;break}d===v?k=3:d===y-1?k=1:(k=2,v=d)}switch(v++,k){case 1:for(M=L[y-2],L[y-2]=0,w=y-2;w>=v;w--)if(b=i(_[w],M),g=_[w]/b,x=M/b,_[w]=b,w!==v&&(M=-x*L[w-1],L[w-1]=g*L[w-1]),f)for(p=0;a>p;p++)b=g*J[p][w]+x*J[p][y-1],J[p][y-1]=-x*J[p][w]+g*J[p][y-1],J[p][w]=b;break;case 2:for(M=L[v-1],L[v-1]=0,w=v;y>w;w++)if(b=i(_[w],M),g=_[w]/b,x=M/b,_[w]=b,M=-x*L[w],L[w]=g*L[w],u)for(p=0;s>p;p++)b=g*O[p][w]+x*O[p][v-1],O[p][v-1]=-x*O[p][w]+g*O[p][v-1],O[p][w]=b;break;case 3:for(A=Math.max(Math.max(Math.max(Math.max(Math.abs(_[y-1]),Math.abs(_[y-2])),Math.abs(L[y-2])),Math.abs(_[v])),Math.abs(L[v])),z=_[y-1]/A,j=_[y-2]/A,C=L[y-2]/A,V=_[v]/A,E=L[v]/A,S=((j+z)*(j-z)+C*C)/2,q=z*C*(z*C),D=0,(0!==S||0!==q)&&(D=Math.sqrt(S*S+q),0>S&&(D=-D),D=q/(S+D)),M=(V+z)*(V-z)+D,I=V*E,w=v;y-1>w;w++){if(b=i(M,I),g=M/b,x=I/b,w!==v&&(L[w-1]=b),M=g*_[w]+x*L[w],L[w]=g*L[w]-x*_[w],I=x*_[w+1],_[w+1]=g*_[w+1],f)for(p=0;a>p;p++)b=g*J[p][w]+x*J[p][w+1],J[p][w+1]=-x*J[p][w]+g*J[p][w+1],J[p][w]=b;if(b=i(M,I),g=M/b,x=I/b,_[w]=b,M=g*L[w]+x*_[w+1],_[w+1]=-x*L[w]+g*_[w+1],I=x*L[w+1],L[w+1]=g*L[w+1],u&&s-1>w)for(p=0;s>p;p++)b=g*O[p][w]+x*O[p][w+1],O[p][w+1]=-x*O[p][w]+g*O[p][w+1],O[p][w]=b}L[y-2]=M,Q+=1;break;case 4:if(_[v]<=0&&(_[v]=_[v]<0?-_[v]:0,f))for(p=0;G>=p;p++)J[p][v]=-J[p][v];for(;G>v&&!(_[v]>=_[v+1]);){if(b=_[v],_[v]=_[v+1],_[v+1]=b,f&&a-1>v)for(p=0;a>p;p++)b=J[p][v+1],J[p][v+1]=J[p][v],J[p][v]=b;if(u&&s-1>v)for(p=0;s>p;p++)b=O[p][v+1],O[p][v+1]=O[p][v],O[p][v]=b;v++}Q=0,y--}}if(l){var F=J;J=O,O=F}this.m=s,this.n=a,this.s=_,this.U=O,this.V=J}var e=o(6),i=o(9).hypotenuse;n.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=Math.pow(2,-52),r=Math.max(this.m,this.n)*this.s[0]*t,o=0,n=this.s,e=0,i=n.length;i>e;e++)n[e]>r&&o++;return o},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(t){var r,o=t,n=this.threshold,i=this.s.length,s=e.zeros(i,i);for(r=0;i>r;r++)Math.abs(this.s[r])<=n?s[r][r]=0:s[r][r]=1/this.s[r];var a,h,u,f=this.V.mmul(s),c=this.V.rows,l=this.U.rows,m=e.zeros(c,l);for(r=0;c>r;r++)for(a=0;l>a;a++){for(u=0,h=0;i>h;h++)u+=f[r][h]*this.U[a][h];m[r][a]=u}return m.mmul(o)},solveForDiagonal:function(t){return this.solve(e.diag(t))},inverse:function(){var t,r,o=this.threshold,n=this.V.rows,i=this.V.columns,s=new e(n,this.s.length);for(t=0;n>t;t++)for(r=0;i>r;r++)Math.abs(this.s[r])>o?s[t][r]=this.V[t][r]/this.s[r]:s[t][r]=0;var a,h,u=this.U.rows,f=this.U.columns,c=new e(n,u);for(t=0;n>t;t++)for(r=0;u>r;r++){for(h=0,a=0;f>a;a++)h+=s[t][a]*this.U[r][a];c[t][r]=h}return c}},t.exports=n},function(t,r){"use strict";r.hypotenuse=function(t,r){var o;return Math.abs(t)>Math.abs(r)?(o=r/t,Math.abs(t)*Math.sqrt(1+o*o)):0!==r?(o=t/r,Math.abs(r)*Math.sqrt(1+o*o)):0}},function(t,r,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);if(t=u.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");var r,o,h=t.columns,f=u.zeros(h,h),c=new Array(h),l=new Array(h),m=t;if(t.isSymmetric()){for(r=0;h>r;r++)for(o=0;h>o;o++)f[r][o]=m[r][o];e(h,l,c,f),i(h,l,c,f)}else{var p=u.zeros(h,h),w=new Array(h);for(o=0;h>o;o++)for(r=0;h>r;r++)p[r][o]=m[r][o];s(h,p,w,f),a(h,l,c,f,p)}this.n=h,this.e=l,this.d=c,this.V=f}function e(t,r,o,n){var e,i,s,a,h,u,f,c;for(h=0;t>h;h++)o[h]=n[t-1][h];for(a=t-1;a>0;a--){for(c=0,s=0,u=0;a>u;u++)c+=Math.abs(o[u]);if(0===c)for(r[a]=o[a-1],h=0;a>h;h++)o[h]=n[a-1][h],n[a][h]=0,n[h][a]=0;else{for(u=0;a>u;u++)o[u]/=c,s+=o[u]*o[u];for(e=o[a-1],i=Math.sqrt(s),e>0&&(i=-i),r[a]=c*i,s-=e*i,o[a-1]=e-i,h=0;a>h;h++)r[h]=0;for(h=0;a>h;h++){for(e=o[h],n[h][a]=e,i=r[h]+n[h][h]*e,u=h+1;a-1>=u;u++)i+=n[u][h]*o[u],r[u]+=n[u][h]*e;r[h]=i}for(e=0,h=0;a>h;h++)r[h]/=s,e+=r[h]*o[h];for(f=e/(s+s),h=0;a>h;h++)r[h]-=f*o[h];for(h=0;a>h;h++){for(e=o[h],i=r[h],u=h;a-1>=u;u++)n[u][h]-=e*r[u]+i*o[u];o[h]=n[a-1][h],n[a][h]=0}}o[a]=s}for(a=0;t-1>a;a++){if(n[t-1][a]=n[a][a],n[a][a]=1,s=o[a+1],0!==s){for(u=0;a>=u;u++)o[u]=n[u][a+1]/s;for(h=0;a>=h;h++){for(i=0,u=0;a>=u;u++)i+=n[u][a+1]*n[u][h];for(u=0;a>=u;u++)n[u][h]-=i*o[u]}}for(u=0;a>=u;u++)n[u][a+1]=0}for(h=0;t>h;h++)o[h]=n[t-1][h],n[t-1][h]=0;n[t-1][t-1]=1,r[0]=0}function i(t,r,o,n){var e,i,s,a,h,u,c,l,m,p,w,v,y,b,d,M,g;for(s=1;t>s;s++)r[s-1]=r[s];r[t-1]=0;var x=0,R=0,k=Math.pow(2,-52);for(u=0;t>u;u++){for(R=Math.max(R,Math.abs(o[u])+Math.abs(r[u])),c=u;t>c&&!(Math.abs(r[c])<=k*R);)c++;if(c>u){g=0;do{for(g+=1,e=o[u],l=(o[u+1]-e)/(2*r[u]),m=f(l,1),0>l&&(m=-m),o[u]=r[u]/(l+m),o[u+1]=r[u]*(l+m),p=o[u+1],i=e-o[u],s=u+2;t>s;s++)o[s]-=i;for(x+=i,l=o[c],w=1,v=w,y=w,b=r[u+1],d=0,M=0,s=c-1;s>=u;s--)for(y=v,v=w,M=d,e=w*r[s],i=w*l,m=f(l,r[s]),r[s+1]=d*m,d=r[s]/m,w=l/m,l=w*o[s]-d*e,o[s+1]=i+d*(w*e+d*o[s]),h=0;t>h;h++)i=n[h][s+1],n[h][s+1]=d*n[h][s]+w*i,n[h][s]=w*n[h][s]-d*i;l=-d*M*y*b*r[u]/p,r[u]=d*l,o[u]=w*l}while(Math.abs(r[u])>k*R)}o[u]=o[u]+x,r[u]=0}for(s=0;t-1>s;s++){for(h=s,l=o[s],a=s+1;t>a;a++)o[a]<l&&(h=a,l=o[a]);if(h!==s)for(o[h]=o[s],o[s]=l,a=0;t>a;a++)l=n[a][s],
n[a][s]=n[a][h],n[a][h]=l}}function s(t,r,o,n){var e,i,s,a,h,u,f,c=0,l=t-1;for(u=c+1;l-1>=u;u++){for(f=0,a=u;l>=a;a++)f+=Math.abs(r[a][u-1]);if(0!==f){for(s=0,a=l;a>=u;a--)o[a]=r[a][u-1]/f,s+=o[a]*o[a];for(i=Math.sqrt(s),o[u]>0&&(i=-i),s-=o[u]*i,o[u]=o[u]-i,h=u;t>h;h++){for(e=0,a=l;a>=u;a--)e+=o[a]*r[a][h];for(e/=s,a=u;l>=a;a++)r[a][h]-=e*o[a]}for(a=0;l>=a;a++){for(e=0,h=l;h>=u;h--)e+=o[h]*r[a][h];for(e/=s,h=u;l>=h;h++)r[a][h]-=e*o[h]}o[u]=f*o[u],r[u][u-1]=f*i}}for(a=0;t>a;a++)for(h=0;t>h;h++)n[a][h]=a===h?1:0;for(u=l-1;u>=c+1;u--)if(0!==r[u][u-1]){for(a=u+1;l>=a;a++)o[a]=r[a][u-1];for(h=u;l>=h;h++){for(i=0,a=u;l>=a;a++)i+=o[a]*n[a][h];for(i=i/o[u]/r[u][u-1],a=u;l>=a;a++)n[a][h]+=i*o[a]}}}function a(t,r,o,n,e){var i,s,a,u,f,c,l,m,p,w,v,y,b,d,M,g=t-1,x=0,R=t-1,k=Math.pow(2,-52),A=0,z=0,j=0,C=0,V=0,E=0,S=0,q=0;for(i=0;t>i;i++)for((x>i||i>R)&&(o[i]=e[i][i],r[i]=0),s=Math.max(i-1,0);t>s;s++)z+=Math.abs(e[i][s]);for(;g>=x;){for(u=g;u>x&&(E=Math.abs(e[u-1][u-1])+Math.abs(e[u][u]),0===E&&(E=z),!(Math.abs(e[u][u-1])<k*E));)u--;if(u===g)e[g][g]=e[g][g]+A,o[g]=e[g][g],r[g]=0,g--,q=0;else if(u===g-1){if(l=e[g][g-1]*e[g-1][g],j=(e[g-1][g-1]-e[g][g])/2,C=j*j+l,S=Math.sqrt(Math.abs(C)),e[g][g]=e[g][g]+A,e[g-1][g-1]=e[g-1][g-1]+A,m=e[g][g],C>=0){for(S=j>=0?j+S:j-S,o[g-1]=m+S,o[g]=o[g-1],0!==S&&(o[g]=m-l/S),r[g-1]=0,r[g]=0,m=e[g][g-1],E=Math.abs(m)+Math.abs(S),j=m/E,C=S/E,V=Math.sqrt(j*j+C*C),j/=V,C/=V,s=g-1;t>s;s++)S=e[g-1][s],e[g-1][s]=C*S+j*e[g][s],e[g][s]=C*e[g][s]-j*S;for(i=0;g>=i;i++)S=e[i][g-1],e[i][g-1]=C*S+j*e[i][g],e[i][g]=C*e[i][g]-j*S;for(i=x;R>=i;i++)S=n[i][g-1],n[i][g-1]=C*S+j*n[i][g],n[i][g]=C*n[i][g]-j*S}else o[g-1]=m+j,o[g]=m+j,r[g-1]=S,r[g]=-S;g-=2,q=0}else{if(m=e[g][g],p=0,l=0,g>u&&(p=e[g-1][g-1],l=e[g][g-1]*e[g-1][g]),10===q){for(A+=m,i=x;g>=i;i++)e[i][i]-=m;E=Math.abs(e[g][g-1])+Math.abs(e[g-1][g-2]),m=p=.75*E,l=-.4375*E*E}if(30===q&&(E=(p-m)/2,E=E*E+l,E>0)){for(E=Math.sqrt(E),m>p&&(E=-E),E=m-l/((p-m)/2+E),i=x;g>=i;i++)e[i][i]-=E;A+=E,m=p=l=.964}for(q+=1,f=g-2;f>=u&&(S=e[f][f],V=m-S,E=p-S,j=(V*E-l)/e[f+1][f]+e[f][f+1],C=e[f+1][f+1]-S-V-E,V=e[f+2][f+1],E=Math.abs(j)+Math.abs(C)+Math.abs(V),j/=E,C/=E,V/=E,f!==u)&&!(Math.abs(e[f][f-1])*(Math.abs(C)+Math.abs(V))<k*(Math.abs(j)*(Math.abs(e[f-1][f-1])+Math.abs(S)+Math.abs(e[f+1][f+1]))));)f--;for(i=f+2;g>=i;i++)e[i][i-2]=0,i>f+2&&(e[i][i-3]=0);for(a=f;g-1>=a&&(d=a!==g-1,a!==f&&(j=e[a][a-1],C=e[a+1][a-1],V=d?e[a+2][a-1]:0,m=Math.abs(j)+Math.abs(C)+Math.abs(V),0!==m&&(j/=m,C/=m,V/=m)),0!==m);a++)if(E=Math.sqrt(j*j+C*C+V*V),0>j&&(E=-E),0!==E){for(a!==f?e[a][a-1]=-E*m:u!==f&&(e[a][a-1]=-e[a][a-1]),j+=E,m=j/E,p=C/E,S=V/E,C/=j,V/=j,s=a;t>s;s++)j=e[a][s]+C*e[a+1][s],d&&(j+=V*e[a+2][s],e[a+2][s]=e[a+2][s]-j*S),e[a][s]=e[a][s]-j*m,e[a+1][s]=e[a+1][s]-j*p;for(i=0;i<=Math.min(g,a+3);i++)j=m*e[i][a]+p*e[i][a+1],d&&(j+=S*e[i][a+2],e[i][a+2]=e[i][a+2]-j*V),e[i][a]=e[i][a]-j,e[i][a+1]=e[i][a+1]-j*C;for(i=x;R>=i;i++)j=m*n[i][a]+p*n[i][a+1],d&&(j+=S*n[i][a+2],n[i][a+2]=n[i][a+2]-j*V),n[i][a]=n[i][a]-j,n[i][a+1]=n[i][a+1]-j*C}}}if(0!==z){for(g=t-1;g>=0;g--)if(j=o[g],C=r[g],0===C)for(u=g,e[g][g]=1,i=g-1;i>=0;i--){for(l=e[i][i]-j,V=0,s=u;g>=s;s++)V+=e[i][s]*e[s][g];if(r[i]<0)S=l,E=V;else if(u=i,0===r[i]?e[i][g]=0!==l?-V/l:-V/(k*z):(m=e[i][i+1],p=e[i+1][i],C=(o[i]-j)*(o[i]-j)+r[i]*r[i],c=(m*E-S*V)/C,e[i][g]=c,e[i+1][g]=Math.abs(m)>Math.abs(S)?(-V-l*c)/m:(-E-p*c)/S),c=Math.abs(e[i][g]),k*c*c>1)for(s=i;g>=s;s++)e[s][g]=e[s][g]/c}else if(0>C)for(u=g-1,Math.abs(e[g][g-1])>Math.abs(e[g-1][g])?(e[g-1][g-1]=C/e[g][g-1],e[g-1][g]=-(e[g][g]-j)/e[g][g-1]):(M=h(0,-e[g-1][g],e[g-1][g-1]-j,C),e[g-1][g-1]=M[0],e[g-1][g]=M[1]),e[g][g-1]=0,e[g][g]=1,i=g-2;i>=0;i--){for(w=0,v=0,s=u;g>=s;s++)w+=e[i][s]*e[s][g-1],v+=e[i][s]*e[s][g];if(l=e[i][i]-j,r[i]<0)S=l,V=w,E=v;else if(u=i,0===r[i]?(M=h(-w,-v,l,C),e[i][g-1]=M[0],e[i][g]=M[1]):(m=e[i][i+1],p=e[i+1][i],y=(o[i]-j)*(o[i]-j)+r[i]*r[i]-C*C,b=2*(o[i]-j)*C,0===y&&0===b&&(y=k*z*(Math.abs(l)+Math.abs(C)+Math.abs(m)+Math.abs(p)+Math.abs(S))),M=h(m*V-S*w+C*v,m*E-S*v-C*w,y,b),e[i][g-1]=M[0],e[i][g]=M[1],Math.abs(m)>Math.abs(S)+Math.abs(C)?(e[i+1][g-1]=(-w-l*e[i][g-1]+C*e[i][g])/m,e[i+1][g]=(-v-l*e[i][g]-C*e[i][g-1])/m):(M=h(-V-p*e[i][g-1],-E-p*e[i][g],S,C),e[i+1][g-1]=M[0],e[i+1][g]=M[1])),c=Math.max(Math.abs(e[i][g-1]),Math.abs(e[i][g])),k*c*c>1)for(s=i;g>=s;s++)e[s][g-1]=e[s][g-1]/c,e[s][g]=e[s][g]/c}for(i=0;t>i;i++)if(x>i||i>R)for(s=i;t>s;s++)n[i][s]=e[i][s];for(s=t-1;s>=x;s--)for(i=x;R>=i;i++){for(S=0,a=x;a<=Math.min(s,R);a++)S+=n[i][a]*e[a][s];n[i][s]=S}}}function h(t,r,o,n){var e,i;return Math.abs(o)>Math.abs(n)?(e=n/o,i=o+e*n,[(t+e*r)/i,(r-e*t)/i]):(e=o/n,i=n+e*o,[(e*t+r)/i,(e*r-t)/i])}var u=o(6),f=o(9).hypotenuse;n.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var t,r,o=this.n,n=this.e,e=this.d,i=new u(o,o);for(t=0;o>t;t++){for(r=0;o>r;r++)i[t][r]=0;i[t][t]=e[t],n[t]>0?i[t][t+1]=n[t]:n[t]<0&&(i[t][t-1]=n[t])}return i}},t.exports=n},function(t,r,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=e.checkMatrix(t);var r,o,i,s,a,h,u,f,c,l,m=t.clone(),p=m.rows,w=m.columns,v=new Array(p),y=1;for(r=0;p>r;r++)v[r]=r;for(c=new Array(p),o=0;w>o;o++){for(r=0;p>r;r++)c[r]=m[r][o];for(r=0;p>r;r++){for(f=m[r],l=Math.min(r,o),a=0,i=0;l>i;i++)a+=f[i]*c[i];f[o]=c[r]-=a}for(s=o,r=o+1;p>r;r++)Math.abs(c[r])>Math.abs(c[s])&&(s=r);if(s!==o){for(i=0;w>i;i++)h=m[s][i],m[s][i]=m[o][i],m[o][i]=h;u=v[s],v[s]=v[o],v[o]=u,y=-y}if(p>o&&0!==m[o][o])for(r=o+1;p>r;r++)m[r][o]/=m[o][o]}this.LU=m,this.pivotVector=v,this.pivotSign=y}var e=o(6);n.prototype={isSingular:function(){for(var t=this.LU,r=t.columns,o=0;r>o;o++)if(0===t[o][o])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,o=t.columns,n=0;o>n;n++)r*=t[n][n];return r},get lowerTriangularFactor(){for(var t=this.LU,r=t.rows,o=t.columns,n=new e(r,o),i=0;r>i;i++)for(var s=0;o>s;s++)i>s?n[i][s]=t[i][s]:i===s?n[i][s]=1:n[i][s]=0;return n},get upperTriangularFactor(){for(var t=this.LU,r=t.rows,o=t.columns,n=new e(r,o),i=0;r>i;i++)for(var s=0;o>s;s++)s>=i?n[i][s]=t[i][s]:n[i][s]=0;return n},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=e.checkMatrix(t);var r=this.LU,o=r.rows;if(o!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,i,s,a=t.columns,h=t.subMatrixRow(this.pivotVector,0,a-1),u=r.columns;for(s=0;u>s;s++)for(n=s+1;u>n;n++)for(i=0;a>i;i++)h[n][i]-=h[s][i]*r[n][s];for(s=u-1;s>=0;s--){for(i=0;a>i;i++)h[s][i]/=r[s][s];for(n=0;s>n;n++)for(i=0;a>i;i++)h[n][i]-=h[s][i]*r[n][s]}return h}},t.exports=n},function(t,r,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=e.checkMatrix(t);var r,o,s,a,h=t.clone(),u=t.rows,f=t.columns,c=new Array(f);for(s=0;f>s;s++){var l=0;for(r=s;u>r;r++)l=i(l,h[r][s]);if(0!==l){for(h[s][s]<0&&(l=-l),r=s;u>r;r++)h[r][s]/=l;for(h[s][s]+=1,o=s+1;f>o;o++){for(a=0,r=s;u>r;r++)a+=h[r][s]*h[r][o];for(a=-a/h[s][s],r=s;u>r;r++)h[r][o]+=a*h[r][s]}}c[s]=-l}this.QR=h,this.Rdiag=c}var e=o(6),i=o(9).hypotenuse;n.prototype={solve:function(t){t=e.checkMatrix(t);var r=this.QR,o=r.rows;if(t.rows!==o)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,i,s,a,h=t.columns,u=t.clone(),f=r.columns;for(s=0;f>s;s++)for(i=0;h>i;i++){for(a=0,n=s;o>n;n++)a+=r[n][s]*u[n][i];for(a=-a/r[s][s],n=s;o>n;n++)u[n][i]+=a*r[n][s]}for(s=f-1;s>=0;s--){for(i=0;h>i;i++)u[s][i]/=this.Rdiag[s];for(n=0;s>n;n++)for(i=0;h>i;i++)u[n][i]-=u[s][i]*r[n][s]}return u.subMatrix(0,f-1,0,h-1)},isFullRank:function(){for(var t=this.QR.columns,r=0;t>r;r++)if(0===this.Rdiag[r])return!1;return!0},get upperTriangularFactor(){var t,r,o=this.QR,n=o.columns,i=new e(n,n);for(t=0;n>t;t++)for(r=0;n>r;r++)r>t?i[t][r]=o[t][r]:t===r?i[t][r]=this.Rdiag[t]:i[t][r]=0;return i},get orthogonalFactor(){var t,r,o,n,i=this.QR,s=i.rows,a=i.columns,h=new e(s,a);for(o=a-1;o>=0;o--){for(t=0;s>t;t++)h[t][o]=0;for(h[o][o]=1,r=o;a>r;r++)if(0!==i[o][o]){for(n=0,t=o;s>t;t++)n+=i[t][o]*h[t][r];for(n=-n/i[o][o],t=o;s>t;t++)h[t][r]+=n*i[t][o]}}return h}},t.exports=n},function(t,r,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);if(t=e.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");var r,o,i,s=t,a=s.rows,h=new e(a,a),u=!0;for(o=0;a>o;o++){var f=h[o],c=0;for(i=0;o>i;i++){var l=h[i],m=0;for(r=0;i>r;r++)m+=l[r]*f[r];f[i]=m=(s[o][i]-m)/h[i][i],c+=m*m}for(c=s[o][o]-c,u&=c>0,h[o][o]=Math.sqrt(Math.max(c,0)),i=o+1;a>i;i++)h[o][i]=0}if(!u)throw new Error("Matrix is not positive definite");this.L=h}var e=o(6);n.prototype={get leftTriangularFactor(){return this.L},solve:function(t){t=e.checkMatrix(t);var r=this.L,o=r.rows;if(t.rows!==o)throw new Error("Matrix dimensions do not match");var n,i,s,a=t.columns,h=t.clone();for(s=0;o>s;s++)for(i=0;a>i;i++){for(n=0;s>n;n++)h[s][i]-=h[n][i]*r[s][n];h[s][i]/=r[s][s]}for(s=o-1;s>=0;s--)for(i=0;a>i;i++){for(n=s+1;o>n;n++)h[s][i]-=h[n][i]*r[n][s];h[s][i]/=r[s][s]}return h}},t.exports=n},function(t,r,o){"use strict";function n(t,r){return new R(t,r)}function e(t,r){return R.ones(t,r)}function i(t,r){return R.eye(t,r)}function s(t,r){return R.zeros(t,r)}function a(t,r){return R.rand(t,r)}function h(t){if("number"==typeof t)return t;var r=t.clone();return r.transpose()}function u(t,r){if("number"==typeof t&&"number"==typeof r)return t+r;if("number"==typeof t)return this.add(r,t);var o=t.clone();return o.add(r)}function f(t,r){if("number"==typeof t&&"number"==typeof r)return t-r;if("number"==typeof t)return this.subtract(r,t);var o=t.clone();return o.sub(r)}function c(t,r){if("number"==typeof t&&"number"==typeof r)return t*r;if("number"==typeof t)return this.multiply(r,t);var o=t.clone();return"number"==typeof r?o.mul(r):o=o.mmul(r),1==o.rows&&1==o.columns?o[0][0]:o}function l(t,r){var o=t.clone();return o.mul(r)}function m(t,r){var o=t.clone();return o.div(r)}function p(t){var r,o,n=null,e=t.rows,i=t.columns;if("undefined"==typeof i&&"object"==typeof t)if(t[0]&&t[0].length)for(e=t.length,i=t[0].length,o=Math.min(e,i),n=R.zeros(i,i),r=0;i>r;r++)n[r][r]=t[r][r];else for(i=t.length,n=R.zeros(i,i),r=0;i>r;r++)n[r][r]=t[r];if(1==e)for(n=R.zeros(i,i),r=0;i>r;r++)n[r][r]=t[0][r];else if(e>0&&i>0)for(o=Math.min(e,i),n=new Array(o),r=0;o>r;r++)n[r]=t[r][r];return n}function w(t,r){if("number"==typeof t&&"number"==typeof r)return Math.min(t,r);for(var o=t.rows,n=t.columns,e=new R(o,n),i=0;o>i;i++)for(var s=0;n>s;s++)t[i][s]<r[i][s]?e[i][s]=t[i][s]:e[i][s]=r[i][s];return e}function v(t,r){if("number"==typeof t&&"number"==typeof r)return Math.max(t,r);for(var o=t.rows,n=t.columns,e=new R(o,n),i=0;o>i;i++)for(var s=0;n>s;s++)t[i][s]>r[i][s]?e[i][s]=t[i][s]:e[i][s]=r[i][s];return e}function y(t){if("number"==typeof t)return Math.sqrt(t);for(var r=t.rows,o=t.columns,n=new R(r,o),e=0;r>e;e++)for(var i=0;o>i;i++)n[e][i]=Math.sqrt(t[e][i]);return n}function b(t){if("number"==typeof t)return Math.abs(t);for(var r=t.rows,o=t.columns,n=new R(r,o),e=0;r>e;e++)for(var i=0;o>i;i++)n[e][i]=Math.abs(t[e][i]);return n}function d(t){if("number"==typeof t)return Math.sqrt(t);for(var r=t.rows,o=t.columns,n=new R(r,o),e=0;r>e;e++)for(var i=0;o>i;i++)n[e][i]=Math.exp(t[e][i]);return n}function M(t,r){if("number"==typeof t)return Math.pow(t,r);for(var o=t.rows,n=t.columns,e=new R(o,n),i=0;o>i;i++)for(var s=0;n>s;s++)e[i][s]=Math.pow(t[i][s],r);return e}function g(t,r){return t.solve(r)}function x(t){return"number"==typeof t?1/t:t.inverse()}var R=o(5);t.exports={transpose:h,add:u,subtract:f,multiply:c,dotMultiply:l,dotDivide:m,diag:p,min:w,max:v,solve:g,inv:x,sqrt:y,exp:d,dotPow:M,abs:b,matrix:n,ones:e,zeros:s,random:a,eye:i}},function(t,r,o){function n(t,r,o){var o=Object.create(o||{});if(void 0===o.minMaxRatio&&(o.minMaxRatio=25e-5),void 0===o.broadRatio&&(o.broadRatio=0),void 0===o.noiseLevel&&(o.noiseLevel=0),void 0===o.maxCriteria&&(o.maxCriteria=!0),void 0===o.smoothY&&(o.smoothY=!0),o.noiseLevel>0){r=[].concat(r);for(var n=0;n<r.length;n++)Math.abs(r[n])<o.noiseLevel&&(r[n]=0)}for(var s=[],a=t.length-4,h=new Array(a),u=new Array(a),f=new Array(a),c=t[1]-t[0],l=2;a+2>l;l++)c=t[l]-t[l-1],o.smoothY?h[l-2]=1/35*(-3*r[l-2]+12*r[l-1]+17*r[l]+12*r[l+1]-3*r[l+2]):h[l-2]=r[l],s[l-2]=t[l],u[l-2]=1/(12*c)*(r[l-2]-8*r[l-1]+8*r[l+1]-r[l+2]),f[l-2]=1/(7*c*c)*(2*r[l-2]-r[l-1]-2*r[l]-r[l+1]+2*r[l+2]);for(var m=0,p=0,n=0;n<h.length;n++)Math.abs(f[n])>m&&(m=Math.abs(f[n])),Math.abs(h[n])>p&&(p=Math.abs(h[n]));for(var w=[],v=[],y=null,b=null,d=new Array,n=1;n<h.length-1;n++)(u[n]<u[n-1]&&u[n]<=u[n+1]||u[n]<=u[n-1]&&u[n]<u[n+1])&&(b=s[n],c>0&&null!=y&&v.push([y,b])),(u[n]>=u[n-1]&&u[n]>u[n+1]||u[n]>u[n-1]&&u[n]>=u[n+1])&&(y=s[n],0>c&&null!=b&&v.push([y,b])),o.maxCriteria?f[n]<f[n-1]&&f[n]<f[n+1]&&(w.push([s[n],h[n],n]),Math.abs(f[n])>o.broadRatio*m?d.push(!1):d.push(!0)):f[n]>f[n-1]&&f[n]>f[n+1]&&(w.push([s[n],h[n],n]),Math.abs(f[n])>o.broadRatio*m?d.push(!1):d.push(!0));e(w,s,h);for(var M=[],l=0;l<w.length;l++){for(var g=w[l],x=g[0],R=[],k=0;k<v.length;k++){var n=v[k];Math.abs(x-(n[0]+n[1])/2)<Math.abs(n[0]-n[1])/2&&R.push(n)}if(R.length>0&&1==R.length){var A=R[0],z=Math.abs(A[1]-A[0]),j=g[1];Math.abs(j)>o.minMaxRatio*p&&M.push({x:x,y:j,width:z})}}if(o.broadRatio>0)for(var C=[[Number.MAX_VALUE,0,0]],V=0,E=0,S=0,q=[],D=!1,n=C.length-1;n>0;n--)if(Math.abs(C[n-1][0]-C[n][0])<rangeX)q.push(C[n]),C[n][1]>V&&(V=C[n][1],E=n),S++;else{if(D=!0,S>30&&(D=!1),D)for(var l=0;l<q.length;l++)M.push([q[l][0],q[l][1],c]);else{var I=i.optimizeSingleLorentzian(q,{x:q[E][0],width:Math.abs(q[0][0]-q[q.length-1][0])},[]);M.push([I[0][0],I[0][1],I[0][2]])}q=[],V=0,E=0,S=0}return M.sort(function(t,r){return t.x-r.x}),M}function e(t,r,o){for(var n,e,i,s,a,h=0;h<t.length;h++)a=t[h][2],o[a-1]>=o[a-2]&&o[a-1]>=o[a]?a--:o[a+1]>=o[a]&&o[a+1]>=o[a+2]?a++:o[a-2]>=o[a-3]&&o[a-2]>=o[a-1]?a-=2:o[a+2]>=o[a+1]&&o[a+2]>=o[a+3]&&(a+=2),o[a-1]>0&&o[a+1]>0&&o[a]>=o[a-1]&&o[a]>=o[a+1]&&(n=20*Math.log10(o[a-1]),e=20*Math.log10(o[a]),i=20*Math.log10(o[a+1]),s=.5*(n-i)/(n-2*e+i),t[h][0]=r[a]+(r[a]-r[a-1])*s,t[h][1]=o[a]-.25*(o[a-1]-[a+1])*s)}var i=o(2);t.exports=n}])});
//# sourceMappingURL=ml-gsd.min.js.map