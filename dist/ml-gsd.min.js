!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.GSD=t():r.GSD=t()}(this,function(){return function(r){function t(o){if(n[o])return n[o].exports;var e=n[o]={exports:{},id:o,loaded:!1};return r[o].call(e.exports,e,e.exports,t),e.loaded=!0,e.exports}var n={};return t.m=r,t.c=n,t.p="",t(0)}([function(r,t,n){r.exports.post=n(1),r.exports.gsd=n(15)},function(r,t,n){function o(r,t,n,o,e){var i=n.length,a=[],s=[],f=Math.sign(n[1]-n[0]);f==-1&&(e[0]=n.length-1);for(var u=Math.abs(t-r)/2,h=(r+t)/2,l=!1,c=e[0];!l&&c<i&&c>=0;)Math.abs(n[c]-h)<=u?(a.push(n[c]),s.push(o[c]),c+=f):1==Math.sign(h-n[c])?c+=f:l=!0;return e[0]=c,[a,s]}function e(r,t,n,e,a){var f,u,h=[0],l=i(r,e),c=[],v=1;for("gaussian"==a&&(v=1.17741),f=0;f<l.length;f++){var w=l[f].group;if(w.length>1){var m=o(l[f].limits[0]-l[f].limits[1],l[f].limits[0]+l[f].limits[1],t,n,h);if(m[0].length>5){var p=w[0].width/1e3,d=[3,100,p,p,p,10*p,10*p,11,9,1],y=[];for("gaussian"==a?y=s.optimizeGaussianSum(m,w,d):"lorentzian"==a&&(y=s.optimizeLorentzianSum(m,w,d)),u=0;u<y.length;u++)c.push({x:y[u][0][0],y:y[u][1][0],width:y[u][2][0]*v})}}else{w=w[0];var m=o(w.x-e*w.width,w.x+e*w.width,t,n,h);if(m[0].length>5){var p=w.width/1e3,d=[3,100,p,p,p,10*p,10*p,11,9,1],g=[];if("gaussian"==a)var g=s.optimizeSingleGaussian([m[0],m[1]],w,d);else if("lorentzian"==a)var g=s.optimizeSingleLorentzian([m[0],m[1]],w,d);c.push({x:g[0][0],y:g[1][0],width:g[2][0]*v})}}}return c}function i(r,t){var n,o,e,i,a=[],s=[],f=[r[0].x,t*r[0].width];for(n=0;n<r.length;n++)Math.abs(r[n].x-f[0])<t*r[n].width+f[1]?(a.push(r[n]),e=f[0]+f[1],r[n].x+t*r[n].width>e&&(e=r[n].x+t*r[n].width),i=f[0]-f[1],r[n].x-t*r[n].width<i&&(i=r[n].x-t*r[n].width),f=[(e+i)/2,Math.abs(e-i)/2]):(s.push({limits:f,group:a}),a=[r[n]],f=[r[n].x,t*r[n].width]);for(s.push({limits:f,group:a}),n=s.length-2;n>=0;n--)if(Math.abs(s[n].limits[0]-s[n+1].limits[0])<(s[n].limits[1]+s[n+1].limits[1])/2){for(o=0;o<s[n+1].group.length;o++)s[n].group.push(s[n+1].group[o]);e=s[n].limits[0]+s[n].limits[1],s[n+1].limits[0]+s[n+1].limits[1]>e&&(e=s[n+1].limits[0]+s[n+1].limits[1]),i=s[n].limits[0]-s[n].limits[1],s[n+1].limits[0]-s[n+1].limits[1]<i&&(i=s[n+1].limits[0]-s[n+1].limits[1]),s[n].limits=[(e+i)/2,Math.abs(e-i)/2],s.splice(n+1,1)}return s}function a(r,t){for(var n=t.width,o=[],e=0,i=0,a=1,f=r.length-1;f>=0;f--)r[f].soft&&o.push(r.splice(f,1)[0]);o.push({x:Number.MAX_VALUE});for(var u=[[o[0].x,o[0].y]],h=[0],f=1;f<o.length;f++)if(Math.abs(o[f-1].x-o[f].x)<n)u.push([o[f].x,o[f].y]),o[f].y>e&&(e=o[f].y,i=f),h.push(f),a++;else{if(a>2){var l=s.optimizeSingleLorentzian(u,{x:o[i].x,y:e,width:Math.abs(u[0][0]-u[u.length-1][0])});r.push({x:l[0][0],y:l[1][0],width:l[2][0],soft:!1})}else h.map(function(t){r.push(o[t])});u=[[o[f].x,o[f].y]],h=[f],e=o[f].y,i=f,a=1}return r.sort(function(r,t){return r.x-t.x}),r}var s=n(2);r.exports={optimizePeaks:e,joinBroadPeaks:a}},function(r,t,n){"use strict";function o(r,t,n){var o,e,i,a,s=t.length/3,f=r.rows,u=m.zeros(r.length,1);for(e=0;e<s;e++)for(a=Math.pow(t[e+2*s][0]/2,2),o=t[e+s][0]*a,i=0;i<f;i++)u[i][0]+=o/(Math.pow(r[i][0]-t[e][0],2)+a);return u}function e(r,t,n){for(var o=t[1][0]*Math.pow(t[2][0]/2,2),e=r.rows,i=new m(r.rows,r.columns),a=0;a<e;a++)i[a][0]=o/(Math.pow(r[a][0]-t[0][0],2)+Math.pow(t[2][0]/2,2));return i}function i(r,t,n){for(var o=t[2][0]*t[2][0]/2,e=r.rows,i=new m(r.rows,r.columns),a=0;a<e;a++)i[a][0]=t[1][0]*Math.exp(-(r[a][0]-t[0][0])*(r[a][0]-t[0][0])/o);return i}function a(r,t,n){n=n||{};var o=c(r,n.percentage||0);if(null===o||o[0].rows<3)return null;var i=o[0],a=o[1],s=o[2],f=i.rows,u=[f/Math.sqrt(a.dot(a))],n=Object.create(n.LMOptions||[3,100,.001,.001,.001,.01,.01,11,9,1]),h=[],l=Math.abs(i[0][0]-i[1][0]),w=new m([[-l/1e4],[-.001],[-l/1e4]]),p=new m([[t.x],[1],[t.width]]),d=new m([[t.x-l],[.75],[t.width/4]]),y=new m([[t.x+l],[1.25],[4*t.width]]),g=v.optimize(e,p,i,a,u,w,d,y,h,n);return g=g.p,[g[0],[g[1][0]*s],g[2]]}function s(r,t,n){n=n||{};var o=c(r,n.percentage||0);if(null===o||o[0].rows<3)return null;var e=o[0],a=o[1],s=o[2],f=e.rows,u=[f/Math.sqrt(a.dot(a))],n=Object.create(n.LMOptions||[3,100,.001,.001,.001,.01,.01,11,9,1]),h=[],l=Math.abs(e[0][0]-e[1][0]),w=new m([[-l/1e4],[-.001],[-l/1e4]]),w=new m([[-Math.abs(e[0][0]-e[1][0])/1e3],[-.001],[-t.width/1e3]]),p=new m([[t.x],[1],[t.width]]),d=new m([[t.x-l],[.75],[t.width/4]]),y=new m([[t.x+l],[1.25],[4*t.width]]),g=v.optimize(i,p,e,a,u,w,d,y,h,n);return g=g.p,[g[0],[g[1][0]*s],g[2]]}function f(r,t,n){var o=c(r);if(null===o||o[0].rows<3)return null;for(var e,i,s,f,u,h=o[0],l=o[1],f=o[2],v=0,w=h.length,m=[],p=0;p<t.length;p++){for(e=t[p].x-4*t[p].width;h[v++]<e&&v<w;);for(e=t[p].x+4*t[p].width,i=[],s=[];h[v]<=e&&v<w;)i.push(h[v][0]),s.push(l[v][0]*f),v++;u=a([i,s],t[p],n),u?m.push({x:u[0][0],y:u[1][0],width:u[2][0],opt:!0}):m.push({x:t[p].x,y:t[p].y,width:t[p].width,opt:!1})}return m}function u(r,t,n){var o=c(r);if(null===o||o[0].rows<3)return null;for(var e,i,a,f,u,h=o[0],l=o[1],f=o[2],v=0,w=h.length,m=[],p=0;p<t.length;p++){for(e=t[p].x-4*t[p].width;h[v++]<e&&v<w;);for(e=t[p].x+4*t[p].width,i=[],a=[];h[v]<=e&&v<w;)i.push(h[v][0]),a.push(l[v][0]*f),v++;u=s([i,a],t[p],n),u?m.push({x:u[0][0],y:u[1][0],width:u[2][0],opt:!0}):m.push({x:t[p].x,y:t[p].y,width:t[p].width,opt:!1})}return m}function h(r,t,n){var e=c(r);if(null===e||e[0].rows<3)return null;var i,a=e[0],s=e[1],f=e[2],u=a.rows,h=[u/w.sqrt(s.dot(s))],n=Object.create(n||[3,100,.001,.001,.001,.01,.01,11,9,1]),l=[],p=t.length,d=new m(3*p,1),y=new m(3*p,1),g=new m(3*p,1),M=new m(3*p,1),b=Math.abs(a[0][0]-a[1][0]);for(i=0;i<p;i++)d[i][0]=t[i].x,d[i+p][0]=1,d[i+2*p][0]=t[i].width,y[i][0]=t[i].x-b,y[i+p][0]=0,y[i+2*p][0]=t[i].width/4,g[i][0]=t[i].x+b,g[i+p][0]=1.5,g[i+2*p][0]=4*t[i].width,M[i][0]=-b/1e3,M[i+p][0]=-.001,M[i+2*p][0]=-b/1e3;var M=-Math.abs(a[0][0]-a[1][0])/1e4,x=v.optimize(o,d,a,s,h,M,y,g,l,n);x=x.p;var A=new Array(p);for(i=0;i<p;i++)A[i]=[x[i],[x[i+p][0]*f],x[i+2*p]];return A}function l(r,t,n){var e=c(r);if(null===e||e[0].rows<3)return null;var i,a=e[0],s=e[1],f=e[2],u=a.rows,h=new m(u,1),l=u/w.sqrt(s.dot(s));for(i=0;i<u;i++)h[i][0]=l;var n=Object.create(n||[3,100,.001,.001,.001,.01,.01,11,9,2]),p=[],d=t.length,y=new m(3*d,1),g=new m(3*d,1),M=new m(3*d,1),b=new m(3*d,1),x=Math.abs(a[0][0]-a[1][0]);for(i=0;i<d;i++)y[i][0]=t[i].x,y[i+d][0]=t[i].y/f,y[i+2*d][0]=t[i].width,g[i][0]=t[i].x-x,g[i+d][0]=.8*t[i].y/f,g[i+2*d][0]=t[i].width/2,M[i][0]=t[i].x+x,M[i+d][0]=1.2*t[i].y/f,M[i+2*d][0]=2*t[i].width,b[i][0]=-x/1e3,b[i+d][0]=-.001,b[i+2*d][0]=-x/1e3;var A=v.optimize(o,y,a,s,h,b,g,M,p,n);A=A.p;var R=new Array(d);for(i=0;i<d;i++)R[i]=[A[i],[A[i+d][0]*f],A[i+2*d]];return R}function c(r,t){var n,o,e,i=r.length,a=null,s=null,f=0;if(2==i){var u=r[0].length;if(a=new Array(u),s=new Array(u),n=r[0],o=r[1],"number"==typeof n[0])for(e=0;e<u;e++)a[e]=n[e],s[e]=o[e],o[e]>f&&(f=o[e]);else if("object"==typeof n[0])for(e=0;e<u;e++)a[e]=n[e][0],s[e]=o[e][0],o[e][0]>f&&(f=o[e][0])}else{var u=i;for(a=new Array(u),s=new Array(u),e=0;e<u;e++)a[e]=r[e][0],s[e]=r[e][1],s[e]>f&&(f=s[e])}for(e=0;e<u;e++)s[e]/=f;if(t)for(e=u-1;e>=0;e--)s[e]<t&&(s.splice(e,1),a.splice(e,1));return a.length>0?[new m([a]).transpose(),new m([s]).transpose(),f]:null}var v=n(3),w=v.Matrix.algebra,m=n(5);r.exports.optimizeSingleLorentzian=a,r.exports.optimizeLorentzianSum=h,r.exports.optimizeSingleGaussian=s,r.exports.optimizeGaussianSum=l,r.exports.singleGaussian=i,r.exports.singleLorentzian=e,r.exports.optimizeGaussianTrain=u,r.exports.optimizeLorentzianTrain=f},function(r,t,n){"use strict";r.exports=n(4),r.exports.Matrix=n(5),r.exports.Matrix.algebra=n(14)},function(r,t,n){var o=n(5),e=n(14),i={optimize:function(r,t,n,i,a,s,f,u,h,l){var c=0,v=0;if("object"!=typeof t[0])for(var w=0;w<t.length;w++)t[w]=[t[w]];var w,m,p=-50,d=t.length,y=i.length,g=o.zeros(d,1),M=o.zeros(y,1),b=.01/p,x=.01/p,A=o.zeros(y,d);if(n.length!=i.length){console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=n.length,length_y_dat=i.length;var b=0;if(!c)return}a=a||Math.sqrt((y-d+1)/e.multiply(e.transpose(i),i)),s=s||.001,f=f||e.multiply(Math.abs(t),-100),u=u||e.multiply(Math.abs(t),100),h=h||1,l=l||[3,10*d,.001,.001,.001,.01,.01,11,9,1];var R=l[0],z=l[1],k=l[2],S=(l[3],l[4],l[5]),E=l[6],j=l[7],q=l[8],V=l[9];if(c&&3==R&&(R=2),!s.length||1==s.length){for(var D=new Array(d),w=0;w<d;w++)D[w]=[s];s=D}var C=[];for(w=0;w<s.length;w++)0!=s[w][0]&&C.push(w);var I=C.length,O=!1,_=null;if(!a.length||a.length<y){var L=e.multiply(o.ones(y,1),a[0]);_=e.dotMultiply(L,L)}else _=e.dotMultiply(a,a);var J=this.lm_matx(r,n,g,M,1,A,t,i,_,s,h),U=J.JtWJ,T=J.JtWdy,b=J.Chi_sq,N=J.y_hat,A=J.J;switch(Math.max(Math.abs(T))<k&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",k),O=!0),V){case 1:lambda=E;break;default:lambda=E*Math.max(e.diag(U)),nu=2}x=b;for(var P=null;!O&&v<=z;){switch(v+=1,V){case 1:P=e.solve(e.add(U,e.multiply(e.diag(e.diag(U)),lambda)),T);break;default:P=e.solve(e.add(U,e.multiply(o.eye(d),lambda)),T)}var W=new Array(C.length);for(m=0;m<C.length;m++)W[m]=P[C[m]];var G=e.add(t,W);for(m=0;m<G.length;m++)G[m][0]=Math.min(Math.max(f[m][0],G[m][0]),u[m][0]);var F=e.subtract(i,r(n,G,h)),Q=e.multiply(e.transpose(F),e.dotMultiply(F,_));if(2==V){var X=e.multiply(e.transpose(T),P),Y=e.multiply(X,e.inv(e.add(e.multiply(e.subtract(Q-b),.5)),e.multiply(X,2)));P=e.multiply(Y,P);for(var m=0;m<C.length;m++)W[m]=P[C[m]];G=e.add(t,W),G=e.min(e.max(f,G),u),F=e.subtract(i,r(n,G,h)),Q=e.multiply(e.transpose(F),mat.dotMultiply(F,_))}var B=(b-Q)/e.multiply(e.multiply(e.transpose(P),2),e.add(e.multiply(lambda,P),T));if(B>S)switch(dX2=b-x,x=b,g=t,M=N,t=G,J=this.lm_matx(r,n,g,M,dX2,A,t,i,_,s,h),U=J.JtWJ,T=J.JtWdy,b=J.Chi_sq,N=J.y_hat,A=J.J,V){case 1:lambda=Math.max(lambda/q,1e-7);break;case 2:lambda=Math.max(lambda/(1+Y),1e-7);break;case 3:lambda=e.multiply(Math.max(1/3,1-(2*B-1)^3),lambda),nu=2}else switch(b=x,v%(2*d)==0&&(J=this.lm_matx(r,n,g,M,-1,A,t,i,_,s,h),U=J.JtWJ,T=J.JtWdy,dX2=J.Chi_sq,N=J.y_hat,A=J.J),V){case 1:lambda=Math.min(lambda*j,1e7);break;case 2:lambda+=Math.abs((Q-b)/2/Y);break;case 3:lambda*=nu,nu=2*nu}}return _=e.multiply(e.multiply(e.transpose(F),F),o.ones(y,1)),_.apply(function(r,t){_[r][t]=(y-I+1)/_[r][t]}),J=this.lm_matx(r,n,g,M,-1,A,t,i,_,s,h),U=J.JtWJ,T=J.JtWdy,b=J.Chi_sq,N=J.y_hat,A=J.J,{p:t,X2:b}},lm_FD_J:function(r,t,n,i,a,s){var f=i.length,u=n.length;a=a||e.multiply(o.ones(u,1),.001);for(var h=n.clone(),l=new o(f,u),c=new Array(u),v=0;v<u;v++){if(c[v]=a[v]*(1+Math.abs(n[v][0])),n[v]=[h[v][0]+c[v]],0!=c[v])if(y1=r(t,n,s),a[v][0]<0)for(var w=e.dotDivide(e.subtract(y1,i),c[v]),m=0;m<f;m++)l[m][v]=w[m][0];else{n[v][0]=h[v][0]-c[v];for(var w=e.dotDivide(e.subtract(y1,r(t,n,s)),2*c[v]),m=0;m<f;m++)l[m][v]=w[m][0]}n[v]=h[v]}return l},lm_Broyden_J:function(r,t,n,o,i){var a=e.subtract(o,r),s=e.transpose(a);return s.div(e.multiply(s,a)),n=e.add(n,e.multiply(e.subtract(i,e.add(t,e.multiply(n,a))),s))},lm_matx:function(r,t,n,i,a,s,f,u,h,l,c,v){var w=(u.length,f.length);l=l||.001;var m=r(t,f,c);s=v%(2*w)==0||a>0?this.lm_FD_J(r,t,f,m,l,c):this.lm_Broyden_J(n,i,s,f,m);var p=e.subtract(u,m),d=e.multiply(e.transpose(p),e.dotMultiply(p,h)),y=e.transpose(s),g=e.multiply(y,e.dotMultiply(s,e.multiply(h,o.ones(1,w)))),M=e.multiply(y,e.dotMultiply(h,p));return{JtWJ:g,JtWdy:M,Chi_sq:d,y_hat:m,J:s}}};r.exports=i},function(r,t,n){"use strict";r.exports=n(6),r.exports.Decompositions=r.exports.DC=n(7)},function(r,t){"use strict";function n(r){for(var t=0,n=r.length,o=new Array(n);t<n;t++)o[t]=r[t];return o}function o(r,t){var e,i,a=0;if(Array.isArray(r)){if(i=t,e=i?n(r):r,r=e.length,t=e[0].length,"undefined"==typeof t)throw new TypeError("Data must be a 2D array");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(;a<r;a++){if(e[a].length!==t)throw new RangeError("Inconsistent array dimensions");i&&(e[a]=n(e[a]))}}else{if("number"!=typeof r)throw new TypeError("Invalid arguments");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(e=new Array(r);a<r;a++)e[a]=new Array(t)}return Object.defineProperty(e,"rows",{writable:!0,value:r}),Object.defineProperty(e,"columns",{writable:!0,value:t}),e.__proto__=o.prototype,e}var e=Array.prototype.splice,i=Array.prototype.concat;o.from1DArray=function(r,t,n){var e,i,a=0;if(e=r*t,e!==n.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(r);a<r;a++)i[a]=n.slice(a*t,(a+1)*t);return new o(i)},o.rowVector=function(r){return new o([r])},o.columnVector=function(r){for(var t=r.length,n=new Array(t),e=0;e<t;e++)n[e]=[r[e]];return new o(n)},o.empty=function(r,t){return new o(r,t)},o.zeros=function(r,t){return o.empty(r,t).fill(0)},o.ones=function(r,t){return o.empty(r,t).fill(1)},o.rand=function(r,t){for(var n=o.empty(r,t),e=0,i=n.rows;e<i;e++)for(var a=0,s=n.columns;a<s;a++)n[e][a]=Math.random();return n},o.eye=function(r){for(var t=o.zeros(r,r),n=t.rows,e=0;e<n;e++)t[e][e]=1;return t},o.diag=function(r){for(var t=r.length,n=o.zeros(t,t),e=0;e<t;e++)n[e][e]=r[e];return n},o.indices=function(r,t){for(var n=new Array(t-r),o=0;o<n.length;o++)n[o]=r++;return n},o.stack=function(r){var t,n,e;if(o.isMatrix(r)){var i=0,a=0;for(t=0;t<arguments.length;t++)i+=arguments[t].rows,arguments[t].columns>a&&(a=arguments[t].columns);var s=o.zeros(i,a),f=0;for(t=0;t<arguments.length;t++){var u=arguments[t];for(n=0;n<u.rows;n++){for(e=0;e<u.columns;e++)s[f][e]=u[n][e];f++}}return s}if(Array.isArray(r)){var h=o.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)h.setRow(t,arguments[t]);return h}},o.expand=function(r,t){for(var n=[],e=0;e<t.length;e++)for(var i=0;i<t[e];i++)n.push(r[e]);return new o(n)},o.checkMatrix=function(r){if(!r)throw new TypeError("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new o(r)),r},o.isMatrix=function(r){return!!r&&"Matrix"===r.klass},Object.defineProperty(o.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(o.prototype,"size",{get:function(){return this.rows*this.columns}}),o.prototype.checkRowIndex=function(r){if(r<0||r>this.rows-1)throw new RangeError("Row index out of range.")},o.prototype.checkColumnIndex=function(r){if(r<0||r>this.columns-1)throw new RangeError("Column index out of range.")},o.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal.")},o.prototype.apply=function(r){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)r.call(this,o,e);return this},o.prototype.clone=function(){return new o(this.to2DArray())},o.prototype.to1DArray=function(){return i.apply([],this)},o.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),o=0;o<r;o++)t[o]=n(this[o]);return t},o.prototype.isRowVector=function(){return 1===this.rows},o.prototype.isColumnVector=function(){return 1===this.columns},o.prototype.isVector=function(){return 1===this.rows||1===this.columns},o.prototype.isSquare=function(){return this.rows===this.columns},o.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;t<r;t++)for(var n=0;n<=t;n++)if(this[t][n]!==this[n][t])return!1;return!0}return!1},o.prototype.set=function(r,t,n){return this[r][t]=n,this},o.prototype.get=function(r,t){return this[r][t]},o.prototype.fill=function(r){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]=r;return this},o.prototype.neg=function(){return this.mulS(-1)},o.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=o.checkMatrix(r),this.addM(r))},o.prototype.addS=function(r){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]+=r;return this},o.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]+=r[o][e];return this},o.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=o.checkMatrix(r),this.subM(r))},o.prototype.subS=function(r){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]-=r;return this},o.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]-=r[o][e];return this},o.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=o.checkMatrix(r),this.mulM(r))},o.prototype.mulS=function(r){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]*=r;return this},o.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]*=r[o][e];return this},o.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=o.checkMatrix(r),this.divM(r))},o.prototype.divS=function(r){for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]/=r;return this},o.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]/=r[o][e];return this},o.prototype.getRow=function(r){return this.checkRowIndex(r),n(this[r])},o.prototype.getRowVector=function(r){return o.rowVector(this.getRow(r))},o.prototype.setRow=function(r,t){if(this.checkRowIndex(r),o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return this[r]=n(t),this},o.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return e.call(this,r,1),this.rows-=1,this},o.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),r<0||r>this.rows)throw new RangeError("Row index out of range.");if(o.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return e.call(this,r,0,n(t)),this.rows+=1,this},o.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var n=this[r];return this[r]=this[t],this[t]=n,this},o.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,n=new Array(t),o=0;o<t;o++)n[o]=this[o][r];return n},o.prototype.getColumnVector=function(r){return o.columnVector(this.getColumn(r))},o.prototype.setColumn=function(r,t){this.checkColumnIndex(r),o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;e<n;e++)this[e][r]=t[e];return this},o.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0,n=this.rows;t<n;t++)this[t].splice(r,1);return this.columns-=1,this},o.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),r<0||r>this.columns)throw new RangeError("Column index out of range.");o.isMatrix(t)&&(t=t.to1DArray());var n=this.rows;if(t.length!==n)throw new RangeError("Invalid column size");for(var e=0;e<n;e++)this[e].splice(r,0,t[e]);return this.columns+=1,this},o.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var n,o,e=this.rows,i=0;i<e;i++)o=this[i],n=o[r],o[r]=o[t],o[t]=n;return this},o.prototype.checkRowVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return r},o.prototype.checkColumnVector=function(r){if(o.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return r},o.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]+=r[e];return this},o.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]-=r[e];return this},o.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]*=r[e];return this},o.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]/=r[e];return this},o.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]+=r[o];return this},o.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]-=r[o];return this},o.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]*=r[o];return this},o.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]/=r[o];return this},o.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var n=0,o=this.columns;n<o;n++)this[r][n]*=t;return this},o.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var n=0,o=this.rows;n<o;n++)this[n][r]*=t},o.prototype.max=function(){for(var r=-(1/0),t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]>r&&(r=this[o][e]);return r},o.prototype.maxIndex=function(){for(var r=-(1/0),t={},n=this.rows,o=this.columns,e=0;e<n;e++)for(var i=0;i<o;i++)this[e][i]>r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.min=function(){for(var r=1/0,t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)this[o][e]<r&&(r=this[o][e]);return r},o.prototype.minIndex=function(){for(var r=1/0,t={},n=this.rows,o=this.columns,e=0;e<n;e++)for(var i=0;i<o;i++)this[e][i]<r&&(r=this[e][i],t.row=e,t.column=i);return t},o.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-(1/0),n=0,o=this.columns;n<o;n++)this[r][n]>t&&(t=this[r][n]);return t},o.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-(1/0),n={row:r},o=0,e=this.columns;o<e;o++)this[r][o]>t&&(t=this[r][o],n.column=o);return n},o.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,n=0,o=this.columns;n<o;n++)this[r][n]<t&&(t=this[r][n]);return t},o.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,n={row:r,column:0},o=0,e=this.columns;o<e;o++)this[r][o]<t&&(t=this[r][o],n.column=o);return n},o.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n=0,o=this.rows;n<o;n++)this[n][r]>t&&(t=this[n][r]);return t},o.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-(1/0),n={row:0,column:r},o=0,e=this.rows;o<e;o++)this[o][r]>t&&(t=this[o][r],n.row=o);return n},o.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,n=0,o=this.rows;n<o;n++)this[n][r]<t&&(t=this[n][r]);return t},o.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,n={row:0,column:r},o=0,e=this.rows;o<e;o++)this[o][r]<t&&(t=this[o][r],n.row=o);return n},o.prototype.diag=function a(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var a=new Array(this.rows),r=0,t=this.rows;r<t;r++)a[r]=this[r][r];return a},o.prototype.sum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)r+=this[o][e];return r},o.prototype.mean=function(){return this.sum()/this.size},o.prototype.prod=function s(){for(var s=1,r=this.rows,t=this.columns,n=0;n<r;n++)for(var o=0;o<t;o++)s*=this[n][o];return s},o.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,n=this.columns,o=0;o<t;o++)for(var e=0;e<n;e++)r+=this[o][e],this[o][e]=r;return this},o.prototype.dot=function f(r){if(this.size!==r.size)throw new RangeError("vectors do not have the same size");for(var t=this.to1DArray(),n=r.to1DArray(),f=0,o=t.length,e=0;e<o;e++)f+=t[e]*n[e];return f},o.prototype.mmul=function(r){if(!o.isMatrix(r))throw new TypeError('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,n,e,i=this.rows,a=this.columns,s=r.columns,f=new o(i,s),u=new Array(a);for(n=0;n<s;n++){for(e=0;e<a;e++)u[e]=r[e][n];for(t=0;t<i;t++){var h=this[t],l=0;for(e=0;e<a;e++)l+=h[e]*u[e];f[t][n]=l}}return f},o.prototype.sortRows=function(r){for(var t=0,n=this.rows;t<n;t++)this[t].sort(r);return this},o.prototype.sortColumns=function(r){for(var t=0,n=this.columns;t<n;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},o.prototype.transpose=function(){for(var r=new o(this.columns,this.rows),t=this.rows,n=this.columns,e=0;e<t;e++)for(var i=0;i<n;i++)r[i][e]=this[e][i];return r},o.prototype.subMatrix=function(r,t,n,e){if(r>t||n>e||r<0||r>=this.rows||t<0||t>=this.rows||n<0||n>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");for(var i=new o(t-r+1,e-n+1),a=r;a<=t;a++)for(var s=n;s<=e;s++)i[a-r][s-n]=this[a][s];return i},o.prototype.subMatrixRow=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.columns-1):"undefined"==typeof n&&(n=this.columns-1),t>n||t<0||t>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.rows,a=new o(e,n-t+1),s=0;s<e;s++)for(var f=t;f<=n;f++){if(r[s]<0||r[s]>=i)throw new RangeError("Argument out of range.");a[s][f-t]=this[r[s]][f]}return a},o.prototype.subMatrixColumn=function(r,t,n){if("undefined"==typeof t?(t=0,n=this.rows-1):"undefined"==typeof n&&(n=this.rows-1),t>n||t<0||t>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.columns,a=new o(n-t+1,e),s=0;s<e;s++)for(var f=t;f<=n;f++){if(r[s]<0||r[s]>=i)throw new RangeError("Argument out of range.");a[f-t][s]=this[f][r[s]]}return a},o.prototype.trace=function u(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var u=0,r=0,t=this.rows;r<t;r++)u+=this[r][r];return u},o.prototype.abs=function(){for(var r=this.rows,t=this.columns,n=0;n<r;n++)for(var o=0;o<t;o++)this[n][o]=Math.abs(this[n][o])},r.exports=o},function(r,t,n){"use strict";function o(r){return e(r,i.eye(r.rows))}function e(r,t){return r.isSquare()?new f(r).solve(t):new u(r).solve(t)}var i=n(6),a=n(8),s=n(10),f=n(11),u=n(12),h=n(13);i.prototype.inverse=function(){return o(this)},i.prototype.solve=function(r){return e(this,r)},r.exports={SingularValueDecomposition:a,SVD:a,EigenvalueDecomposition:s,EVD:s,LuDecomposition:f,LU:f,QrDecomposition:u,QR:u,CholeskyDecomposition:h,CHO:h,inverse:o,solve:e}},function(r,t,n){"use strict";function o(r,t){if(!(this instanceof o))return new o(r,t);r=e.checkMatrix(r),t=t||{};var n=r.clone(),a=r.rows,s=r.columns,f=Math.min(a,s),u=!0,h=!0;t.computeLeftSingularVectors===!1&&(u=!1),t.computeRightSingularVectors===!1&&(h=!1);var l=t.autoTranspose===!0,c=!1;if(a<s)if(l){n=n.transpose(),a=n.rows,s=n.columns,c=!0;var v=u;u=h,h=v}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var w,m,p,d,y,g,M,b,x,A,R,z,k,S,E,j,q,V,D,C,I,O=new Array(Math.min(a+1,s)),_=e.zeros(a,f),L=e.zeros(s,s),J=new Array(s),U=new Array(a),T=Math.min(a-1,s),N=Math.max(0,Math.min(s-2,a));for(p=0,A=Math.max(T,N);p<A;p++){if(p<T){for(O[p]=0,w=p;w<a;w++)O[p]=i(O[p],n[w][p]);if(0!==O[p]){for(n[p][p]<0&&(O[p]=-O[p]),w=p;w<a;w++)n[w][p]/=O[p];n[p][p]+=1}O[p]=-O[p]}for(m=p+1;m<s;m++){if(p<T&&0!==O[p]){for(y=0,w=p;w<a;w++)y+=n[w][p]*n[w][m];for(y=-y/n[p][p],w=p;w<a;w++)n[w][m]+=y*n[w][p]}J[m]=n[p][m]}if(u&&p<T)for(w=p;w<a;w++)_[w][p]=n[w][p];if(p<N){for(J[p]=0,w=p+1;w<s;w++)J[p]=i(J[p],J[w]);if(0!==J[p]){for(J[p+1]<0&&(J[p]=-J[p]),w=p+1;w<s;w++)J[w]/=J[p];J[p+1]+=1}if(J[p]=-J[p],p+1<a&&0!==J[p]){for(w=p+1;w<a;w++)U[w]=0;for(m=p+1;m<s;m++)for(w=p+1;w<a;w++)U[w]+=J[m]*n[w][m];for(m=p+1;m<s;m++)for(y=-J[m]/J[p+1],w=p+1;w<a;w++)n[w][m]+=y*U[w]}if(h)for(w=p+1;w<s;w++)L[w][p]=J[w]}}if(d=Math.min(s,a+1),T<s&&(O[T]=n[T][T]),a<d&&(O[d-1]=0),N+1<d&&(J[N]=n[N][d-1]),J[d-1]=0,u){for(m=T;m<f;m++){for(w=0;w<a;w++)_[w][m]=0;_[m][m]=1}for(p=T-1;p>=0;p--)if(0!==O[p]){for(m=p+1;m<f;m++){for(y=0,w=p;w<a;w++)y+=_[w][p]*_[w][m];for(y=-y/_[p][p],w=p;w<a;w++)_[w][m]+=y*_[w][p]}for(w=p;w<a;w++)_[w][p]=-_[w][p];for(_[p][p]=1+_[p][p],w=0;w<p-1;w++)_[w][p]=0}else{for(w=0;w<a;w++)_[w][p]=0;_[p][p]=1}}if(h)for(p=s-1;p>=0;p--){if(p<N&&0!==J[p])for(m=p+1;m<s;m++){for(y=0,w=p+1;w<s;w++)y+=L[w][p]*L[w][m];for(y=-y/L[p+1][p],w=p+1;w<s;w++)L[w][m]+=y*L[w][p]}for(w=0;w<s;w++)L[w][p]=0;L[p][p]=1}for(var P=d-1,W=0,G=Math.pow(2,-52);d>0;){for(p=d-2;p>=-1&&p!==-1;p--)if(Math.abs(J[p])<=G*(Math.abs(O[p])+Math.abs(O[p+1]))){J[p]=0;break}if(p===d-2)R=4;else{for(g=d-1;g>=p&&g!==p;g--)if(y=(g!==d?Math.abs(J[g]):0)+(g!==p+1?Math.abs(J[g-1]):0),Math.abs(O[g])<=G*y){O[g]=0;break}g===p?R=3:g===d-1?R=1:(R=2,p=g)}switch(p++,R){case 1:for(M=J[d-2],J[d-2]=0,m=d-2;m>=p;m--)if(y=i(O[m],M),b=O[m]/y,x=M/y,O[m]=y,m!==p&&(M=-x*J[m-1],J[m-1]=b*J[m-1]),h)for(w=0;w<s;w++)y=b*L[w][m]+x*L[w][d-1],L[w][d-1]=-x*L[w][m]+b*L[w][d-1],L[w][m]=y;break;case 2:for(M=J[p-1],J[p-1]=0,m=p;m<d;m++)if(y=i(O[m],M),b=O[m]/y,x=M/y,O[m]=y,M=-x*J[m],J[m]=b*J[m],u)for(w=0;w<a;w++)y=b*_[w][m]+x*_[w][p-1],_[w][p-1]=-x*_[w][m]+b*_[w][p-1],_[w][m]=y;break;case 3:for(z=Math.max(Math.max(Math.max(Math.max(Math.abs(O[d-1]),Math.abs(O[d-2])),Math.abs(J[d-2])),Math.abs(O[p])),Math.abs(J[p])),k=O[d-1]/z,S=O[d-2]/z,E=J[d-2]/z,j=O[p]/z,q=J[p]/z,V=((S+k)*(S-k)+E*E)/2,D=k*E*(k*E),C=0,0===V&&0===D||(C=Math.sqrt(V*V+D),V<0&&(C=-C),C=D/(V+C)),M=(j+k)*(j-k)+C,I=j*q,m=p;m<d-1;m++){if(y=i(M,I),b=M/y,x=I/y,m!==p&&(J[m-1]=y),M=b*O[m]+x*J[m],J[m]=b*J[m]-x*O[m],I=x*O[m+1],O[m+1]=b*O[m+1],h)for(w=0;w<s;w++)y=b*L[w][m]+x*L[w][m+1],L[w][m+1]=-x*L[w][m]+b*L[w][m+1],L[w][m]=y;if(y=i(M,I),b=M/y,x=I/y,O[m]=y,M=b*J[m]+x*O[m+1],O[m+1]=-x*J[m]+b*O[m+1],I=x*J[m+1],J[m+1]=b*J[m+1],u&&m<a-1)for(w=0;w<a;w++)y=b*_[w][m]+x*_[w][m+1],_[w][m+1]=-x*_[w][m]+b*_[w][m+1],_[w][m]=y}J[d-2]=M,W+=1;break;case 4:if(O[p]<=0&&(O[p]=O[p]<0?-O[p]:0,h))for(w=0;w<=P;w++)L[w][p]=-L[w][p];for(;p<P&&!(O[p]>=O[p+1]);){if(y=O[p],O[p]=O[p+1],O[p+1]=y,h&&p<s-1)for(w=0;w<s;w++)y=L[w][p+1],L[w][p+1]=L[w][p],L[w][p]=y;if(u&&p<a-1)for(w=0;w<a;w++)y=_[w][p+1],_[w][p+1]=_[w][p],_[w][p]=y;p++}W=0,d--}}if(c){var F=L;L=_,_=F}this.m=a,this.n=s,this.s=O,this.U=_,this.V=L}var e=n(6),i=n(9).hypotenuse;o.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,n=0,o=this.s,e=0,i=o.length;e<i;e++)o[e]>t&&n++;return n},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(r){var t,n=r,o=this.threshold,i=this.s.length,a=e.zeros(i,i);for(t=0;t<i;t++)Math.abs(this.s[t])<=o?a[t][t]=0:a[t][t]=1/this.s[t];var s,f,u,h=this.V.mmul(a),l=this.V.rows,c=this.U.rows,v=e.zeros(l,c);for(t=0;t<l;t++)for(s=0;s<c;s++){for(u=0,f=0;f<i;f++)u+=h[t][f]*this.U[s][f];v[t][s]=u}return v.mmul(n)},solveForDiagonal:function(r){return this.solve(e.diag(r))},inverse:function(){var r,t,n=this.threshold,o=this.V.rows,i=this.V.columns,a=new e(o,this.s.length);for(r=0;r<o;r++)for(t=0;t<i;t++)Math.abs(this.s[t])>n?a[r][t]=this.V[r][t]/this.s[t]:a[r][t]=0;var s,f,u=this.U.rows,h=this.U.columns,l=new e(o,u);for(r=0;r<o;r++)for(t=0;t<u;t++){for(f=0,s=0;s<h;s++)f+=a[r][s]*this.U[t][s];l[r][t]=f}return l}},r.exports=o},function(r,t){"use strict";t.hypotenuse=function(r,t){var n;return Math.abs(r)>Math.abs(t)?(n=t/r,Math.abs(r)*Math.sqrt(1+n*n)):0!==t?(n=r/t,Math.abs(t)*Math.sqrt(1+n*n)):0}},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=u.checkMatrix(r),!r.isSquare())throw new Error("Matrix is not a square matrix");var t,n,f=r.columns,h=u.zeros(f,f),l=new Array(f),c=new Array(f),v=r;if(r.isSymmetric()){for(t=0;t<f;t++)for(n=0;n<f;n++)h[t][n]=v[t][n];e(f,c,l,h),i(f,c,l,h)}else{var w=u.zeros(f,f),m=new Array(f);for(n=0;n<f;n++)for(t=0;t<f;t++)w[t][n]=v[t][n];a(f,w,m,h),s(f,c,l,h,w)}this.n=f,this.e=c,
this.d=l,this.V=h}function e(r,t,n,o){var e,i,a,s,f,u,h,l;for(f=0;f<r;f++)n[f]=o[r-1][f];for(s=r-1;s>0;s--){for(l=0,a=0,u=0;u<s;u++)l+=Math.abs(n[u]);if(0===l)for(t[s]=n[s-1],f=0;f<s;f++)n[f]=o[s-1][f],o[s][f]=0,o[f][s]=0;else{for(u=0;u<s;u++)n[u]/=l,a+=n[u]*n[u];for(e=n[s-1],i=Math.sqrt(a),e>0&&(i=-i),t[s]=l*i,a-=e*i,n[s-1]=e-i,f=0;f<s;f++)t[f]=0;for(f=0;f<s;f++){for(e=n[f],o[f][s]=e,i=t[f]+o[f][f]*e,u=f+1;u<=s-1;u++)i+=o[u][f]*n[u],t[u]+=o[u][f]*e;t[f]=i}for(e=0,f=0;f<s;f++)t[f]/=a,e+=t[f]*n[f];for(h=e/(a+a),f=0;f<s;f++)t[f]-=h*n[f];for(f=0;f<s;f++){for(e=n[f],i=t[f],u=f;u<=s-1;u++)o[u][f]-=e*t[u]+i*n[u];n[f]=o[s-1][f],o[s][f]=0}}n[s]=a}for(s=0;s<r-1;s++){if(o[r-1][s]=o[s][s],o[s][s]=1,a=n[s+1],0!==a){for(u=0;u<=s;u++)n[u]=o[u][s+1]/a;for(f=0;f<=s;f++){for(i=0,u=0;u<=s;u++)i+=o[u][s+1]*o[u][f];for(u=0;u<=s;u++)o[u][f]-=i*n[u]}}for(u=0;u<=s;u++)o[u][s+1]=0}for(f=0;f<r;f++)n[f]=o[r-1][f],o[r-1][f]=0;o[r-1][r-1]=1,t[0]=0}function i(r,t,n,o){var e,i,a,s,f,u,l,c,v,w,m,p,d,y,g,M,b;for(a=1;a<r;a++)t[a-1]=t[a];t[r-1]=0;var x=0,A=0,R=Math.pow(2,-52);for(u=0;u<r;u++){for(A=Math.max(A,Math.abs(n[u])+Math.abs(t[u])),l=u;l<r&&!(Math.abs(t[l])<=R*A);)l++;if(l>u){b=0;do{for(b+=1,e=n[u],c=(n[u+1]-e)/(2*t[u]),v=h(c,1),c<0&&(v=-v),n[u]=t[u]/(c+v),n[u+1]=t[u]*(c+v),w=n[u+1],i=e-n[u],a=u+2;a<r;a++)n[a]-=i;for(x+=i,c=n[l],m=1,p=m,d=m,y=t[u+1],g=0,M=0,a=l-1;a>=u;a--)for(d=p,p=m,M=g,e=m*t[a],i=m*c,v=h(c,t[a]),t[a+1]=g*v,g=t[a]/v,m=c/v,c=m*n[a]-g*e,n[a+1]=i+g*(m*e+g*n[a]),f=0;f<r;f++)i=o[f][a+1],o[f][a+1]=g*o[f][a]+m*i,o[f][a]=m*o[f][a]-g*i;c=-g*M*d*y*t[u]/w,t[u]=g*c,n[u]=m*c}while(Math.abs(t[u])>R*A)}n[u]=n[u]+x,t[u]=0}for(a=0;a<r-1;a++){for(f=a,c=n[a],s=a+1;s<r;s++)n[s]<c&&(f=s,c=n[s]);if(f!==a)for(n[f]=n[a],n[a]=c,s=0;s<r;s++)c=o[s][a],o[s][a]=o[s][f],o[s][f]=c}}function a(r,t,n,o){var e,i,a,s,f,u,h,l=0,c=r-1;for(u=l+1;u<=c-1;u++){for(h=0,s=u;s<=c;s++)h+=Math.abs(t[s][u-1]);if(0!==h){for(a=0,s=c;s>=u;s--)n[s]=t[s][u-1]/h,a+=n[s]*n[s];for(i=Math.sqrt(a),n[u]>0&&(i=-i),a-=n[u]*i,n[u]=n[u]-i,f=u;f<r;f++){for(e=0,s=c;s>=u;s--)e+=n[s]*t[s][f];for(e/=a,s=u;s<=c;s++)t[s][f]-=e*n[s]}for(s=0;s<=c;s++){for(e=0,f=c;f>=u;f--)e+=n[f]*t[s][f];for(e/=a,f=u;f<=c;f++)t[s][f]-=e*n[f]}n[u]=h*n[u],t[u][u-1]=h*i}}for(s=0;s<r;s++)for(f=0;f<r;f++)o[s][f]=s===f?1:0;for(u=c-1;u>=l+1;u--)if(0!==t[u][u-1]){for(s=u+1;s<=c;s++)n[s]=t[s][u-1];for(f=u;f<=c;f++){for(i=0,s=u;s<=c;s++)i+=n[s]*o[s][f];for(i=i/n[u]/t[u][u-1],s=u;s<=c;s++)o[s][f]+=i*n[s]}}}function s(r,t,n,o,e){var i,a,s,u,h,l,c,v,w,m,p,d,y,g,M,b=r-1,x=0,A=r-1,R=Math.pow(2,-52),z=0,k=0,S=0,E=0,j=0,q=0,V=0,D=0;for(i=0;i<r;i++)for((i<x||i>A)&&(n[i]=e[i][i],t[i]=0),a=Math.max(i-1,0);a<r;a++)k+=Math.abs(e[i][a]);for(;b>=x;){for(u=b;u>x&&(q=Math.abs(e[u-1][u-1])+Math.abs(e[u][u]),0===q&&(q=k),!(Math.abs(e[u][u-1])<R*q));)u--;if(u===b)e[b][b]=e[b][b]+z,n[b]=e[b][b],t[b]=0,b--,D=0;else if(u===b-1){if(c=e[b][b-1]*e[b-1][b],S=(e[b-1][b-1]-e[b][b])/2,E=S*S+c,V=Math.sqrt(Math.abs(E)),e[b][b]=e[b][b]+z,e[b-1][b-1]=e[b-1][b-1]+z,v=e[b][b],E>=0){for(V=S>=0?S+V:S-V,n[b-1]=v+V,n[b]=n[b-1],0!==V&&(n[b]=v-c/V),t[b-1]=0,t[b]=0,v=e[b][b-1],q=Math.abs(v)+Math.abs(V),S=v/q,E=V/q,j=Math.sqrt(S*S+E*E),S/=j,E/=j,a=b-1;a<r;a++)V=e[b-1][a],e[b-1][a]=E*V+S*e[b][a],e[b][a]=E*e[b][a]-S*V;for(i=0;i<=b;i++)V=e[i][b-1],e[i][b-1]=E*V+S*e[i][b],e[i][b]=E*e[i][b]-S*V;for(i=x;i<=A;i++)V=o[i][b-1],o[i][b-1]=E*V+S*o[i][b],o[i][b]=E*o[i][b]-S*V}else n[b-1]=v+S,n[b]=v+S,t[b-1]=V,t[b]=-V;b-=2,D=0}else{if(v=e[b][b],w=0,c=0,u<b&&(w=e[b-1][b-1],c=e[b][b-1]*e[b-1][b]),10===D){for(z+=v,i=x;i<=b;i++)e[i][i]-=v;q=Math.abs(e[b][b-1])+Math.abs(e[b-1][b-2]),v=w=.75*q,c=-.4375*q*q}if(30===D&&(q=(w-v)/2,q=q*q+c,q>0)){for(q=Math.sqrt(q),w<v&&(q=-q),q=v-c/((w-v)/2+q),i=x;i<=b;i++)e[i][i]-=q;z+=q,v=w=c=.964}for(D+=1,h=b-2;h>=u&&(V=e[h][h],j=v-V,q=w-V,S=(j*q-c)/e[h+1][h]+e[h][h+1],E=e[h+1][h+1]-V-j-q,j=e[h+2][h+1],q=Math.abs(S)+Math.abs(E)+Math.abs(j),S/=q,E/=q,j/=q,h!==u)&&!(Math.abs(e[h][h-1])*(Math.abs(E)+Math.abs(j))<R*(Math.abs(S)*(Math.abs(e[h-1][h-1])+Math.abs(V)+Math.abs(e[h+1][h+1]))));)h--;for(i=h+2;i<=b;i++)e[i][i-2]=0,i>h+2&&(e[i][i-3]=0);for(s=h;s<=b-1&&(g=s!==b-1,s!==h&&(S=e[s][s-1],E=e[s+1][s-1],j=g?e[s+2][s-1]:0,v=Math.abs(S)+Math.abs(E)+Math.abs(j),0!==v&&(S/=v,E/=v,j/=v)),0!==v);s++)if(q=Math.sqrt(S*S+E*E+j*j),S<0&&(q=-q),0!==q){for(s!==h?e[s][s-1]=-q*v:u!==h&&(e[s][s-1]=-e[s][s-1]),S+=q,v=S/q,w=E/q,V=j/q,E/=S,j/=S,a=s;a<r;a++)S=e[s][a]+E*e[s+1][a],g&&(S+=j*e[s+2][a],e[s+2][a]=e[s+2][a]-S*V),e[s][a]=e[s][a]-S*v,e[s+1][a]=e[s+1][a]-S*w;for(i=0;i<=Math.min(b,s+3);i++)S=v*e[i][s]+w*e[i][s+1],g&&(S+=V*e[i][s+2],e[i][s+2]=e[i][s+2]-S*j),e[i][s]=e[i][s]-S,e[i][s+1]=e[i][s+1]-S*E;for(i=x;i<=A;i++)S=v*o[i][s]+w*o[i][s+1],g&&(S+=V*o[i][s+2],o[i][s+2]=o[i][s+2]-S*j),o[i][s]=o[i][s]-S,o[i][s+1]=o[i][s+1]-S*E}}}if(0!==k){for(b=r-1;b>=0;b--)if(S=n[b],E=t[b],0===E)for(u=b,e[b][b]=1,i=b-1;i>=0;i--){for(c=e[i][i]-S,j=0,a=u;a<=b;a++)j+=e[i][a]*e[a][b];if(t[i]<0)V=c,q=j;else if(u=i,0===t[i]?e[i][b]=0!==c?-j/c:-j/(R*k):(v=e[i][i+1],w=e[i+1][i],E=(n[i]-S)*(n[i]-S)+t[i]*t[i],l=(v*q-V*j)/E,e[i][b]=l,e[i+1][b]=Math.abs(v)>Math.abs(V)?(-j-c*l)/v:(-q-w*l)/V),l=Math.abs(e[i][b]),R*l*l>1)for(a=i;a<=b;a++)e[a][b]=e[a][b]/l}else if(E<0)for(u=b-1,Math.abs(e[b][b-1])>Math.abs(e[b-1][b])?(e[b-1][b-1]=E/e[b][b-1],e[b-1][b]=-(e[b][b]-S)/e[b][b-1]):(M=f(0,-e[b-1][b],e[b-1][b-1]-S,E),e[b-1][b-1]=M[0],e[b-1][b]=M[1]),e[b][b-1]=0,e[b][b]=1,i=b-2;i>=0;i--){for(m=0,p=0,a=u;a<=b;a++)m+=e[i][a]*e[a][b-1],p+=e[i][a]*e[a][b];if(c=e[i][i]-S,t[i]<0)V=c,j=m,q=p;else if(u=i,0===t[i]?(M=f(-m,-p,c,E),e[i][b-1]=M[0],e[i][b]=M[1]):(v=e[i][i+1],w=e[i+1][i],d=(n[i]-S)*(n[i]-S)+t[i]*t[i]-E*E,y=2*(n[i]-S)*E,0===d&&0===y&&(d=R*k*(Math.abs(c)+Math.abs(E)+Math.abs(v)+Math.abs(w)+Math.abs(V))),M=f(v*j-V*m+E*p,v*q-V*p-E*m,d,y),e[i][b-1]=M[0],e[i][b]=M[1],Math.abs(v)>Math.abs(V)+Math.abs(E)?(e[i+1][b-1]=(-m-c*e[i][b-1]+E*e[i][b])/v,e[i+1][b]=(-p-c*e[i][b]-E*e[i][b-1])/v):(M=f(-j-w*e[i][b-1],-q-w*e[i][b],V,E),e[i+1][b-1]=M[0],e[i+1][b]=M[1])),l=Math.max(Math.abs(e[i][b-1]),Math.abs(e[i][b])),R*l*l>1)for(a=i;a<=b;a++)e[a][b-1]=e[a][b-1]/l,e[a][b]=e[a][b]/l}for(i=0;i<r;i++)if(i<x||i>A)for(a=i;a<r;a++)o[i][a]=e[i][a];for(a=r-1;a>=x;a--)for(i=x;i<=A;i++){for(V=0,s=x;s<=Math.min(a,A);s++)V+=o[i][s]*e[s][a];o[i][a]=V}}}function f(r,t,n,o){var e,i;return Math.abs(n)>Math.abs(o)?(e=o/n,i=n+e*o,[(r+e*t)/i,(t-e*r)/i]):(e=n/o,i=o+e*n,[(e*r+t)/i,(e*t-r)/i])}var u=n(6),h=n(9).hypotenuse;o.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var r,t,n=this.n,o=this.e,e=this.d,i=new u(n,n);for(r=0;r<n;r++){for(t=0;t<n;t++)i[r][t]=0;i[r][r]=e[r],o[r]>0?i[r][r+1]=o[r]:o[r]<0&&(i[r][r-1]=o[r])}return i}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,i,a,s,f,u,h,l,c,v=r.clone(),w=v.rows,m=v.columns,p=new Array(w),d=1;for(t=0;t<w;t++)p[t]=t;for(l=new Array(w),n=0;n<m;n++){for(t=0;t<w;t++)l[t]=v[t][n];for(t=0;t<w;t++){for(h=v[t],c=Math.min(t,n),s=0,i=0;i<c;i++)s+=h[i]*l[i];h[n]=l[t]-=s}for(a=n,t=n+1;t<w;t++)Math.abs(l[t])>Math.abs(l[a])&&(a=t);if(a!==n){for(i=0;i<m;i++)f=v[a][i],v[a][i]=v[n][i],v[n][i]=f;u=p[a],p[a]=p[n],p[n]=u,d=-d}if(n<w&&0!==v[n][n])for(t=n+1;t<w;t++)v[t][n]/=v[n][n]}this.LU=v,this.pivotVector=p,this.pivotSign=d}var e=n(6);o.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,n=0;n<t;n++)if(0===r[n][n])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=r.columns,o=0;o<n;o++)t*=r[o][o];return t},get lowerTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;i<t;i++)for(var a=0;a<n;a++)i>a?o[i][a]=r[i][a]:i===a?o[i][a]=1:o[i][a]=0;return o},get upperTriangularFactor(){for(var r=this.LU,t=r.rows,n=r.columns,o=new e(t,n),i=0;i<t;i++)for(var a=0;a<n;a++)i<=a?o[i][a]=r[i][a]:o[i][a]=0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=e.checkMatrix(r);var t=this.LU,n=t.rows;if(n!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var o,i,a,s=r.columns,f=r.subMatrixRow(this.pivotVector,0,s-1),u=t.columns;for(a=0;a<u;a++)for(o=a+1;o<u;o++)for(i=0;i<s;i++)f[o][i]-=f[a][i]*t[o][a];for(a=u-1;a>=0;a--){for(i=0;i<s;i++)f[a][i]/=t[a][a];for(o=0;o<a;o++)for(i=0;i<s;i++)f[o][i]-=f[a][i]*t[o][a]}return f}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);r=e.checkMatrix(r);var t,n,a,s,f=r.clone(),u=r.rows,h=r.columns,l=new Array(h);for(a=0;a<h;a++){var c=0;for(t=a;t<u;t++)c=i(c,f[t][a]);if(0!==c){for(f[a][a]<0&&(c=-c),t=a;t<u;t++)f[t][a]/=c;for(f[a][a]+=1,n=a+1;n<h;n++){for(s=0,t=a;t<u;t++)s+=f[t][a]*f[t][n];for(s=-s/f[a][a],t=a;t<u;t++)f[t][n]+=s*f[t][a]}}l[a]=-c}this.QR=f,this.Rdiag=l}var e=n(6),i=n(9).hypotenuse;o.prototype={solve:function(r){r=e.checkMatrix(r);var t=this.QR,n=t.rows;if(r.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,i,a,s,f=r.columns,u=r.clone(),h=t.columns;for(a=0;a<h;a++)for(i=0;i<f;i++){for(s=0,o=a;o<n;o++)s+=t[o][a]*u[o][i];for(s=-s/t[a][a],o=a;o<n;o++)u[o][i]+=s*t[o][a]}for(a=h-1;a>=0;a--){for(i=0;i<f;i++)u[a][i]/=this.Rdiag[a];for(o=0;o<a;o++)for(i=0;i<f;i++)u[o][i]-=u[a][i]*t[o][a]}return u.subMatrix(0,h-1,0,f-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;t<r;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var r,t,n=this.QR,o=n.columns,i=new e(o,o);for(r=0;r<o;r++)for(t=0;t<o;t++)r<t?i[r][t]=n[r][t]:r===t?i[r][t]=this.Rdiag[r]:i[r][t]=0;return i},get orthogonalFactor(){var r,t,n,o,i=this.QR,a=i.rows,s=i.columns,f=new e(a,s);for(n=s-1;n>=0;n--){for(r=0;r<a;r++)f[r][n]=0;for(f[n][n]=1,t=n;t<s;t++)if(0!==i[n][n]){for(o=0,r=n;r<a;r++)o+=i[r][n]*f[r][t];for(o=-o/i[n][n],r=n;r<a;r++)f[r][t]+=o*i[r][n]}}return f}},r.exports=o},function(r,t,n){"use strict";function o(r){if(!(this instanceof o))return new o(r);if(r=e.checkMatrix(r),!r.isSymmetric())throw new Error("Matrix is not symmetric");var t,n,i,a=r,s=a.rows,f=new e(s,s),u=!0;for(n=0;n<s;n++){var h=f[n],l=0;for(i=0;i<n;i++){var c=f[i],v=0;for(t=0;t<i;t++)v+=c[t]*h[t];h[i]=v=(a[n][i]-v)/f[i][i],l+=v*v}for(l=a[n][n]-l,u&=l>0,f[n][n]=Math.sqrt(Math.max(l,0)),i=n+1;i<s;i++)f[n][i]=0}if(!u)throw new Error("Matrix is not positive definite");this.L=f}var e=n(6);o.prototype={get leftTriangularFactor(){return this.L},solve:function(r){r=e.checkMatrix(r);var t=this.L,n=t.rows;if(r.rows!==n)throw new Error("Matrix dimensions do not match");var o,i,a,s=r.columns,f=r.clone();for(a=0;a<n;a++)for(i=0;i<s;i++){for(o=0;o<a;o++)f[a][i]-=f[o][i]*t[a][o];f[a][i]/=t[a][a]}for(a=n-1;a>=0;a--)for(i=0;i<s;i++){for(o=a+1;o<n;o++)f[a][i]-=f[o][i]*t[o][a];f[a][i]/=t[a][a]}return f}},r.exports=o},function(r,t,n){"use strict";function o(r,t){return new A(r,t)}function e(r,t){return A.ones(r,t)}function i(r,t){return A.eye(r,t)}function a(r,t){return A.zeros(r,t)}function s(r,t){return A.rand(r,t)}function f(r){if("number"==typeof r)return r;var t=r.clone();return t.transpose()}function u(r,t){if("number"==typeof r&&"number"==typeof t)return r+t;if("number"==typeof r)return this.add(t,r);var n=r.clone();return n.add(t)}function h(r,t){if("number"==typeof r&&"number"==typeof t)return r-t;if("number"==typeof r)return this.subtract(t,r);var n=r.clone();return n.sub(t)}function l(r,t){if("number"==typeof r&&"number"==typeof t)return r*t;if("number"==typeof r)return this.multiply(t,r);var n=r.clone();return"number"==typeof t?n.mul(t):n=n.mmul(t),1==n.rows&&1==n.columns?n[0][0]:n}function c(r,t){var n=r.clone();return n.mul(t)}function v(r,t){var n=r.clone();return n.div(t)}function w(r){var t,n,o=null,e=r.rows,i=r.columns;if("undefined"==typeof i&&"object"==typeof r)if(r[0]&&r[0].length)for(e=r.length,i=r[0].length,n=Math.min(e,i),o=A.zeros(i,i),t=0;t<i;t++)o[t][t]=r[t][t];else for(i=r.length,o=A.zeros(i,i),t=0;t<i;t++)o[t][t]=r[t];if(1==e)for(o=A.zeros(i,i),t=0;t<i;t++)o[t][t]=r[0][t];else if(e>0&&i>0)for(n=Math.min(e,i),o=new Array(n),t=0;t<n;t++)o[t]=r[t][t];return o}function m(r,t){if("number"==typeof r&&"number"==typeof t)return Math.min(r,t);for(var n=r.rows,o=r.columns,e=new A(n,o),i=0;i<n;i++)for(var a=0;a<o;a++)r[i][a]<t[i][a]?e[i][a]=r[i][a]:e[i][a]=t[i][a];return e}function p(r,t){if("number"==typeof r&&"number"==typeof t)return Math.max(r,t);for(var n=r.rows,o=r.columns,e=new A(n,o),i=0;i<n;i++)for(var a=0;a<o;a++)r[i][a]>t[i][a]?e[i][a]=r[i][a]:e[i][a]=t[i][a];return e}function d(r){if("number"==typeof r)return Math.sqrt(r);for(var t=r.rows,n=r.columns,o=new A(t,n),e=0;e<t;e++)for(var i=0;i<n;i++)o[e][i]=Math.sqrt(r[e][i]);return o}function y(r){if("number"==typeof r)return Math.abs(r);for(var t=r.rows,n=r.columns,o=new A(t,n),e=0;e<t;e++)for(var i=0;i<n;i++)o[e][i]=Math.abs(r[e][i]);return o}function g(r){if("number"==typeof r)return Math.sqrt(r);for(var t=r.rows,n=r.columns,o=new A(t,n),e=0;e<t;e++)for(var i=0;i<n;i++)o[e][i]=Math.exp(r[e][i]);return o}function M(r,t){if("number"==typeof r)return Math.pow(r,t);for(var n=r.rows,o=r.columns,e=new A(n,o),i=0;i<n;i++)for(var a=0;a<o;a++)e[i][a]=Math.pow(r[i][a],t);return e}function b(r,t){return r.solve(t)}function x(r){return"number"==typeof r?1/r:r.inverse()}var A=n(5);r.exports={transpose:f,add:u,subtract:h,multiply:l,dotMultiply:c,dotDivide:v,diag:w,min:m,max:p,solve:b,inv:x,sqrt:d,exp:g,dotPow:M,abs:y,matrix:o,ones:e,zeros:a,random:s,eye:i}},function(r,t,n){function o(r,t,n){var n=Object.create(n||{});void 0===n.minMaxRatio&&(n.minMaxRatio=25e-5),void 0===n.broadRatio&&(n.broadRatio=0),void 0===n.noiseLevel&&(n.noiseLevel=void 0),void 0===n.noiseFactor&&(n.noiseFactor=3),void 0===n.maxCriteria&&(n.maxCriteria=!0),void 0===n.smoothY&&(n.smoothY=!0),void 0===n.realTopDetection&&(n.realTopDetection=!1);var o=a({},f,n.sgOptions);const u=[].concat(t);var h,l,c;if(void 0===n.noiseLevel){var v,w=0,m=Number.MAX_VALUE;for(h=0;h<r.length-1;h++)v=Math.abs(r[h+1]-r[h]),v<m&&(m=v),v>w&&(w=v);(w-m)/w<.05?n.noiseLevel=e(u):n.noiseLevel=0}const p={m:1,b:n.noiseLevel};for(n.maxCriteria||(p.m=-1,p.b*=-1),h=0;h<u.length;h++)u[h]=p.m*u[h]-p.b;for(h=0;h<u.length;h++)u[h]<0&&(u[h]=0);var d,y,g=u;(w-m)/w<.05?(n.smoothY&&(g=s(u,r[1]-r[0],{windowSize:o.windowSize,polynomial:o.polynomial,derivative:0})),d=s(u,r[1]-r[0],{windowSize:o.windowSize,polynomial:o.polynomial,derivative:1}),y=s(u,r[1]-r[0],{windowSize:o.windowSize,polynomial:o.polynomial,derivative:2})):(n.smoothY&&(g=s(u,r,{windowSize:o.windowSize,polynomial:o.polynomial,derivative:0})),d=s(u,r,{windowSize:o.windowSize,polynomial:o.polynomial,derivative:1}),y=s(u,r,{windowSize:o.windowSize,polynomial:o.polynomial,derivative:2}));const M=r,b=r[1]-r[0];var x=0,A=0;for(h=0;h<g.length;h++)Math.abs(y[h])>x&&(x=Math.abs(y[h])),Math.abs(g[h])>A&&(A=Math.abs(g[h]));var R=[],z=[],k=[],S=null,E=null,j=new Array;for(h=1;h<g.length-1;h++)(d[h]<d[h-1]&&d[h]<=d[h+1]||d[h]<=d[h-1]&&d[h]<d[h+1])&&(E=M[h],b>0&&null!=S&&(z.push(S),k.push(E))),(d[h]>=d[h-1]&&d[h]>d[h+1]||d[h]>d[h-1]&&d[h]>=d[h+1])&&(S=M[h],b<0&&null!=E&&(z.push(S),k.push(E))),y[h]<y[h-1]&&y[h]<y[h+1]&&(R.push(h),Math.abs(y[h])>n.broadRatio*x?j.push(!1):j.push(!0));var q,V,D,C,I,O=[],_=0;for(l=0;l<R.length;l++){for(V=M[R[l]],q=-1,c=_+1,C=Number.MAX_VALUE,D=0,I=!0;q==-1&&c<z.length&&I;)D=Math.abs(V-(z[c]+k[c])/2),D<C?C=D:I=!1,D<Math.abs(z[c]-k[c])/2&&(q=c,_=c),c++;q!=-1&&Math.abs(g[R[l]])>n.minMaxRatio*A&&O.push({i:R[l],x:V,y:(g[R[l]]+p.b)/p.m,width:Math.abs(k[q]-z[q]),soft:j[l]})}for(n.realTopDetection&&i(O,M,g),l=0;l<O.length;l++)O[l].base=n.noiseLevel;return O.sort(function(r,t){return r.x-t.x}),O}function e(r){var t=0,n=0,o=r.length,e=0;for(e=0;e<o;e++)t+=r[e];t/=o;var i=new Array(o);for(e=0;e<o;e++)i[e]=Math.abs(r[e]-t);return i.sort(),n=o%2==1?i[(o-1)/2]/.6745:.5*(i[o/2]+i[o/2-1])/.6745}function i(r,t,n){for(var o,e,i,a,s,f=0;f<r.length;f++)s=r[f].i,n[s-1]>=n[s-2]&&n[s-1]>=n[s]?s--:n[s+1]>=n[s]&&n[s+1]>=n[s+2]?s++:n[s-2]>=n[s-3]&&n[s-2]>=n[s-1]?s-=2:n[s+2]>=n[s+1]&&n[s+2]>=n[s+3]&&(s+=2),n[s-1]>0&&n[s+1]>0&&n[s]>=n[s-1]&&n[s]>=n[s+1]&&(o=20*Math.log10(n[s-1]),e=20*Math.log10(n[s]),i=20*Math.log10(n[s+1]),a=.5*(o-i)/(o-2*e+i),r[f].x=t[s]+(t[s]-t[s-1])*a,r[f].y=n[s]-.25*(n[s-1]-n[s+1])*a)}var a=(n(2),n(16),n(19)),s=n(20),f={windowSize:9,polynomial:3};r.exports=o},function(r,t,n){"use strict";t.array=n(17),t.matrix=n(18)},function(r,t){"use strict";function n(r,t){return r-t}t.sum=function o(r){for(var o=0,t=0;t<r.length;t++)o+=r[t];return o},t.max=function e(r){for(var e=r[0],t=r.length,n=1;n<t;n++)r[n]>e&&(e=r[n]);return e},t.min=function i(r){for(var i=r[0],t=r.length,n=1;n<t;n++)r[n]<i&&(i=r[n]);return i},t.minMax=function(r){for(var t=r[0],n=r[0],o=r.length,e=1;e<o;e++)r[e]<t&&(t=r[e]),r[e]>n&&(n=r[e]);return{min:t,max:n}},t.arithmeticMean=function(r){for(var t=0,n=r.length,o=0;o<n;o++)t+=r[o];return t/n},t.mean=t.arithmeticMean,t.geometricMean=function(r){for(var t=1,n=r.length,o=0;o<n;o++)t*=r[o];return Math.pow(t,1/n)},t.logMean=function(r){for(var t=0,n=r.length,o=0;o<n;o++)t+=Math.log(r[o]);return t/n},t.grandMean=function(r,t){for(var n=0,o=0,e=r.length,i=0;i<e;i++)n+=t[i]*r[i],o+=t[i];return n/o},t.truncatedMean=function(r,t,o){void 0===o&&(o=!1),o||(r=[].concat(r).sort(n));for(var e=r.length,i=Math.floor(e*t),a=0,s=i;s<e-i;s++)a+=r[s];return a/(e-2*i)},t.harmonicMean=function(r){for(var t=0,n=r.length,o=0;o<n;o++){if(0===r[o])throw new RangeError("value at index "+o+"is zero");t+=1/r[o]}return n/t},t.contraHarmonicMean=function(r){for(var t=0,n=0,o=r.length,e=0;e<o;e++)t+=r[e]*r[e],n+=r[e];if(n<0)throw new RangeError("sum of values is negative");return t/n},t.median=function(r,t){void 0===t&&(t=!1),t||(r=[].concat(r).sort(n));var o=r.length,e=Math.floor(o/2);return o%2===0?.5*(r[e-1]+r[e]):r[e]},t.variance=function(r,n){void 0===n&&(n=!0);for(var o=t.mean(r),e=0,i=r.length,a=0;a<i;a++){var s=r[a]-o;e+=s*s}return n?e/(i-1):e/i},t.standardDeviation=function(r,n){return Math.sqrt(t.variance(r,n))},t.standardError=function(r){return t.standardDeviation(r)/Math.sqrt(r.length)},t.robustMeanAndStdev=function(r){var t=0,o=0,e=r.length,i=0;for(i=0;i<e;i++)t+=r[i];t/=e;var a=new Array(e);for(i=0;i<e;i++)a[i]=Math.abs(r[i]-t);return a.sort(n),o=e%2===1?a[(e-1)/2]/.6745:.5*(a[e/2]+a[e/2-1])/.6745,{mean:t,stdev:o}},t.quartiles=function(r,o){"undefined"==typeof o&&(o=!1),o||(r=[].concat(r).sort(n));var e=r.length/4,i=r[Math.ceil(e)-1],a=t.median(r,!0),s=r[Math.ceil(3*e)-1];return{q1:i,q2:a,q3:s}},t.pooledStandardDeviation=function(r,n){return Math.sqrt(t.pooledVariance(r,n))},t.pooledVariance=function(r,n){"undefined"==typeof n&&(n=!0);for(var o=0,e=0,i=r.length,a=0;a<i;a++){var s=r[a],f=t.variance(s);o+=(s.length-1)*f,e+=n?s.length-1:s.length}return o/e},t.mode=function(r){var t,n=r.length,o=new Array(n);for(t=0;t<n;t++)o[t]=0;var e=new Array(n),i=0;for(t=0;t<n;t++){var a=e.indexOf(r[t]);a>=0?o[a]++:(e[i]=r[t],o[i]=1,i++)}var s=0,f=0;for(t=0;t<i;t++)o[t]>s&&(s=o[t],f=t);return e[f]},t.covariance=function(r,n,o){"undefined"==typeof o&&(o=!0);var e=t.mean(r),i=t.mean(n);if(r.length!==n.length)throw"Vectors do not have the same dimensions";for(var a=0,s=r.length,f=0;f<s;f++){var u=r[f]-e,h=n[f]-i;a+=u*h}return o?a/(s-1):a/s},t.skewness=function(r,n){"undefined"==typeof n&&(n=!0);for(var o=t.mean(r),e=0,i=0,a=r.length,s=0;s<a;s++){var f=r[s]-o;e+=f*f,i+=f*f*f}var u=e/a,h=i/a,l=h/Math.pow(u,1.5);if(n){var c=Math.sqrt(a*(a-1)),v=a-2;return c/v*l}return l},t.kurtosis=function(r,n){"undefined"==typeof n&&(n=!0);for(var o=t.mean(r),e=r.length,i=0,a=0,s=0;s<e;s++){var f=r[s]-o;i+=f*f,a+=f*f*f*f}var u=i/e,h=a/e;if(n){var l=i/(e-1),c=e*(e+1)/((e-1)*(e-2)*(e-3)),v=a/(l*l),w=(e-1)*(e-1)/((e-2)*(e-3));return c*v-3*w}return h/(u*u)-3},t.entropy=function(r,t){"undefined"==typeof t&&(t=0);for(var n=0,o=r.length,e=0;e<o;e++)n+=r[e]*Math.log(r[e]+t);return-n},t.weightedMean=function(r,t){for(var n=0,o=r.length,e=0;e<o;e++)n+=r[e]*t[e];return n},t.weightedStandardDeviation=function(r,n){return Math.sqrt(t.weightedVariance(r,n))},t.weightedVariance=function(r,n){for(var o=t.weightedMean(r,n),e=0,i=r.length,a=0,s=0,f=0;f<i;f++){var u=r[f]-o,h=n[f];e+=h*(u*u),s+=h,a+=h*h}return e*(s/(s*s-a))},t.center=function(r,n){"undefined"==typeof n&&(n=!1);var o=r;n||(o=[].concat(r));for(var e=t.mean(o),i=o.length,a=0;a<i;a++)o[a]-=e},t.standardize=function(r,n,o){"undefined"==typeof n&&(n=t.standardDeviation(r)),"undefined"==typeof o&&(o=!1);for(var e=r.length,i=o?r:new Array(e),a=0;a<e;a++)i[a]=r[a]/n;return i},t.cumulativeSum=function(r){var t=r.length,n=new Array(t);n[0]=r[0];for(var o=1;o<t;o++)n[o]=n[o-1]+r[o];return n}},function(r,t,n){"use strict";function o(r,t){return r-t}var e=n(17);t.max=function i(r){for(var i=-(1/0),t=0;t<r.length;t++)for(var n=0;n<r[t].length;n++)r[t][n]>i&&(i=r[t][n]);return i},t.min=function a(r){for(var a=1/0,t=0;t<r.length;t++)for(var n=0;n<r[t].length;n++)r[t][n]<a&&(a=r[t][n]);return a},t.minMax=function(r){for(var t=1/0,n=-(1/0),o=0;o<r.length;o++)for(var e=0;e<r[o].length;e++)r[o][e]<t&&(t=r[o][e]),r[o][e]>n&&(n=r[o][e]);return{min:t,max:n}},t.entropy=function(r,t){"undefined"==typeof t&&(t=0);for(var n=0,o=r.length,e=r[0].length,i=0;i<o;i++)for(var a=0;a<e;a++)n+=r[i][a]*Math.log(r[i][a]+t);return-n},t.mean=function(r,t){"undefined"==typeof t&&(t=0);var n,o,e,i,a=r.length,s=r[0].length;if(t===-1){for(n=[0],o=a*s,e=0;e<a;e++)for(i=0;i<s;i++)n[0]+=r[e][i];n[0]/=o}else if(0===t)for(n=new Array(s),o=a,i=0;i<s;i++){for(n[i]=0,e=0;e<a;e++)n[i]+=r[e][i];n[i]/=o}else{if(1!==t)throw new Error("Invalid dimension");for(n=new Array(a),o=s,i=0;i<a;i++){for(n[i]=0,e=0;e<s;e++)n[i]+=r[i][e];n[i]/=o}}return n},t.sum=function(r,t){"undefined"==typeof t&&(t=0);var n,o,e,i=r.length,a=r[0].length;if(t===-1)for(n=[0],o=0;o<i;o++)for(e=0;e<a;e++)n[0]+=r[o][e];else if(0===t)for(n=new Array(a),e=0;e<a;e++)for(n[e]=0,o=0;o<i;o++)n[e]+=r[o][e];else{if(1!==t)throw new Error("Invalid dimension");for(n=new Array(i),e=0;e<i;e++)for(n[e]=0,o=0;o<a;o++)n[e]+=r[e][o]}return n},t.product=function(r,t){"undefined"==typeof t&&(t=0);var n,o,e,i=r.length,a=r[0].length;if(t===-1)for(n=[1],o=0;o<i;o++)for(e=0;e<a;e++)n[0]*=r[o][e];else if(0===t)for(n=new Array(a),e=0;e<a;e++)for(n[e]=1,o=0;o<i;o++)n[e]*=r[o][e];else{if(1!==t)throw new Error("Invalid dimension");for(n=new Array(i),e=0;e<i;e++)for(n[e]=1,o=0;o<a;o++)n[e]*=r[e][o]}return n},t.standardDeviation=function(r,n,o){for(var e=t.variance(r,n,o),i=e.length,a=0;a<i;a++)e[a]=Math.sqrt(e[a]);return e},t.variance=function(r,n,o){"undefined"==typeof o&&(o=!0),n=n||t.mean(r);var e=r.length;if(0===e)return[];for(var i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var f=0,u=0,h=0,l=0;l<e;l++)h=r[l][s]-n[s],f+=h,u+=h*h;o?a[s]=(u-f*f/e)/(e-1):a[s]=(u-f*f/e)/e}return a},t.median=function(r){for(var t=r.length,n=r[0].length,e=new Array(n),i=0;i<n;i++){for(var a=new Array(t),s=0;s<t;s++)a[s]=r[s][i];a.sort(o);var f=a.length;f%2===0?e[i]=.5*(a[f/2]+a[f/2-1]):e[i]=a[Math.floor(f/2)]}return e},t.mode=function(r){var t,n,o=r.length,e=r[0].length,i=new Array(e);for(t=0;t<e;t++){for(var a=new Array(o),s=0;s<o;s++)a[s]=0;var f=new Array(o),u=0;for(n=0;n<o;n++){var h=f.indexOf(r[n][t]);h>=0?a[h]++:(f[u]=r[n][t],a[u]=1,u++)}var l=0,c=0;for(n=0;n<u;n++)a[n]>l&&(l=a[n],c=n);i[t]=f[c]}return i},t.skewness=function(r,n){"undefined"==typeof n&&(n=!0);for(var o=t.mean(r),e=r.length,i=o.length,a=new Array(i),s=0;s<i;s++){for(var f=0,u=0,h=0;h<e;h++){var l=r[h][s]-o[s];f+=l*l,u+=l*l*l}var c=f/e,v=u/e,w=v/Math.pow(c,1.5);if(n){var m=Math.sqrt(e*(e-1)),p=e-2;a[s]=m/p*w}else a[s]=w}return a},t.kurtosis=function(r,n){"undefined"==typeof n&&(n=!0);for(var o=t.mean(r),e=r.length,i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var f=0,u=0,h=0;h<e;h++){var l=r[h][s]-o[s];f+=l*l,u+=l*l*l*l}var c=f/e,v=u/e;if(n){var w=f/(e-1),m=e*(e+1)/((e-1)*(e-2)*(e-3)),p=u/(w*w),d=(e-1)*(e-1)/((e-2)*(e-3));a[s]=m*p-3*d}else a[s]=v/(c*c)-3}return a},t.standardError=function(r){for(var n=r.length,o=t.standardDeviation(r),e=o.length,i=new Array(e),a=Math.sqrt(n),s=0;s<e;s++)i[s]=o[s]/a;return i},t.covariance=function(r,n){return t.scatter(r,void 0,n)},t.scatter=function(r,n,o){"undefined"==typeof o&&(o=0),"undefined"==typeof n&&(0===o?n=r.length-1:1===o&&(n=r[0].length-1));var e=t.mean(r,o),i=r.length;if(0===i)return[[]];var a,s,f,u,h,l=r[0].length;if(0===o){for(a=new Array(l),s=0;s<l;s++)a[s]=new Array(l);for(s=0;s<l;s++)for(f=s;f<l;f++){for(u=0,h=0;h<i;h++)u+=(r[h][f]-e[f])*(r[h][s]-e[s]);u/=n,a[s][f]=u,a[f][s]=u}}else{if(1!==o)throw new Error("Invalid dimension");for(a=new Array(i),s=0;s<i;s++)a[s]=new Array(i);for(s=0;s<i;s++)for(f=s;f<i;f++){for(u=0,h=0;h<l;h++)u+=(r[f][h]-e[f])*(r[s][h]-e[s]);u/=n,a[s][f]=u,a[f][s]=u}}return a},t.correlation=function(r){var n,o,e=t.mean(r),i=t.standardDeviation(r,!0,e),a=t.zScores(r,e,i),s=r.length,f=r[0].length,u=new Array(f);for(n=0;n<f;n++)u[n]=new Array(f);for(n=0;n<f;n++)for(o=n;o<f;o++){for(var h=0,l=0,c=a.length;l<c;l++)h+=a[l][o]*a[l][n];h/=s-1,u[n][o]=h,u[o][n]=h}return u},t.zScores=function(r,n,o){return n=n||t.mean(r),"undefined"==typeof o&&(o=t.standardDeviation(r,!0,n)),t.standardize(t.center(r,n,!1),o,!0)},t.center=function(r,n,o){n=n||t.mean(r);var e,i,a,s=r,f=r.length;if(!o)for(s=new Array(f),e=0;e<f;e++)s[e]=new Array(r[e].length);for(e=0;e<f;e++){var u=s[e];for(i=0,a=u.length;i<a;i++)u[i]=r[e][i]-n[i]}return s},t.standardize=function(r,n,o){"undefined"==typeof n&&(n=t.standardDeviation(r));var e,i,a,s=r,f=r.length;if(!o)for(s=new Array(f),e=0;e<f;e++)s[e]=new Array(r[e].length);for(e=0;e<f;e++){var u=s[e],h=r[e];for(i=0,a=u.length;i<a;i++)0===n[i]||isNaN(n[i])||(u[i]=h[i]/n[i])}return s},t.weightedVariance=function(r,n){var o=t.mean(r),e=r.length;if(0===e)return[];for(var i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var f=0,u=0,h=0,l=0;l<e;l++){var c=r[l][s]-o[s],v=n[l];f+=v*(c*c),h+=v,u+=v*v}a[s]=f*(h/(h*h-u))}return a},t.weightedMean=function(r,t,n){"undefined"==typeof n&&(n=0);var o=r.length;if(0===o)return[];var i,a,s,f,u,h,l=r[0].length;if(0===n){for(i=new Array(l),a=0;a<l;a++)i[a]=0;for(a=0;a<o;a++)for(h=r[a],u=t[a],f=0;f<l;f++)i[f]+=h[f]*u}else{if(1!==n)throw new Error("Invalid dimension");for(i=new Array(o),a=0;a<o;a++)i[a]=0;for(f=0;f<o;f++)for(h=r[f],u=t[f],a=0;a<l;a++)i[f]+=h[a]*u}var c=e.sum(t);if(0!==c)for(a=0,s=i.length;a<s;a++)i[a]/=c;return i},t.weightedCovariance=function(r,n,o,e){e=e||0,o=o||t.weightedMean(r,n,e);for(var i=0,a=0,s=0,f=n.length;s<f;s++)i+=n[s],a+=n[s]*n[s];var u=i/(i*i-a);return t.weightedScatter(r,n,o,u,e)},t.weightedScatter=function(r,n,o,e,i){i=i||0,o=o||t.weightedMean(r,n,i),"undefined"==typeof e&&(e=1);var a=r.length;if(0===a)return[[]];var s,f,u,h,l,c=r[0].length;if(0===i){for(s=new Array(c),f=0;f<c;f++)s[f]=new Array(c);for(f=0;f<c;f++)for(u=f;u<c;u++){for(l=0,h=0;h<a;h++)l+=n[h]*(r[h][u]-o[u])*(r[h][f]-o[f]);s[f][u]=l*e,s[u][f]=l*e}}else{if(1!==i)throw new Error("Invalid dimension");for(s=new Array(a),f=0;f<a;f++)s[f]=new Array(a);for(f=0;f<a;f++)for(u=f;u<a;u++){for(l=0,h=0;h<c;h++)l+=n[h]*(r[u][h]-o[u])*(r[f][h]-o[f]);s[f][u]=l*e,s[u][f]=l*e}}return s}},function(r,t){"use strict";var n=Object.prototype.hasOwnProperty,o=Object.prototype.toString,e=function(r){return"function"==typeof Array.isArray?Array.isArray(r):"[object Array]"===o.call(r)},i=function(r){if(!r||"[object Object]"!==o.call(r))return!1;var t=n.call(r,"constructor"),e=r.constructor&&r.constructor.prototype&&n.call(r.constructor.prototype,"isPrototypeOf");if(r.constructor&&!t&&!e)return!1;var i;for(i in r);return"undefined"==typeof i||n.call(r,i)};r.exports=function a(){var r,t,n,o,s,f,u=arguments[0],h=1,l=arguments.length,c=!1;for("boolean"==typeof u?(c=u,u=arguments[1]||{},h=2):("object"!=typeof u&&"function"!=typeof u||null==u)&&(u={});h<l;++h)if(r=arguments[h],null!=r)for(t in r)n=u[t],o=r[t],u!==o&&(c&&o&&(i(o)||(s=e(o)))?(s?(s=!1,f=n&&e(n)?n:[]):f=n&&i(n)?n:{},u[t]=a(c,f,o)):"undefined"!=typeof o&&(u[t]=o));return u}},function(r,t,n){function o(r,t,n){if(n=u({},h,n),n.windowSize%2===0||n.windowSize<5||!Number.isInteger(n.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(n.windowSize>r.length)throw new RangeError("Window size is higher than the data length "+n.windowSize+">"+r.length);if(n.derivative<0||!Number.isInteger(n.derivative))throw new RangeError("Derivative should be a positive integer");if(n.polynomial<1||!Number.isInteger(n.polynomial))throw new RangeError("Polynomial should be a positive integer");n.polynomial>=6&&console.warn("You should not use polynomial grade higher than 5 if you are not sure that your data arises from such a model. Possible polynomial oscillation problems");var o=n.windowSize,i=Math.floor(o/2),a=r.length,s=new Array(a),l=f(o,n.polynomial,n.derivative),c=0,v=!0;"[object Array]"===Object.prototype.toString.call(t)?v=!1:c=Math.pow(t,n.derivative);for(var w=0;w<i;w++){for(var m=l[i-w-1],p=l[i+w+1],d=0,y=0,g=0;g<o;g++)d+=m[g]*r[g],y+=p[g]*r[a-o+g-1];v?(s[i-w-1]=d/c,s[a-i+w]=y/c):(c=e(t,i-w-1,i,n.derivative),s[i-w-1]=d/c,c=e(t,a-i+w,i,n.derivative),s[a-i+w]=y/c)}for(var M=l[i],w=o;w<a+1;w++){for(var b=0,g=0;g<o;g++)b+=M[g]*r[g+w-o];v||(c=e(t,w-i-1,i,n.derivative)),s[w-i-1]=b/c}return s}function e(r,t,n,o){for(var e=0,i=0,a=t-n;a<t+n;a++)a>=0&&a<r.length-1&&(e+=r[a+1]-r[a],i++);return Math.pow(e/i,o)}function i(r,t,n,o){var e=0;return e=n>0?(4*n-2)/(n*(2*t-n+1))*(r*i(r,t,n-1,o)+o*i(r,t,n-1,o-1))-(n-1)*(2*t+n)/(n*(2*t-n+1))*i(r,t,n-2,o):0==n&&0==o?1:0}function a(r,t){var n=1;if(r>=t)for(var o=r-t+1;o<=r;o++)n*=o;return n}function s(r,t,n,o,e){for(var s=0,f=0;f<=o;f++)s+=(2*f+1)*(a(2*n,f)/a(2*n+f+1,f+1))*i(r,n,f,0)*i(t,n,f,e);return s}function f(r,t,n){for(var o=new Array(r),e=Math.floor(r/2),i=-e;i<=e;i++){o[i+e]=new Array(r);for(var a=-e;a<=e;a++)o[i+e][a+e]=s(a,i,e,t,n)}return o}var u=n(19),h=(n(21),{windowSize:9,derivative:0,polynomial:3});r.exports=o},function(r,t,n){"use strict";t.array=n(22),t.matrix=n(23)},function(r,t){"use strict";function n(r,t){return r-t}t.sum=function o(r){for(var o=0,t=0;t<r.length;t++)o+=r[t];return o},t.max=function e(r){for(var e=-(1/0),t=r.length,n=0;n<t;n++)r[n]>e&&(e=r[n]);return e},t.min=function i(r){for(var i=1/0,t=r.length,n=0;n<t;n++)r[n]<i&&(i=r[n]);return i},t.minMax=function(r){for(var t=1/0,n=-(1/0),o=r.length,e=0;e<o;e++)r[e]<t&&(t=r[e]),r[e]>n&&(n=r[e]);return{min:t,max:n}},t.arithmeticMean=function(r){for(var t=0,n=r.length,o=0;o<n;o++)t+=r[o];return t/n},t.mean=t.arithmeticMean,t.geometricMean=function(r){for(var t=1,n=r.length,o=0;o<n;o++)t*=r[o];return Math.pow(t,1/n)},t.logMean=function(r){for(var t=0,n=r.length,o=0;o<n;o++)t+=Math.log(r[o]);return t/n},t.grandMean=function(r,t){for(var n=0,o=0,e=r.length,i=0;i<e;i++)n+=t[i]*r[i],o+=t[i];return n/o},t.truncatedMean=function(r,t,o){void 0===o&&(o=!1),o||(r=r.slice().sort(n));for(var e=r.length,i=Math.floor(e*t),a=0,s=i;s<e-i;s++)a+=r[s];return a/(e-2*i)},t.harmonicMean=function(r){for(var t=0,n=r.length,o=0;o<n;o++){if(0===r[o])throw new RangeError("value at index "+o+"is zero");t+=1/r[o]}return n/t},t.contraHarmonicMean=function(r){for(var t=0,n=0,o=r.length,e=0;e<o;e++)t+=r[e]*r[e],n+=r[e];if(n<0)throw new RangeError("sum of values is negative");return t/n},t.median=function(r,t){void 0===t&&(t=!1),t||(r=r.slice().sort(n));var o=r.length,e=Math.floor(o/2);return o%2===0?.5*(r[e-1]+r[e]):r[e]},t.variance=function(r,n){void 0===n&&(n=!0);for(var o=t.mean(r),e=0,i=r.length,a=0;a<i;a++){var s=r[a]-o;e+=s*s}return n?e/(i-1):e/i},t.standardDeviation=function(r,n){return Math.sqrt(t.variance(r,n))},t.standardError=function(r){return t.standardDeviation(r)/Math.sqrt(r.length)},t.quartiles=function(r,o){"undefined"==typeof o&&(o=!1),o||(r=r.slice(),r.sort(n));var e=r.length/4,i=r[Math.ceil(e)-1],a=t.median(r,!0),s=r[Math.ceil(3*e)-1];return{q1:i,q2:a,q3:s}},t.pooledStandardDeviation=function(r,n){return Math.sqrt(t.pooledVariance(r,n))},t.pooledVariance=function(r,n){
"undefined"==typeof n&&(n=!0);for(var o=0,e=0,i=r.length,a=0;a<i;a++){var s=r[a],f=t.variance(s);o+=(s.length-1)*f,e+=n?s.length-1:s.length}return o/e},t.mode=function(r){var t,n=r.length,o=new Array(n);for(t=0;t<n;t++)o[t]=0;var e=new Array(n),i=0;for(t=0;t<n;t++){var a=e.indexOf(r[t]);a>=0?o[a]++:(e[i]=r[t],o[i]=1,i++)}var s=0,f=0;for(t=0;t<i;t++)o[t]>s&&(s=o[t],f=t);return e[f]},t.covariance=function(r,n,o){"undefined"==typeof o&&(o=!0);var e=t.mean(r),i=t.mean(n);if(r.length!==n.length)throw"Vectors do not have the same dimensions";for(var a=0,s=r.length,f=0;f<s;f++){var u=r[f]-e,h=n[f]-i;a+=u*h}return o?a/(s-1):a/s},t.skewness=function(r,n){"undefined"==typeof n&&(n=!0);for(var o=t.mean(r),e=0,i=0,a=r.length,s=0;s<a;s++){var f=r[s]-o;e+=f*f,i+=f*f*f}var u=e/a,h=i/a,l=h/Math.pow(u,1.5);if(n){var c=Math.sqrt(a*(a-1)),v=a-2;return c/v*l}return l},t.kurtosis=function(r,n){"undefined"==typeof n&&(n=!0);for(var o=t.mean(r),e=r.length,i=0,a=0,s=0;s<e;s++){var f=r[s]-o;i+=f*f,a+=f*f*f*f}var u=i/e,h=a/e;if(n){var l=i/(e-1),c=e*(e+1)/((e-1)*(e-2)*(e-3)),v=a/(l*l),w=(e-1)*(e-1)/((e-2)*(e-3));return c*v-3*w}return h/(u*u)-3},t.entropy=function(r,t){"undefined"==typeof t&&(t=0);for(var n=0,o=r.length,e=0;e<o;e++)n+=r[e]*Math.log(r[e]+t);return-n},t.weightedMean=function(r,t){for(var n=0,o=r.length,e=0;e<o;e++)n+=r[e]*t[e];return n},t.weightedStandardDeviation=function(r,n){return Math.sqrt(t.weightedVariance(r,n))},t.weightedVariance=function(r,n){for(var o=t.weightedMean(r,n),e=0,i=r.length,a=0,s=0,f=0;f<i;f++){var u=r[f]-o,h=n[f];e+=h*(u*u),s+=h,a+=h*h}return e*(s/(s*s-a))},t.center=function(r,n){"undefined"==typeof n&&(n=!1);var o=r;n||(o=r.slice());for(var e=t.mean(o),i=o.length,a=0;a<i;a++)o[a]-=e},t.standardize=function(r,n,o){"undefined"==typeof n&&(n=t.standardDeviation(r)),"undefined"==typeof o&&(o=!1);for(var e=r.length,i=o?r:new Array(e),a=0;a<e;a++)i[a]=r[a]/n;return i},t.cumulativeSum=function(r){var t=r.length,n=new Array(t);n[0]=r[0];for(var o=1;o<t;o++)n[o]=n[o-1]+r[o];return n}},function(r,t,n){"use strict";function o(r,t){"undefined"==typeof t&&(t=0);for(var n=0,o=r.length,e=r[0].length,i=0;i<o;i++)for(var a=0;a<e;a++)n+=r[i][a]*Math.log(r[i][a]+t);return-n}function e(r,t){"undefined"==typeof t&&(t=0);var n,o,e,i,a=r.length,s=r[0].length;if(t===-1){for(n=[0],o=a*s,e=0;e<a;e++)for(i=0;i<s;i++)n[0]+=r[e][i];n[0]/=o}else if(0===t)for(n=new Array(s),o=a,i=0;i<s;i++){for(n[i]=0,e=0;e<a;e++)n[i]+=r[e][i];n[i]/=o}else{if(1!==t)throw new Error("Invalid dimension");for(n=new Array(a),o=s,i=0;i<a;i++){for(n[i]=0,e=0;e<s;e++)n[i]+=r[i][e];n[i]/=o}}return n}function i(r,t,n){for(var o=a(r,t,n),e=o.length,i=0;i<e;i++)o[i]=Math.sqrt(o[i]);return o}function a(r,t,n){"undefined"==typeof n&&(n=!0),t=t||e(r);var o=r.length;if(0===o)return[];for(var i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var f=0,u=0,h=0,l=0;l<o;l++)h=r[l][s]-t[s],f+=h,u+=h*h;n?a[s]=(u-f*f/o)/(o-1):a[s]=(u-f*f/o)/o}return a}function s(r){for(var t=r.length,n=r[0].length,o=new Array(n),e=0;e<n;e++){for(var i=new Array(t),a=0;a<t;a++)i[a]=r[a][e];i.sort();var s=i.length;s%2===0?o[e]=.5*(i[s/2]+i[s/2-1]):o[e]=i[Math.floor(s/2)]}return o}function f(r){var t,n,o=r.length,e=r[0].length,i=new Array(e);for(t=0;t<e;t++){for(var a=new Array(o),s=0;s<o;s++)a[s]=0;var f=new Array(o),u=0;for(n=0;n<o;n++){var h=f.indexOf(r[n][t]);h>=0?a[h]++:(f[u]=r[n][t],a[u]=1,u++)}var l=0,c=0;for(n=0;n<u;n++)a[n]>l&&(l=a[n],c=n);i[t]=f[c]}return i}function u(r,t){"undefined"==typeof t&&(t=!0);for(var n=e(r),o=r.length,i=n.length,a=new Array(i),s=0;s<i;s++){for(var f=0,u=0,h=0;h<o;h++){var l=r[h][s]-n[s];f+=l*l,u+=l*l*l}var c=f/o,v=u/o,w=v/Math.pow(c,1.5);if(t){var m=Math.sqrt(o*(o-1)),p=o-2;a[s]=m/p*w}else a[s]=w}return a}function h(r,t){"undefined"==typeof t&&(t=!0);for(var n=e(r),o=r.length,i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var f=0,u=0,h=0;h<o;h++){var l=r[h][s]-n[s];f+=l*l,u+=l*l*l*l}var c=f/o,v=u/o;if(t){var w=f/(o-1),m=o*(o+1)/((o-1)*(o-2)*(o-3)),p=u/(w*w),d=(o-1)*(o-1)/((o-2)*(o-3));a[s]=m*p-3*d}else a[s]=v/(c*c)-3}return a}function l(r){for(var t=r.length,n=i(r),o=n.length,e=new Array(o),a=Math.sqrt(t),s=0;s<o;s++)e[s]=n[s]/a;return e}function c(r,t){return v(r,void 0,t)}function v(r,t,n){"undefined"==typeof n&&(n=0),"undefined"==typeof t&&(0===n?t=r.length-1:1===n&&(t=r[0].length-1));var o=e(r,n),i=r.length;if(0===i)return[[]];var a,s,f,u,h,l=r[0].length;if(0===n){for(a=new Array(l),s=0;s<l;s++)a[s]=new Array(l);for(s=0;s<l;s++)for(f=s;f<l;f++){for(u=0,h=0;h<i;h++)u+=(r[h][f]-o[f])*(r[h][s]-o[s]);u/=t,a[s][f]=u,a[f][s]=u}}else{if(1!==n)throw new Error("Invalid dimension");for(a=new Array(i),s=0;s<i;s++)a[s]=new Array(i);for(s=0;s<i;s++)for(f=s;f<i;f++){for(u=0,h=0;h<l;h++)u+=(r[f][h]-o[f])*(r[s][h]-o[s]);u/=t,a[s][f]=u,a[f][s]=u}}return a}function w(r){var t,n,o=e(r),a=i(r,!0,o),s=m(r,o,a),f=r.length,u=r[0].length,h=new Array(u);for(t=0;t<u;t++)h[t]=new Array(u);for(t=0;t<u;t++)for(n=t;n<u;n++){for(var l=0,c=0,v=s.length;c<v;c++)l+=s[c][n]*s[c][t];l/=f-1,h[t][n]=l,h[n][t]=l}return h}function m(r,t,n){return t=t||e(r),"undefined"==typeof n&&(n=i(r,!0,t)),d(p(r,t,!1),n,!0)}function p(r,t,n){t=t||e(r);var o,i,a,s=r,f=r.length;if(!n)for(s=new Array(f),o=0;o<f;o++)s[o]=new Array(r[o].length);for(o=0;o<f;o++){var u=s[o];for(i=0,a=u.length;i<a;i++)u[i]=r[o][i]-t[i]}return s}function d(r,t,n){"undefined"==typeof t&&(t=i(r));var o,e,a,s=r,f=r.length;if(!n)for(s=new Array(f),o=0;o<f;o++)s[o]=new Array(r[o].length);for(o=0;o<f;o++){var u=s[o],h=r[o];for(e=0,a=u.length;e<a;e++)0===t[e]||isNaN(t[e])||(u[e]=h[e]/t[e])}return s}function y(r,t){var n=e(r),o=r.length;if(0===o)return[];for(var i=r[0].length,a=new Array(i),s=0;s<i;s++){for(var f=0,u=0,h=0,l=0;l<o;l++){var c=r[l][s]-n[s],v=t[l];f+=v*(c*c),h+=v,u+=v*v}a[s]=f*(h/(h*h-u))}return a}function g(r,t,n){"undefined"==typeof n&&(n=0);var o=r.length;if(0===o)return[];var e,i,a,s,f,u,h=r[0].length;if(0===n){for(e=new Array(h),i=0;i<h;i++)e[i]=0;for(i=0;i<o;i++)for(u=r[i],f=t[i],s=0;s<h;s++)e[s]+=u[s]*f}else{if(1!==n)throw new Error("Invalid dimension");for(e=new Array(o),i=0;i<o;i++)e[i]=0;for(s=0;s<o;s++)for(u=r[s],f=t[s],i=0;i<h;i++)e[s]+=u[i]*f}var l=x.sum(t);if(0!==l)for(i=0,a=e.length;i<a;i++)e[i]/=l;return e}function M(r,t,n,o){o=o||0,n=n||g(r,t,o);for(var e=0,i=0,a=0,s=t.length;a<s;a++)e+=t[a],i+=t[a]*t[a];var f=e/(e*e-i);return b(r,t,n,f,o)}function b(r,t,n,o,e){e=e||0,n=n||g(r,t,e),"undefined"==typeof o&&(o=1);var i=r.length;if(0===i)return[[]];var a,s,f,u,h,l=r[0].length;if(0===e){for(a=new Array(l),s=0;s<l;s++)a[s]=new Array(l);for(s=0;s<l;s++)for(f=s;f<l;f++){for(h=0,u=0;u<i;u++)h+=t[u]*(r[u][f]-n[f])*(r[u][s]-n[s]);a[s][f]=h*o,a[f][s]=h*o}}else{if(1!==e)throw new Error("Invalid dimension");for(a=new Array(i),s=0;s<i;s++)a[s]=new Array(i);for(s=0;s<i;s++)for(f=s;f<i;f++){for(h=0,u=0;u<l;u++)h+=t[u]*(r[f][u]-n[f])*(r[s][u]-n[s]);a[s][f]=h*o,a[f][s]=h*o}}return a}var x=n(22);r.exports={entropy:o,mean:e,standardDeviation:i,variance:a,median:s,mode:f,skewness:u,kurtosis:h,standardError:l,covariance:c,scatter:v,correlation:w,zScores:m,center:p,standardize:d,weightedVariance:y,weightedMean:g,weightedCovariance:M,weightedScatter:b}}])});
//# sourceMappingURL=ml-gsd.min.js.map