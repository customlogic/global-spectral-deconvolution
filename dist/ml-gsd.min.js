!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.GSD=r():t.GSD=r()}("undefined"!=typeof self?self:this,(function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(r){return t[r]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=12)}([function(t,r,e){"use strict";e(20);var n=e(8),o=e(3);class i extends(n(Array)){constructor(t,r){var e;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(i.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(r)&&r>0))throw new TypeError("nColumns must be a positive integer");for(e=0;e<t;e++)this[e]=new Array(r)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const n=t;if(t=n.length,"number"!=typeof(r=n[0].length)||0===r)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),e=0;e<t;e++){if(n[e].length!==r)throw new RangeError("Inconsistent array dimensions");this[e]=[].concat(n[e])}}}return this.rows=t,this.columns=r,this}set(t,r,e){return this[t][r]=e,this}get(t,r){return this[t][r]}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(r,e,this.get(r,e));return t}removeRow(t){if(o.checkRowIndex(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,r){return void 0===r&&(r=t,t=this.rows),o.checkRowIndex(this,t,!0),r=o.checkRowVector(this,r,!0),this.splice(t,0,r),this.rows+=1,this}removeColumn(t){if(o.checkColumnIndex(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var r=0;r<this.rows;r++)this[r].splice(t,1);return this.columns-=1,this}addColumn(t,r){void 0===r&&(r=t,t=this.columns),o.checkColumnIndex(this,t,!0),r=o.checkColumnVector(this,r);for(var e=0;e<this.rows;e++)this[e].splice(t,0,r[e]);return this.columns+=1,this}}r.Matrix=i,i.abstractMatrix=n},function(t,r,e){"use strict";var n=e(8),o=e(0);class i extends(n()){constructor(t,r,e){super(),this.matrix=t,this.rows=r,this.columns=e}static get[Symbol.species](){return o.Matrix}}t.exports=i},function(t,r,e){"use strict";t.exports=e(0).Matrix,t.exports.Decompositions=t.exports.DC=e(32)},function(t,r,e){"use strict";var n=e(0);r.checkRowIndex=function(t,r,e){var n=e?t.rows:t.rows-1;if(r<0||r>n)throw new RangeError("Row index out of range")},r.checkColumnIndex=function(t,r,e){var n=e?t.columns:t.columns-1;if(r<0||r>n)throw new RangeError("Column index out of range")},r.checkRowVector=function(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return r},r.checkColumnVector=function(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return r},r.checkIndices=function(t,r,e){var n=r.some(r=>r<0||r>=t.rows),o=e.some(r=>r<0||r>=t.columns);if(n||o)throw new RangeError("Indices are out of range");if("object"!=typeof r||"object"!=typeof e)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(r)||(r=Array.from(r)),Array.isArray(e)||(r=Array.from(e)),{row:r,column:e}},r.checkRange=function(t,r,e,n,o){if(5!==arguments.length)throw new TypeError("Invalid argument type");var i=Array.from(arguments).slice(1).some((function(t){return"number"!=typeof t}));if(i)throw new TypeError("Invalid argument type");if(r>e||n>o||r<0||r>=t.rows||e<0||e>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")},r.getRange=function(t,r){for(var e=new Array(r-t+1),n=0;n<e.length;n++)e[n]=t+n;return e},r.sumByRow=function(t){for(var r=n.Matrix.zeros(t.rows,1),e=0;e<t.rows;++e)for(var o=0;o<t.columns;++o)r.set(e,0,r.get(e,0)+t.get(e,o));return r},r.sumByColumn=function(t){for(var r=n.Matrix.zeros(1,t.columns),e=0;e<t.rows;++e)for(var o=0;o<t.columns;++o)r.set(0,o,r.get(0,o)+t.get(e,o));return r},r.sumAll=function(t){for(var r=0,e=0;e<t.rows;e++)for(var n=0;n<t.columns;n++)r+=t.get(e,n);return r}},function(t,r,e){"use strict";r.array=e(6),r.matrix=e(16)},function(t,r,e){"use strict";r.hypotenuse=function(t,r){var e;return Math.abs(t)>Math.abs(r)?(e=r/t,Math.abs(t)*Math.sqrt(1+e*e)):0!==r?(e=t/r,Math.abs(r)*Math.sqrt(1+e*e)):0},r.getEmpty2DArray=function(t,r){for(var e=new Array(t),n=0;n<t;n++)e[n]=new Array(r);return e},r.getFilled2DArray=function(t,r,e){for(var n=new Array(t),o=0;o<t;o++){n[o]=new Array(r);for(var i=0;i<r;i++)n[o][i]=e}return n}},function(t,r,e){"use strict";function n(t,r){return t-r}r.sum=function(t){for(var r=0,e=0;e<t.length;e++)r+=t[e];return r},r.max=function(t){for(var r=t[0],e=t.length,n=1;n<e;n++)t[n]>r&&(r=t[n]);return r},r.min=function(t){for(var r=t[0],e=t.length,n=1;n<e;n++)t[n]<r&&(r=t[n]);return r},r.minMax=function(t){for(var r=t[0],e=t[0],n=t.length,o=1;o<n;o++)t[o]<r&&(r=t[o]),t[o]>e&&(e=t[o]);return{min:r,max:e}},r.arithmeticMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++)r+=t[n];return r/e},r.mean=r.arithmeticMean,r.geometricMean=function(t){for(var r=1,e=t.length,n=0;n<e;n++)r*=t[n];return Math.pow(r,1/e)},r.logMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++)r+=Math.log(t[n]);return r/e},r.grandMean=function(t,r){for(var e=0,n=0,o=t.length,i=0;i<o;i++)e+=r[i]*t[i],n+=r[i];return e/n},r.truncatedMean=function(t,r,e){void 0===e&&(e=!1),e||(t=[].concat(t).sort(n));for(var o=t.length,i=Math.floor(o*r),a=0,s=i;s<o-i;s++)a+=t[s];return a/(o-2*i)},r.harmonicMean=function(t){for(var r=0,e=t.length,n=0;n<e;n++){if(0===t[n])throw new RangeError("value at index "+n+"is zero");r+=1/t[n]}return e/r},r.contraHarmonicMean=function(t){for(var r=0,e=0,n=t.length,o=0;o<n;o++)r+=t[o]*t[o],e+=t[o];if(e<0)throw new RangeError("sum of values is negative");return r/e},r.median=function(t,r){void 0===r&&(r=!1),r||(t=[].concat(t).sort(n));var e=t.length,o=Math.floor(e/2);return e%2==0?.5*(t[o-1]+t[o]):t[o]},r.variance=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=0,i=t.length,a=0;a<i;a++){var s=t[a]-n;o+=s*s}return e?o/(i-1):o/i},r.standardDeviation=function(t,e){return Math.sqrt(r.variance(t,e))},r.standardError=function(t){return r.standardDeviation(t)/Math.sqrt(t.length)},r.robustMeanAndStdev=function(t){var r=0,e=t.length,o=0;for(o=0;o<e;o++)r+=t[o];r/=e;var i=new Array(e);for(o=0;o<e;o++)i[o]=Math.abs(t[o]-r);return i.sort(n),{mean:r,stdev:e%2==1?i[(e-1)/2]/.6745:.5*(i[e/2]+i[e/2-1])/.6745}},r.quartiles=function(t,e){void 0===e&&(e=!1),e||(t=[].concat(t).sort(n));var o=t.length/4;return{q1:t[Math.ceil(o)-1],q2:r.median(t,!0),q3:t[Math.ceil(3*o)-1]}},r.pooledStandardDeviation=function(t,e){return Math.sqrt(r.pooledVariance(t,e))},r.pooledVariance=function(t,e){void 0===e&&(e=!0);for(var n=0,o=0,i=t.length,a=0;a<i;a++){var s=t[a],h=r.variance(s);n+=(s.length-1)*h,o+=e?s.length-1:s.length}return n/o},r.mode=function(t){var r,e=t.length,n=new Array(e);for(r=0;r<e;r++)n[r]=0;var o=new Array(e),i=0;for(r=0;r<e;r++){var a=o.indexOf(t[r]);a>=0?n[a]++:(o[i]=t[r],n[i]=1,i++)}var s=0,h=0;for(r=0;r<i;r++)n[r]>s&&(s=n[r],h=r);return o[h]},r.covariance=function(t,e,n){void 0===n&&(n=!0);var o=r.mean(t),i=r.mean(e);if(t.length!==e.length)throw"Vectors do not have the same dimensions";for(var a=0,s=t.length,h=0;h<s;h++){a+=(t[h]-o)*(e[h]-i)}return n?a/(s-1):a/s},r.skewness=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=0,i=0,a=t.length,s=0;s<a;s++){var h=t[s]-n;o+=h*h,i+=h*h*h}var u=o/a,l=i/a/Math.pow(u,1.5);return e?Math.sqrt(a*(a-1))/(a-2)*l:l},r.kurtosis=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=t.length,i=0,a=0,s=0;s<o;s++){var h=t[s]-n;i+=h*h,a+=h*h*h*h}var u=i/o;if(e){var l=i/(o-1);return o*(o+1)/((o-1)*(o-2)*(o-3))*(a/(l*l))-3*((o-1)*(o-1)/((o-2)*(o-3)))}return a/o/(u*u)-3},r.entropy=function(t,r){void 0===r&&(r=0);for(var e=0,n=t.length,o=0;o<n;o++)e+=t[o]*Math.log(t[o]+r);return-e},r.weightedMean=function(t,r){for(var e=0,n=t.length,o=0;o<n;o++)e+=t[o]*r[o];return e},r.weightedStandardDeviation=function(t,e){return Math.sqrt(r.weightedVariance(t,e))},r.weightedVariance=function(t,e){for(var n=r.weightedMean(t,e),o=0,i=t.length,a=0,s=0,h=0;h<i;h++){var u=t[h]-n,l=e[h];o+=l*(u*u),s+=l,a+=l*l}return o*(s/(s*s-a))},r.center=function(t,e){void 0===e&&(e=!1);var n=t;e||(n=[].concat(t));for(var o=r.mean(n),i=n.length,a=0;a<i;a++)n[a]-=o},r.standardize=function(t,e,n){void 0===e&&(e=r.standardDeviation(t)),void 0===n&&(n=!1);for(var o=t.length,i=n?t:new Array(o),a=0;a<o;a++)i[a]=t[a]/e;return i},r.cumulativeSum=function(t){var r=t.length,e=new Array(r);e[0]=t[0];for(var n=1;n<r;n++)e[n]=e[n-1]+t[n];return e}},function(t,r,e){"use strict";var n=e(18),o=n.Matrix.algebra,i=e(2);function a(t,r,e){var n,o,a,s,h=r.length/3,u=t.rows,l=i.zeros(t.length,1);for(o=0;o<h;o++)for(s=Math.pow(r[o+2*h][0]/2,2),n=r[o+h][0]*s,a=0;a<u;a++)l[a][0]+=n/(Math.pow(t[a][0]-r[o][0],2)+s);return l}function s(t,r,e){for(var n=r[1][0]*Math.pow(r[2][0]/2,2),o=t.rows,a=new i(t.rows,t.columns),s=0;s<o;s++)a[s][0]=n/(Math.pow(t[s][0]-r[0][0],2)+Math.pow(r[2][0]/2,2));return a}function h(t,r,e){for(var n=r[2][0]*r[2][0]/2,o=t.rows,a=new i(t.rows,t.columns),s=0;s<o;s++)a[s][0]=r[1][0]*Math.exp(-(t[s][0]-r[0][0])*(t[s][0]-r[0][0])/n);return a}function u(t,r,e){var o=f(t,(e=e||{}).percentage||0);if(null===o||o[0].rows<3)return null;var a=o[0],h=o[1],u=o[2],l=[a.rows/Math.sqrt(h.dot(h))],c=(e=Object.create(e.LMOptions||[3,100,.001,.001,.001,.01,.01,11,9,1]),Math.abs(a[0][0]-a[1][0])),m=new i([[-c/1e4],[-.001],[-c/1e4]]),w=new i([[r.x],[1],[r.width]]),g=new i([[r.x-c],[.75],[r.width/4]]),v=new i([[r.x+c],[1.25],[4*r.width]]),d=n.optimize(s,w,a,h,l,m,g,v,[],e);return[(d=d.p)[0],[d[1][0]*u],d[2]]}function l(t,r,e){var o=f(t,(e=e||{}).percentage||0);if(null===o||o[0].rows<3)return null;var a=o[0],s=o[1],u=o[2],l=[a.rows/Math.sqrt(s.dot(s))],c=(e=Object.create(e.LMOptions||[3,100,.001,.001,.001,.01,.01,11,9,1]),Math.abs(a[0][0]-a[1][0])),m=new i([[-c/1e4],[-.001],[-c/1e4]]),w=(m=new i([[-Math.abs(a[0][0]-a[1][0])/1e3],[-.001],[-r.width/1e3]]),new i([[r.x],[1],[r.width]])),g=new i([[r.x-c],[.75],[r.width/4]]),v=new i([[r.x+c],[1.25],[4*r.width]]),d=n.optimize(h,w,a,s,l,m,g,v,[],e);return[(d=d.p)[0],[d[1][0]*u],d[2]]}function f(t,r){var e,n,o,a=t.length,s=null,h=null,u=0;if(2==a){var l=t[0].length;if(s=new Array(l),h=new Array(l),e=t[0],n=t[1],"number"==typeof e[0])for(o=0;o<l;o++)s[o]=e[o],h[o]=n[o],n[o]>u&&(u=n[o]);else if("object"==typeof e[0])for(o=0;o<l;o++)s[o]=e[o][0],h[o]=n[o][0],n[o][0]>u&&(u=n[o][0])}else{l=a;for(s=new Array(l),h=new Array(l),o=0;o<l;o++)s[o]=t[o][0],h[o]=t[o][1],h[o]>u&&(u=h[o])}for(o=0;o<l;o++)h[o]/=u;if(r)for(o=l-1;o>=0;o--)h[o]<r&&(h.splice(o,1),s.splice(o,1));return s.length>0?[new i([s]).transpose(),new i([h]).transpose(),u]:null}t.exports.optimizeSingleLorentzian=u,t.exports.optimizeLorentzianSum=function(t,r,e){var s=f(t);if(null===s||s[0].rows<3)return null;var h,u=s[0],l=s[1],c=s[2],m=[u.rows/o.sqrt(l.dot(l))],w=(e=Object.create(e||[3,100,.001,.001,.001,.01,.01,11,9,1]),r.length),g=new i(3*w,1),v=new i(3*w,1),d=new i(3*w,1),p=new i(3*w,1),M=Math.abs(u[0][0]-u[1][0]);for(h=0;h<w;h++)g[h][0]=r[h].x,g[h+w][0]=1,g[h+2*w][0]=r[h].width,v[h][0]=r[h].x-M,v[h+w][0]=0,v[h+2*w][0]=r[h].width/4,d[h][0]=r[h].x+M,d[h+w][0]=1.5,d[h+2*w][0]=4*r[h].width,p[h][0]=-M/1e3,p[h+w][0]=-.001,p[h+2*w][0]=-M/1e3;p=-Math.abs(u[0][0]-u[1][0])/1e4;var x=n.optimize(a,g,u,l,m,p,v,d,[],e);x=x.p;var y=new Array(w);for(h=0;h<w;h++)y[h]=[x[h],[x[h+w][0]*c],x[h+2*w]];return y},t.exports.optimizeSingleGaussian=l,t.exports.optimizeGaussianSum=function(t,r,e){var s=f(t);if(null===s||s[0].rows<3)return null;var h,u=s[0],l=s[1],c=s[2],m=u.rows,w=new i(m,1),g=m/o.sqrt(l.dot(l));for(h=0;h<m;h++)w[h][0]=g;e=Object.create(e||[3,100,.001,.001,.001,.01,.01,11,9,2]);var v=r.length,d=new i(3*v,1),p=new i(3*v,1),M=new i(3*v,1),x=new i(3*v,1),y=Math.abs(u[0][0]-u[1][0]);for(h=0;h<v;h++)d[h][0]=r[h].x,d[h+v][0]=r[h].y/c,d[h+2*v][0]=r[h].width,p[h][0]=r[h].x-y,p[h+v][0]=.8*r[h].y/c,p[h+2*v][0]=r[h].width/2,M[h][0]=r[h].x+y,M[h+v][0]=1.2*r[h].y/c,M[h+2*v][0]=2*r[h].width,x[h][0]=-y/1e3,x[h+v][0]=-.001,x[h+2*v][0]=-y/1e3;var b=n.optimize(a,d,u,l,w,x,p,M,[],e);b=b.p;var A=new Array(v);for(h=0;h<v;h++)A[h]=[b[h],[b[h+v][0]*c],b[h+2*v]];return A},t.exports.singleGaussian=h,t.exports.singleLorentzian=s,t.exports.optimizeGaussianTrain=function(t,r,e){var n=f(t);if(null===n||n[0].rows<3)return null;for(var o,i,a,s,h=n[0],u=n[1],c=n[2],m=0,w=h.length,g=[],v=0;v<r.length;v++){for(o=r[v].x-1.5*r[v].width;h[m++]<o&&m<w;);for(o=r[v].x+1.5*r[v].width,i=[],a=[];h[m]<=o&&m<w;)i.push(h[m][0]),a.push(u[m][0]*c),m++;(s=l([i,a],r[v],e))?g.push({x:s[0][0],y:s[1][0],width:s[2][0],opt:!0}):g.push({x:r[v].x,y:r[v].y,width:r[v].width,opt:!1})}return g},t.exports.optimizeLorentzianTrain=function(t,r,e){var n=f(t);if(null===n||n[0].rows<3)return null;for(var o,i,a,s,h=n[0],l=n[1],c=n[2],m=0,w=h.length,g=[],v=0;v<r.length;v++){for(o=r[v].x-1.5*r[v].width;h[m++]<o&&m<w;);for(o=r[v].x+1.5*r[v].width,i=[],a=[];h[m]<=o&&m<w;)i.push(h[m][0]),a.push(l[m][0]*c),m++;(s=u([i,a],r[v],e))?g.push({x:s[0][0],y:s[1][0],width:s[2][0],opt:!0}):g.push({x:r[v].x,y:r[v].y,width:r[v].width,opt:!1})}return g}},function(module,exports,__webpack_require__){"use strict";module.exports=abstractMatrix;var LuDecomposition=__webpack_require__(9),SvDecomposition=__webpack_require__(10),arrayUtils=__webpack_require__(21),util=__webpack_require__(3),MatrixTransposeView=__webpack_require__(25),MatrixRowView=__webpack_require__(26),MatrixSubView=__webpack_require__(27),MatrixSelectionView=__webpack_require__(28),MatrixColumnView=__webpack_require__(29),MatrixFlipRowView=__webpack_require__(30),MatrixFlipColumnView=__webpack_require__(31);function abstractMatrix(superCtor){void 0===superCtor&&(superCtor=Object);class Matrix extends superCtor{static get[Symbol.species](){return this}static from1DArray(t,r,e){if(t*r!==e.length)throw new RangeError("Data length does not match given dimensions");for(var n=new this(t,r),o=0;o<t;o++)for(var i=0;i<r;i++)n.set(o,i,e[o*r+i]);return n}static rowVector(t){for(var r=new this(1,t.length),e=0;e<t.length;e++)r.set(0,e,t[e]);return r}static columnVector(t){for(var r=new this(t.length,1),e=0;e<t.length;e++)r.set(e,0,t[e]);return r}static empty(t,r){return new this(t,r)}static zeros(t,r){return this.empty(t,r).fill(0)}static ones(t,r){return this.empty(t,r).fill(1)}static rand(t,r,e){void 0===e&&(e=Math.random);for(var n=this.empty(t,r),o=0;o<t;o++)for(var i=0;i<r;i++)n.set(o,i,e());return n}static randInt(t,r,e,n){void 0===e&&(e=1e3),void 0===n&&(n=Math.random);for(var o=this.empty(t,r),i=0;i<t;i++)for(var a=0;a<r;a++){var s=Math.floor(n()*e);o.set(i,a,s)}return o}static eye(t,r,e){void 0===r&&(r=t),void 0===e&&(e=1);for(var n=Math.min(t,r),o=this.zeros(t,r),i=0;i<n;i++)o.set(i,i,e);return o}static diag(t,r,e){var n=t.length;void 0===r&&(r=n),void 0===e&&(e=r);for(var o=Math.min(n,r,e),i=this.zeros(r,e),a=0;a<o;a++)i.set(a,a,t[a]);return i}static min(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,n=t.columns,o=new this(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)o.set(i,a,Math.min(t.get(i,a),r.get(i,a)));return o}static max(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,n=t.columns,o=new this(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)o.set(i,a,Math.max(t.get(i,a),r.get(i,a)));return o}static checkMatrix(t){return Matrix.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var r=this.rows,e=this.columns,n=0;n<r;n++)for(var o=0;o<e;o++)t.call(this,n,o);return this}to1DArray(){for(var t=new Array(this.size),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t[r*this.columns+e]=this.get(r,e);return t}to2DArray(){for(var t=new Array(this.rows),r=0;r<this.rows;r++){t[r]=new Array(this.columns);for(var e=0;e<this.columns;e++)t[r][e]=this.get(r,e)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var r=0;r<=t;r++)if(this.get(t,r)!==this.get(r,t))return!1;return!0}return!1}set(t,r,e){throw new Error("set method is unimplemented")}get(t,r){throw new Error("get method is unimplemented")}repeat(t,r){t=t||1,r=r||1;for(var e=new this.constructor[Symbol.species](this.rows*t,this.columns*r),n=0;n<t;n++)for(var o=0;o<r;o++)e.setSubMatrix(this,this.rows*n,this.columns*o);return e}fill(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,t);return this}neg(){return this.mulS(-1)}getRow(t){util.checkRowIndex(this,t);for(var r=new Array(this.columns),e=0;e<this.columns;e++)r[e]=this.get(t,e);return r}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,r){util.checkRowIndex(this,t),r=util.checkRowVector(this,r);for(var e=0;e<this.columns;e++)this.set(t,e,r[e]);return this}swapRows(t,r){util.checkRowIndex(this,t),util.checkRowIndex(this,r);for(var e=0;e<this.columns;e++){var n=this.get(t,e);this.set(t,e,this.get(r,e)),this.set(r,e,n)}return this}getColumn(t){util.checkColumnIndex(this,t);for(var r=new Array(this.rows),e=0;e<this.rows;e++)r[e]=this.get(e,t);return r}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,r){util.checkColumnIndex(this,t),r=util.checkColumnVector(this,r);for(var e=0;e<this.rows;e++)this.set(e,t,r[e]);return this}swapColumns(t,r){util.checkColumnIndex(this,t),util.checkColumnIndex(this,r);for(var e=0;e<this.rows;e++){var n=this.get(e,t);this.set(e,t,this.get(e,r)),this.set(e,r,n)}return this}addRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[e]);return this}subRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[e]);return this}mulRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[e]);return this}divRowVector(t){t=util.checkRowVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[e]);return this}addColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[r]);return this}subColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[r]);return this}mulColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[r]);return this}divColumnVector(t){t=util.checkColumnVector(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[r]);return this}mulRow(t,r){util.checkRowIndex(this,t);for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r);return this}mulColumn(t,r){util.checkColumnIndex(this,t);for(var e=0;e<this.rows;e++)this.set(e,t,this.get(e,t)*r);return this}max(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}maxIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n),r[0]=e,r[1]=n);return r}min(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}minIndex(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n),r[0]=e,r[1]=n);return r}maxRow(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)>r&&(r=this.get(t,e));return r}maxRowIndex(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=[t,0],n=1;n<this.columns;n++)this.get(t,n)>r&&(r=this.get(t,n),e[1]=n);return e}minRow(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)<r&&(r=this.get(t,e));return r}minRowIndex(t){util.checkRowIndex(this,t);for(var r=this.get(t,0),e=[t,0],n=1;n<this.columns;n++)this.get(t,n)<r&&(r=this.get(t,n),e[1]=n);return e}maxColumn(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)>r&&(r=this.get(e,t));return r}maxColumnIndex(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=[0,t],n=1;n<this.rows;n++)this.get(n,t)>r&&(r=this.get(n,t),e[0]=n);return e}minColumn(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)<r&&(r=this.get(e,t));return r}minColumnIndex(t){util.checkColumnIndex(this,t);for(var r=this.get(0,t),e=[0,t],n=1;n<this.rows;n++)this.get(n,t)<r&&(r=this.get(n,t),e[0]=n);return e}diag(){for(var t=Math.min(this.rows,this.columns),r=new Array(t),e=0;e<t;e++)r[e]=this.get(e,e);return r}sum(t){switch(t){case"row":return util.sumByRow(this);case"column":return util.sumByColumn(this);default:return util.sumAll(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t*=this.get(r,e);return t}cumulativeSum(){for(var t=0,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t+=this.get(r,e),this.set(r,e,t);return this}dot(t){Matrix.isMatrix(t)&&(t=t.to1DArray());var r=this.to1DArray();if(r.length!==t.length)throw new RangeError("vectors do not have the same size");for(var e=0,n=0;n<r.length;n++)e+=r[n]*t[n];return e}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var r=this.rows,e=this.columns,n=t.columns,o=new this.constructor[Symbol.species](r,n),i=new Array(e),a=0;a<n;a++){for(var s=0;s<e;s++)i[s]=t.get(s,a);for(var h=0;h<r;h++){var u=0;for(s=0;s<e;s++)u+=this.get(h,s)*i[s];o.set(h,a,u)}}return o}strassen2x2(t){var r=new this.constructor[Symbol.species](2,2);const e=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),a=this.get(1,0),s=t.get(1,0),h=this.get(1,1),u=t.get(1,1),l=(e+h)*(n+u),f=(a+h)*n,c=e*(i-u),m=h*(s-n),w=(e+o)*u,g=l+m-w+(o-h)*(s+u),v=c+w,d=f+m,p=l-f+c+(a-e)*(n+i);return r.set(0,0,g),r.set(0,1,v),r.set(1,0,d),r.set(1,1,p),r}strassen3x3(t){var r=new this.constructor[Symbol.species](3,3);const e=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),h=this.get(2,0),u=this.get(2,1),l=this.get(2,2),f=t.get(0,0),c=t.get(0,1),m=t.get(0,2),w=t.get(1,0),g=t.get(1,1),v=t.get(1,2),d=t.get(2,0),p=t.get(2,1),M=t.get(2,2),x=(e-i)*(-c+g),y=(-e+i+a)*(f-c+g),b=(i+a)*(-f+c),A=e*f,S=(-e+h+u)*(f-m+v),k=(-e+h)*(m-v),R=(h+u)*(-f+m),_=(-o+u+l)*(g+d-p),V=(o-l)*(g-p),z=o*d,C=(u+l)*(-d+p),E=(-o+a+s)*(v+d-M),j=(o-s)*(v-M),I=(a+s)*(-d+M),q=A+z+n*w,D=(e+n+o-i-a-u-l)*g+y+b+A+_+z+C,O=A+S+R+(e+n+o-a-s-h-u)*v+z+E+I,W=x+a*(-f+c+w-g-v-d+M)+y+A+z+E+j,T=x+y+b+A+s*p,L=z+E+j+I+i*m,F=A+S+k+u*(-f+m+w-g-v-d+p)+_+V+z,N=_+V+z+C+h*c,P=A+S+k+R+l*M;return r.set(0,0,q),r.set(0,1,D),r.set(0,2,O),r.set(1,0,W),r.set(1,1,T),r.set(1,2,L),r.set(2,0,F),r.set(2,1,N),r.set(2,2,P),r}mmulStrassen(t){var r=this.clone(),e=r.rows,n=r.columns,o=t.rows,i=t.columns;function a(t,r,e){var n=t.rows,o=t.columns;if(n===r&&o===e)return t;var i=Matrix.zeros(r,e);return i=i.setSubMatrix(t,0,0)}n!==o&&console.warn("Multiplying ".concat(e," x ").concat(n," and ").concat(o," x ").concat(i," matrix: dimensions do not match."));var s=Math.max(e,o),h=Math.max(n,i);return function t(r,e,n,o){if(n<=512||o<=512)return r.mmul(e);n%2==1&&o%2==1?(r=a(r,n+1,o+1),e=a(e,n+1,o+1)):n%2==1?(r=a(r,n+1,o),e=a(e,n+1,o)):o%2==1&&(r=a(r,n,o+1),e=a(e,n,o+1));var i=parseInt(r.rows/2),s=parseInt(r.columns/2),h=r.subMatrix(0,i-1,0,s-1),u=e.subMatrix(0,i-1,0,s-1),l=r.subMatrix(0,i-1,s,r.columns-1),f=e.subMatrix(0,i-1,s,e.columns-1),c=r.subMatrix(i,r.rows-1,0,s-1),m=e.subMatrix(i,e.rows-1,0,s-1),w=r.subMatrix(i,r.rows-1,s,r.columns-1),g=e.subMatrix(i,e.rows-1,s,e.columns-1),v=t(Matrix.add(h,w),Matrix.add(u,g),i,s),d=t(Matrix.add(c,w),u,i,s),p=t(h,Matrix.sub(f,g),i,s),M=t(w,Matrix.sub(m,u),i,s),x=t(Matrix.add(h,l),g,i,s),y=t(Matrix.sub(c,h),Matrix.add(u,f),i,s),b=t(Matrix.sub(l,w),Matrix.add(m,g),i,s),A=Matrix.add(v,M);A.sub(x),A.add(b);var S=Matrix.add(p,x),k=Matrix.add(d,M),R=Matrix.sub(v,d);R.add(p),R.add(y);var _=Matrix.zeros(2*A.rows,2*A.columns);return(_=(_=(_=(_=_.setSubMatrix(A,0,0)).setSubMatrix(S,A.rows,0)).setSubMatrix(k,0,A.columns)).setSubMatrix(R,A.rows,A.columns)).subMatrix(0,n-1,0,o-1)}(r=a(r,s,h),t=a(t,s,h),s,h)}scaleRows(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),n=0;n<this.rows;n++){var o=arrayUtils.scale(this.getRow(n),{min:t,max:r});e.setRow(n,o)}return e}scaleColumns(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),n=0;n<this.columns;n++){var o=arrayUtils.scale(this.getColumn(n),{min:t,max:r});e.setColumn(n,o)}return e}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var r=this.rows,e=this.columns,n=t.rows,o=t.columns,i=new this.constructor[Symbol.species](r*n,e*o),a=0;a<r;a++)for(var s=0;s<e;s++)for(var h=0;h<n;h++)for(var u=0;u<o;u++)i[n*a+h][o*s+u]=this.get(a,s)*t.get(h,u);return i}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(e,r,this.get(r,e));return t}sortRows(t){void 0===t&&(t=compareNumbers);for(var r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(t));return this}sortColumns(t){void 0===t&&(t=compareNumbers);for(var r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(t));return this}subMatrix(t,r,e,n){util.checkRange(this,t,r,e,n);for(var o=new this.constructor[Symbol.species](r-t+1,n-e+1),i=t;i<=r;i++)for(var a=e;a<=n;a++)o[i-t][a-e]=this.get(i,a);return o}subMatrixRow(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.columns-1),r>e||r<0||r>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](t.length,e-r+1),o=0;o<t.length;o++)for(var i=r;i<=e;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError("Row index out of range: "+t[o]);n.set(o,i-r,this.get(t[o],i))}return n}subMatrixColumn(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.rows-1),r>e||r<0||r>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](e-r+1,t.length),o=0;o<t.length;o++)for(var i=r;i<=e;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError("Column index out of range: "+t[o]);n.set(i-r,o,this.get(i,t[o]))}return n}setSubMatrix(t,r,e){var n=r+(t=this.constructor.checkMatrix(t)).rows-1,o=e+t.columns-1;util.checkRange(this,r,n,e,o);for(var i=0;i<t.rows;i++)for(var a=0;a<t.columns;a++)this[r+i][e+a]=t.get(i,a);return this}selection(t,r){for(var e=util.checkIndices(this,t,r),n=new this.constructor[Symbol.species](t.length,r.length),o=0;o<e.row.length;o++)for(var i=e.row[o],a=0;a<e.column.length;a++){var s=e.column[a];n[o][a]=this.get(i,s)}return n}trace(){for(var t=Math.min(this.rows,this.columns),r=0,e=0;e<t;e++)r+=this.get(e,e);return r}transposeView(){return new MatrixTransposeView(this)}rowView(t){return util.checkRowIndex(this,t),new MatrixRowView(this,t)}columnView(t){return util.checkColumnIndex(this,t),new MatrixColumnView(this,t)}flipRowView(){return new MatrixFlipRowView(this)}flipColumnView(){return new MatrixFlipColumnView(this)}subMatrixView(t,r,e,n){return new MatrixSubView(this,t,r,e,n)}selectionView(t,r){return new MatrixSelectionView(this,t,r)}det(){var t,r,e,n,o,i;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),r=this.get(0,1),e=this.get(1,0),t*this.get(1,1)-r*e):3===this.columns?(n=this.selectionView([1,2],[1,2]),o=this.selectionView([1,2],[0,2]),i=this.selectionView([1,2],[0,1]),t=this.get(0,0),r=this.get(0,1),e=this.get(0,2),t*n.det()-r*o.det()+e*i.det()):new LuDecomposition(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var r=new SvDecomposition(this,{autoTranspose:!0}),e=r.leftSingularVectors,n=r.rightSingularVectors,o=r.diagonal,i=0;i<o.length;i++)Math.abs(o[i])>t?o[i]=1/o[i]:o[i]=0;return o=this.constructor[Symbol.species].diag(o),n.mmul(o.mmul(e.transposeView()))}}function checkDimensions(t,r){if(t.rows!==r.rows||t.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal")}function compareNumbers(t,r){return t-r}Matrix.prototype.klass="Matrix",Matrix.random=Matrix.rand,Matrix.diagonal=Matrix.diag,Matrix.prototype.diagonal=Matrix.prototype.diag,Matrix.identity=Matrix.eye,Matrix.prototype.negate=Matrix.prototype.neg,Matrix.prototype.tensorProduct=Matrix.prototype.kroneckerProduct,Matrix.prototype.determinant=Matrix.prototype.det;var inplaceOperator="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",inplaceOperatorScalar="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",inplaceOperatorMatrix="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",staticOperator="\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",inplaceMethod="\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",staticMethod="\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",inplaceMethodWithArgs="\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",staticMethodWithArgs="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",inplaceMethodWithOneArgScalar="\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",inplaceMethodWithOneArgMatrix="\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    checkDimensions(this, matrix);\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",inplaceMethodWithOneArg="\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",staticMethodWithOneArg=staticMethodWithArgs,operators=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]],i;for(var operator of operators){var inplaceOp=eval(fillTemplateFunction(inplaceOperator,{name:operator[1],op:operator[0]})),inplaceOpS=eval(fillTemplateFunction(inplaceOperatorScalar,{name:operator[1]+"S",op:operator[0]})),inplaceOpM=eval(fillTemplateFunction(inplaceOperatorMatrix,{name:operator[1]+"M",op:operator[0]})),staticOp=eval(fillTemplateFunction(staticOperator,{name:operator[1]}));for(i=1;i<operator.length;i++)Matrix.prototype[operator[i]]=inplaceOp,Matrix.prototype[operator[i]+"S"]=inplaceOpS,Matrix.prototype[operator[i]+"M"]=inplaceOpM,Matrix[operator[i]]=staticOp}var methods=[["~","not"]];for(var method of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach((function(t){methods.push(["Math."+t,t])})),methods)){var inplaceMeth=eval(fillTemplateFunction(inplaceMethod,{name:method[1],method:method[0]})),staticMeth=eval(fillTemplateFunction(staticMethod,{name:method[1]}));for(i=1;i<method.length;i++)Matrix.prototype[method[i]]=inplaceMeth,Matrix[method[i]]=staticMeth}var methodsWithArgs=[["Math.pow",1,"pow"]];for(var methodWithArg of methodsWithArgs){var args="arg0";for(i=1;i<methodWithArg[1];i++)args+=", arg".concat(i);if(1!==methodWithArg[1]){var inplaceMethWithArgs=eval(fillTemplateFunction(inplaceMethodWithArgs,{name:methodWithArg[2],method:methodWithArg[0],args:args})),staticMethWithArgs=eval(fillTemplateFunction(staticMethodWithArgs,{name:methodWithArg[2],args:args}));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethWithArgs,Matrix[methodWithArg[i]]=staticMethWithArgs}else{var tmplVar={name:methodWithArg[2],args:args,method:methodWithArg[0]},inplaceMethod2=eval(fillTemplateFunction(inplaceMethodWithOneArg,tmplVar)),inplaceMethodS=eval(fillTemplateFunction(inplaceMethodWithOneArgScalar,tmplVar)),inplaceMethodM=eval(fillTemplateFunction(inplaceMethodWithOneArgMatrix,tmplVar)),staticMethod2=eval(fillTemplateFunction(staticMethodWithOneArg,tmplVar));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethod2,Matrix.prototype[methodWithArg[i]+"M"]=inplaceMethodM,Matrix.prototype[methodWithArg[i]+"S"]=inplaceMethodS,Matrix[methodWithArg[i]]=staticMethod2}}function fillTemplateFunction(t,r){for(var e in r)t=t.replace(new RegExp("%"+e+"%","g"),r[e]);return t}return Matrix}},function(t,r,e){"use strict";var n=e(0);function o(t){if(!(this instanceof o))return new o(t);var r,e,i,a,s,h,u,l,f,c,m=(t=n.Matrix.checkMatrix(t)).clone(),w=m.rows,g=m.columns,v=new Array(w),d=1;for(r=0;r<w;r++)v[r]=r;for(f=new Array(w),e=0;e<g;e++){for(r=0;r<w;r++)f[r]=m[r][e];for(r=0;r<w;r++){for(l=m[r],c=Math.min(r,e),s=0,i=0;i<c;i++)s+=l[i]*f[i];l[e]=f[r]-=s}for(a=e,r=e+1;r<w;r++)Math.abs(f[r])>Math.abs(f[a])&&(a=r);if(a!==e){for(i=0;i<g;i++)h=m[a][i],m[a][i]=m[e][i],m[e][i]=h;u=v[a],v[a]=v[e],v[e]=u,d=-d}if(e<w&&0!==m[e][e])for(r=e+1;r<w;r++)m[r][e]/=m[e][e]}this.LU=m,this.pivotVector=v,this.pivotSign=d}o.prototype={isSingular:function(){for(var t=this.LU,r=t.columns,e=0;e<r;e++)if(0===t[e][e])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,e=t.columns,n=0;n<e;n++)r*=t[n][n];return r},get lowerTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,o=new n.Matrix(r,e),i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=i>a?t[i][a]:i===a?1:0;return o},get upperTriangularMatrix(){for(var t=this.LU,r=t.rows,e=t.columns,o=new n.Matrix(r,e),i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=i<=a?t[i][a]:0;return o},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=n.Matrix.checkMatrix(t);var r=this.LU;if(r.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var e,o,i,a=t.columns,s=t.subMatrixRow(this.pivotVector,0,a-1),h=r.columns;for(i=0;i<h;i++)for(e=i+1;e<h;e++)for(o=0;o<a;o++)s[e][o]-=s[i][o]*r[e][i];for(i=h-1;i>=0;i--){for(o=0;o<a;o++)s[i][o]/=r[i][i];for(e=0;e<i;e++)for(o=0;o<a;o++)s[e][o]-=s[i][o]*r[e][i]}return s}},t.exports=o},function(t,r,e){"use strict";var n=e(0),o=e(5),i=o.hypotenuse,a=o.getFilled2DArray;function s(t,r){if(!(this instanceof s))return new s(t,r);r=r||{};var e=(t=n.Matrix.checkMatrix(t)).rows,o=t.columns,h=Math.min(e,o),u=!0,l=!0;!1===r.computeLeftSingularVectors&&(u=!1),!1===r.computeRightSingularVectors&&(l=!1);var f,c=!0===r.autoTranspose,m=!1;if(e<o)if(c){e=(f=t.transpose()).rows,o=f.columns,m=!0;var w=u;u=l,l=w}else f=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else f=t.clone();var g,v,d,p,M,x,y,b,A,S,k,R,_,V,z,C,E,j,I,q,D,O=new Array(Math.min(e+1,o)),W=a(e,h,0),T=a(o,o,0),L=new Array(o),F=new Array(e),N=Math.min(e-1,o),P=Math.max(0,Math.min(o-2,e));for(d=0,S=Math.max(N,P);d<S;d++){if(d<N){for(O[d]=0,g=d;g<e;g++)O[d]=i(O[d],f[g][d]);if(0!==O[d]){for(f[d][d]<0&&(O[d]=-O[d]),g=d;g<e;g++)f[g][d]/=O[d];f[d][d]+=1}O[d]=-O[d]}for(v=d+1;v<o;v++){if(d<N&&0!==O[d]){for(M=0,g=d;g<e;g++)M+=f[g][d]*f[g][v];for(M=-M/f[d][d],g=d;g<e;g++)f[g][v]+=M*f[g][d]}L[v]=f[d][v]}if(u&&d<N)for(g=d;g<e;g++)W[g][d]=f[g][d];if(d<P){for(L[d]=0,g=d+1;g<o;g++)L[d]=i(L[d],L[g]);if(0!==L[d]){for(L[d+1]<0&&(L[d]=0-L[d]),g=d+1;g<o;g++)L[g]/=L[d];L[d+1]+=1}if(L[d]=-L[d],d+1<e&&0!==L[d]){for(g=d+1;g<e;g++)F[g]=0;for(v=d+1;v<o;v++)for(g=d+1;g<e;g++)F[g]+=L[v]*f[g][v];for(v=d+1;v<o;v++)for(M=-L[v]/L[d+1],g=d+1;g<e;g++)f[g][v]+=M*F[g]}if(l)for(g=d+1;g<o;g++)T[g][d]=L[g]}}if(p=Math.min(o,e+1),N<o&&(O[N]=f[N][N]),e<p&&(O[p-1]=0),P+1<p&&(L[P]=f[P][p-1]),L[p-1]=0,u){for(v=N;v<h;v++){for(g=0;g<e;g++)W[g][v]=0;W[v][v]=1}for(d=N-1;d>=0;d--)if(0!==O[d]){for(v=d+1;v<h;v++){for(M=0,g=d;g<e;g++)M+=W[g][d]*W[g][v];for(M=-M/W[d][d],g=d;g<e;g++)W[g][v]+=M*W[g][d]}for(g=d;g<e;g++)W[g][d]=-W[g][d];for(W[d][d]=1+W[d][d],g=0;g<d-1;g++)W[g][d]=0}else{for(g=0;g<e;g++)W[g][d]=0;W[d][d]=1}}if(l)for(d=o-1;d>=0;d--){if(d<P&&0!==L[d])for(v=d+1;v<o;v++){for(M=0,g=d+1;g<o;g++)M+=T[g][d]*T[g][v];for(M=-M/T[d+1][d],g=d+1;g<o;g++)T[g][v]+=M*T[g][d]}for(g=0;g<o;g++)T[g][d]=0;T[d][d]=1}for(var U=p-1,J=Math.pow(2,-52);p>0;){for(d=p-2;d>=-1&&-1!==d;d--)if(Math.abs(L[d])<=J*(Math.abs(O[d])+Math.abs(O[d+1]))){L[d]=0;break}if(d===p-2)k=4;else{for(x=p-1;x>=d&&x!==d;x--)if(M=(x!==p?Math.abs(L[x]):0)+(x!==d+1?Math.abs(L[x-1]):0),Math.abs(O[x])<=J*M){O[x]=0;break}x===d?k=3:x===p-1?k=1:(k=2,d=x)}switch(d++,k){case 1:for(y=L[p-2],L[p-2]=0,v=p-2;v>=d;v--)if(M=i(O[v],y),b=O[v]/M,A=y/M,O[v]=M,v!==d&&(y=-A*L[v-1],L[v-1]=b*L[v-1]),l)for(g=0;g<o;g++)M=b*T[g][v]+A*T[g][p-1],T[g][p-1]=-A*T[g][v]+b*T[g][p-1],T[g][v]=M;break;case 2:for(y=L[d-1],L[d-1]=0,v=d;v<p;v++)if(M=i(O[v],y),b=O[v]/M,A=y/M,O[v]=M,y=-A*L[v],L[v]=b*L[v],u)for(g=0;g<e;g++)M=b*W[g][v]+A*W[g][d-1],W[g][d-1]=-A*W[g][v]+b*W[g][d-1],W[g][v]=M;break;case 3:for(R=Math.max(Math.max(Math.max(Math.max(Math.abs(O[p-1]),Math.abs(O[p-2])),Math.abs(L[p-2])),Math.abs(O[d])),Math.abs(L[d])),_=O[p-1]/R,V=O[p-2]/R,z=L[p-2]/R,C=O[d]/R,E=L[d]/R,I=_*z*(_*z),q=0,0===(j=((V+_)*(V-_)+z*z)/2)&&0===I||(q=Math.sqrt(j*j+I),j<0&&(q=-q),q=I/(j+q)),y=(C+_)*(C-_)+q,D=C*E,v=d;v<p-1;v++){if(b=y/(M=i(y,D)),A=D/M,v!==d&&(L[v-1]=M),y=b*O[v]+A*L[v],L[v]=b*L[v]-A*O[v],D=A*O[v+1],O[v+1]=b*O[v+1],l)for(g=0;g<o;g++)M=b*T[g][v]+A*T[g][v+1],T[g][v+1]=-A*T[g][v]+b*T[g][v+1],T[g][v]=M;if(b=y/(M=i(y,D)),A=D/M,O[v]=M,y=b*L[v]+A*O[v+1],O[v+1]=-A*L[v]+b*O[v+1],D=A*L[v+1],L[v+1]=b*L[v+1],u&&v<e-1)for(g=0;g<e;g++)M=b*W[g][v]+A*W[g][v+1],W[g][v+1]=-A*W[g][v]+b*W[g][v+1],W[g][v]=M}L[p-2]=y,1;break;case 4:if(O[d]<=0&&(O[d]=O[d]<0?-O[d]:0,l))for(g=0;g<=U;g++)T[g][d]=-T[g][d];for(;d<U&&!(O[d]>=O[d+1]);){if(M=O[d],O[d]=O[d+1],O[d+1]=M,l&&d<o-1)for(g=0;g<o;g++)M=T[g][d+1],T[g][d+1]=T[g][d],T[g][d]=M;if(u&&d<e-1)for(g=0;g<e;g++)M=W[g][d+1],W[g][d+1]=W[g][d],W[g][d]=M;d++}0,p--}}if(m){var G=T;T=W,W=G}this.m=e,this.n=o,this.s=O,this.U=W,this.V=T}s.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=Math.pow(2,-52),r=Math.max(this.m,this.n)*this.s[0]*t,e=0,n=this.s,o=0,i=n.length;o<i;o++)n[o]>r&&e++;return e},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return n.Matrix.isMatrix(this.U)||(this.U=new n.Matrix(this.U)),this.U},get rightSingularVectors(){return n.Matrix.isMatrix(this.V)||(this.V=new n.Matrix(this.V)),this.V},get diagonalMatrix(){return n.Matrix.diag(this.s)},solve:function(t){var r,e=t,o=this.threshold,i=this.s.length,a=n.Matrix.zeros(i,i);for(r=0;r<i;r++)Math.abs(this.s[r])<=o?a[r][r]=0:a[r][r]=1/this.s[r];var s,h,u,l=this.U,f=this.rightSingularVectors,c=f.mmul(a),m=f.rows,w=l.length,g=n.Matrix.zeros(m,w);for(r=0;r<m;r++)for(s=0;s<w;s++){for(u=0,h=0;h<i;h++)u+=c[r][h]*l[s][h];g[r][s]=u}return g.mmul(e)},solveForDiagonal:function(t){return this.solve(n.Matrix.diag(t))},inverse:function(){var t,r,e=this.V,o=this.threshold,i=e.length,a=e[0].length,s=new n.Matrix(i,this.s.length);for(t=0;t<i;t++)for(r=0;r<a;r++)Math.abs(this.s[r])>o?s[t][r]=e[t][r]/this.s[r]:s[t][r]=0;var h,u,l=this.U,f=l.length,c=l[0].length,m=new n.Matrix(i,f);for(t=0;t<i;t++)for(r=0;r<f;r++){for(u=0,h=0;h<c;h++)u+=s[t][h]*l[r][h];m[t][r]=u}return m}},t.exports=s},function(t,r,e){"use strict";var n=e(2);t.exports={transpose:function(t){return"number"==typeof t?t:t.clone().transpose()},add:function(t,r){return"number"==typeof t&&"number"==typeof r?t+r:"number"==typeof t?this.add(r,t):t.clone().add(r)},subtract:function(t,r){return"number"==typeof t&&"number"==typeof r?t-r:"number"==typeof t?this.subtract(r,t):t.clone().sub(r)},multiply:function(t,r){if("number"==typeof t&&"number"==typeof r)return t*r;if("number"==typeof t)return this.multiply(r,t);var e=t.clone();return"number"==typeof r?e.mul(r):e=e.mmul(r),1==e.rows&&1==e.columns?e[0][0]:e},dotMultiply:function(t,r){return t.clone().mul(r)},dotDivide:function(t,r){return t.clone().div(r)},diag:function(t){var r,e,o=null,i=t.rows,a=t.columns;if(void 0===a&&"object"==typeof t)if(t[0]&&t[0].length)for(i=t.length,a=t[0].length,e=Math.min(i,a),o=n.zeros(a,a),r=0;r<a;r++)o[r][r]=t[r][r];else for(a=t.length,o=n.zeros(a,a),r=0;r<a;r++)o[r][r]=t[r];if(1==i)for(o=n.zeros(a,a),r=0;r<a;r++)o[r][r]=t[0][r];else if(i>0&&a>0)for(e=Math.min(i,a),o=new Array(e),r=0;r<e;r++)o[r]=t[r][r];return o},min:function(t,r){if("number"==typeof t&&"number"==typeof r)return Math.min(t,r);for(var e=t.rows,o=t.columns,i=new n(e,o),a=0;a<e;a++)for(var s=0;s<o;s++)t[a][s]<r[a][s]?i[a][s]=t[a][s]:i[a][s]=r[a][s];return i},max:function(t,r){if("number"==typeof t&&"number"==typeof r)return Math.max(t,r);for(var e=t.rows,o=t.columns,i=new n(e,o),a=0;a<e;a++)for(var s=0;s<o;s++)t[a][s]>r[a][s]?i[a][s]=t[a][s]:i[a][s]=r[a][s];return i},solve:function(t,r){return t.solve(r)},inv:function(t){return"number"==typeof t?1/t:t.inverse()},sqrt:function(t){if("number"==typeof t)return Math.sqrt(t);for(var r=t.rows,e=t.columns,o=new n(r,e),i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=Math.sqrt(t[i][a]);return o},exp:function(t){if("number"==typeof t)return Math.sqrt(t);for(var r=t.rows,e=t.columns,o=new n(r,e),i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=Math.exp(t[i][a]);return o},dotPow:function(t,r){if("number"==typeof t)return Math.pow(t,r);for(var e=t.rows,o=t.columns,i=new n(e,o),a=0;a<e;a++)for(var s=0;s<o;s++)i[a][s]=Math.pow(t[a][s],r);return i},abs:function(t){if("number"==typeof t)return Math.abs(t);for(var r=t.rows,e=t.columns,o=new n(r,e),i=0;i<r;i++)for(var a=0;a<e;a++)o[i][a]=Math.abs(t[i][a]);return o},matrix:function(t,r){return new n(t,r)},ones:function(t,r){return n.ones(t,r)},zeros:function(t,r){return n.zeros(t,r)},random:function(t,r){return n.rand(t,r)},eye:function(t,r){return n.eye(t,r)}}},function(t,r,e){"use strict";t.exports.gsd=e(13),t.exports.post={optimizePeaks:e(17),joinBroadPeaks:e(36),broadenPeaks:e(37)}},function(t,r,e){"use strict";const n=e(14),o={sgOptions:{windowSize:9,polynomial:3},minMaxRatio:25e-5,broadRatio:0,maxCriteria:!0,smoothY:!0,realTopDetection:!1,heightFactor:0,boundaries:!1,derivativeThreshold:-1};t.exports=function(t,r,e){let i=(e=Object.assign({},o,e)).sgOptions;const a=r.slice();let s=0,h=Number.MAX_VALUE;if(!("noiseLevel"in e)){let r;for(let e=0;e<t.length-1;++e)(r=Math.abs(t[e+1]-t[e]))<h&&(h=r),r>s&&(s=r);e.noiseLevel=(s-h)/s<.05?function(t){let r=0,e=0,n=t.length;for(let e=0;e<n;++e)r+=t[e];r/=n;let o=new Array(n);for(let e=0;e<n;++e)o[e]=Math.abs(t[e]-r);o.sort((t,r)=>t-r),e=n%2==1?o[(n-1)/2]/.6745:.5*(o[n/2]+o[n/2-1])/.6745;return e}(a):0}const u={m:1,b:e.noiseLevel};e.maxCriteria||(u.m=-1,u.b*=-1);for(let t=0;t<a.length;t++)a[t]=u.m*a[t]-u.b;for(let t=0;t<a.length;t++)a[t]<0&&(a[t]=0);let l,f,c=a;(s-h)/s<.05?(e.smoothY&&(c=n(a,t[1]-t[0],{windowSize:i.windowSize,polynomial:i.polynomial,derivative:0})),l=n(a,t[1]-t[0],{windowSize:i.windowSize,polynomial:i.polynomial,derivative:1}),f=n(a,t[1]-t[0],{windowSize:i.windowSize,polynomial:i.polynomial,derivative:2})):(e.smoothY&&(c=n(a,t,{windowSize:i.windowSize,polynomial:i.polynomial,derivative:0})),l=n(a,t,{windowSize:i.windowSize,polynomial:i.polynomial,derivative:1}),f=n(a,t,{windowSize:i.windowSize,polynomial:i.polynomial,derivative:2}));const m=t,w=t[1]-t[0];let g=0,v=0;for(let t=0;t<c.length;t++)Math.abs(f[t])>g&&(g=Math.abs(f[t])),Math.abs(c[t])>v&&(v=Math.abs(c[t]));let d=null,p=null,M=new Array(c.length-2),x=new Array(c.length),y=new Array(c.length),b=new Array(c.length-2),A=0,S=0,k=0,R=0;for(let t=1;t<c.length-1;++t)Math.abs(l[t])>e.derivativeThreshold&&((l[t]<l[t-1]&&l[t]<=l[t+1]||l[t]<=l[t-1]&&l[t]<l[t+1])&&(p={x:m[t],index:t},w>0&&null!==d&&(x[S++]=d,y[k++]=p)),(l[t]>=l[t-1]&&l[t]>l[t+1]||l[t]>l[t-1]&&l[t]>=l[t+1])&&(d={x:m[t],index:t},w<0&&null!==p&&(x[S++]=d,y[k++]=p))),f[t]<f[t-1]&&f[t]<f[t+1]&&(M[A++]=t,b[R++]=Math.abs(f[t])<=e.broadRatio*g);M.length=A,x.length=S,y.length=k,b.length=R;let _,V,z,C,E,j=new Array(M.length),I=0,q=-1;for(let t=0;t<M.length;++t){V=m[M[t]],_=-1;let r=q+1;for(C=Number.MAX_VALUE,z=0,E=!0;-1===_&&r<x.length&&E;)(z=Math.abs(V-(x[r].x+y[r].x)/2))<C?C=z:E=!1,z<Math.abs(x[r].x-y[r].x)/2&&(_=r,q=r),++r;if(-1!==_&&Math.abs(c[M[t]])>e.minMaxRatio*v&&(j[I++]={index:M[t],x:V,y:(c[M[t]]+u.b)/u.m,width:Math.abs(y[_].x-x[_].x),soft:b[t]},e.boundaries&&(j[I-1].left=x[_],j[I-1].right=y[_]),e.heightFactor)){let t=c[x[_].index],r=c[y[_].index];j[I-1].height=e.heightFactor*(j[I-1].y-(t+r)/2)}}j.length=I,e.realTopDetection&&function(t,r,e){let n,o,i,a,s;for(let h=0;h<t.length;h++)s=t[h].index,e[s-1]>=e[s-2]&&e[s-1]>=e[s]?s--:e[s+1]>=e[s]&&e[s+1]>=e[s+2]?s++:e[s-2]>=e[s-3]&&e[s-2]>=e[s-1]?s-=2:e[s+2]>=e[s+1]&&e[s+2]>=e[s+3]&&(s+=2),e[s-1]>0&&e[s+1]>0&&e[s]>=e[s-1]&&e[s]>=e[s+1]&&(e[s]!==e[s-1]||e[s]!==e[s+1])&&(n=20*Math.log10(e[s-1]),o=20*Math.log10(e[s]),i=20*Math.log10(e[s+1]),a=.5*(n-i)/(n-2*o+i),t[h].x=r[s]+(r[s]-r[s-1])*a,t[h].y=e[s]-.25*(e[s-1]-e[s+1])*a)}(j,m,c);for(let t=0;t<j.length;t++)j[t].base=e.noiseLevel;return j.sort((function(t,r){return t.x-r.x})),j}},function(t,r,e){var n=e(15),o=(e(4),{windowSize:9,derivative:0,polynomial:3});function i(t,r,e,n){for(var o=0,i=0,a=r-e;a<r+e;a++)a>=0&&a<t.length-1&&(o+=t[a+1]-t[a],i++);return Math.pow(o/i,n)}function a(t,r,e,n){return e>0?(4*e-2)/(e*(2*r-e+1))*(t*a(t,r,e-1,n)+n*a(t,r,e-1,n-1))-(e-1)*(2*r+e)/(e*(2*r-e+1))*a(t,r,e-2,n):0==e&&0==n?1:0}function s(t,r){var e=1;if(t>=r)for(var n=t-r+1;n<=t;n++)e*=n;return e}function h(t,r,e,n,o){for(var i=0,h=0;h<=n;h++)i+=(2*h+1)*(s(2*e,h)/s(2*e+h+1,h+1))*a(t,e,h,0)*a(r,e,h,o);return i}t.exports=function(t,r,e){if((e=n({},o,e)).windowSize%2==0||e.windowSize<5||!Number.isInteger(e.windowSize))throw new RangeError("Invalid window size (should be odd and at least 5 integer number)");if(e.windowSize>t.length)throw new RangeError("Window size is higher than the data length "+e.windowSize+">"+t.length);if(e.derivative<0||!Number.isInteger(e.derivative))throw new RangeError("Derivative should be a positive integer");if(e.polynomial<1||!Number.isInteger(e.polynomial))throw new RangeError("Polynomial should be a positive integer");e.polynomial>=6&&console.warn("You should not use polynomial grade higher than 5 if you are not sure that your data arises from such a model. Possible polynomial oscillation problems");var a=e.windowSize,s=Math.floor(a/2),u=t.length,l=new Array(u),f=function(t,r,e){for(var n=new Array(t),o=Math.floor(t/2),i=-o;i<=o;i++){n[i+o]=new Array(t);for(var a=-o;a<=o;a++)n[i+o][a+o]=h(a,i,o,r,e)}return n}(a,e.polynomial,e.derivative),c=0,m=!0;"[object Array]"===Object.prototype.toString.call(r)?m=!1:c=Math.pow(r,e.derivative);for(var w=0;w<s;w++){for(var g=f[s-w-1],v=f[s+w+1],d=0,p=0,M=0;M<a;M++)d+=g[M]*t[M],p+=v[M]*t[u-a+M-1];m?(l[s-w-1]=d/c,l[u-s+w]=p/c):(c=i(r,s-w-1,s,e.derivative),l[s-w-1]=d/c,c=i(r,u-s+w,s,e.derivative),l[u-s+w]=p/c)}var x=f[s];for(w=a;w<u+1;w++){var y=0;for(M=0;M<a;M++)y+=x[M]*t[M+w-a];m||(c=i(r,w-s-1,s,e.derivative)),l[w-s-1]=y/c}return l}},function(t,r,e){"use strict";var n=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=Object.defineProperty,a=Object.getOwnPropertyDescriptor,s=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===o.call(t)},h=function(t){if(!t||"[object Object]"!==o.call(t))return!1;var r,e=n.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&n.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!i)return!1;for(r in t);return void 0===r||n.call(t,r)},u=function(t,r){i&&"__proto__"===r.name?i(t,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):t[r.name]=r.newValue},l=function(t,r){if("__proto__"===r){if(!n.call(t,r))return;if(a)return a(t,r).value}return t[r]};t.exports=function t(){var r,e,n,o,i,a,f=arguments[0],c=1,m=arguments.length,w=!1;for("boolean"==typeof f&&(w=f,f=arguments[1]||{},c=2),(null==f||"object"!=typeof f&&"function"!=typeof f)&&(f={});c<m;++c)if(null!=(r=arguments[c]))for(e in r)n=l(f,e),f!==(o=l(r,e))&&(w&&o&&(h(o)||(i=s(o)))?(i?(i=!1,a=n&&s(n)?n:[]):a=n&&h(n)?n:{},u(f,{name:e,newValue:t(w,a,o)})):void 0!==o&&u(f,{name:e,newValue:o}));return f}},function(t,r,e){"use strict";var n=e(6);function o(t,r){return t-r}r.max=function(t){for(var r=-1/0,e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)t[e][n]>r&&(r=t[e][n]);return r},r.min=function(t){for(var r=1/0,e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++)t[e][n]<r&&(r=t[e][n]);return r},r.minMax=function(t){for(var r=1/0,e=-1/0,n=0;n<t.length;n++)for(var o=0;o<t[n].length;o++)t[n][o]<r&&(r=t[n][o]),t[n][o]>e&&(e=t[n][o]);return{min:r,max:e}},r.entropy=function(t,r){void 0===r&&(r=0);for(var e=0,n=t.length,o=t[0].length,i=0;i<n;i++)for(var a=0;a<o;a++)e+=t[i][a]*Math.log(t[i][a]+r);return-e},r.mean=function(t,r){void 0===r&&(r=0);var e,n,o,i,a=t.length,s=t[0].length;if(-1===r){for(e=[0],n=a*s,o=0;o<a;o++)for(i=0;i<s;i++)e[0]+=t[o][i];e[0]/=n}else if(0===r)for(e=new Array(s),n=a,i=0;i<s;i++){for(e[i]=0,o=0;o<a;o++)e[i]+=t[o][i];e[i]/=n}else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(a),n=s,i=0;i<a;i++){for(e[i]=0,o=0;o<s;o++)e[i]+=t[i][o];e[i]/=n}}return e},r.sum=function(t,r){void 0===r&&(r=0);var e,n,o,i=t.length,a=t[0].length;if(-1===r)for(e=[0],n=0;n<i;n++)for(o=0;o<a;o++)e[0]+=t[n][o];else if(0===r)for(e=new Array(a),o=0;o<a;o++)for(e[o]=0,n=0;n<i;n++)e[o]+=t[n][o];else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(i),o=0;o<i;o++)for(e[o]=0,n=0;n<a;n++)e[o]+=t[o][n]}return e},r.product=function(t,r){void 0===r&&(r=0);var e,n,o,i=t.length,a=t[0].length;if(-1===r)for(e=[1],n=0;n<i;n++)for(o=0;o<a;o++)e[0]*=t[n][o];else if(0===r)for(e=new Array(a),o=0;o<a;o++)for(e[o]=1,n=0;n<i;n++)e[o]*=t[n][o];else{if(1!==r)throw new Error("Invalid dimension");for(e=new Array(i),o=0;o<i;o++)for(e[o]=1,n=0;n<a;n++)e[o]*=t[o][n]}return e},r.standardDeviation=function(t,e,n){for(var o=r.variance(t,e,n),i=o.length,a=0;a<i;a++)o[a]=Math.sqrt(o[a]);return o},r.variance=function(t,e,n){void 0===n&&(n=!0),e=e||r.mean(t);var o=t.length;if(0===o)return[];for(var i=t[0].length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0,f=0;f<o;f++)h+=l=t[f][s]-e[s],u+=l*l;a[s]=n?(u-h*h/o)/(o-1):(u-h*h/o)/o}return a},r.median=function(t){for(var r=t.length,e=t[0].length,n=new Array(e),i=0;i<e;i++){for(var a=new Array(r),s=0;s<r;s++)a[s]=t[s][i];a.sort(o);var h=a.length;n[i]=h%2==0?.5*(a[h/2]+a[h/2-1]):a[Math.floor(h/2)]}return n},r.mode=function(t){var r,e,n=t.length,o=t[0].length,i=new Array(o);for(r=0;r<o;r++){for(var a=new Array(n),s=0;s<n;s++)a[s]=0;var h=new Array(n),u=0;for(e=0;e<n;e++){var l=h.indexOf(t[e][r]);l>=0?a[l]++:(h[u]=t[e][r],a[u]=1,u++)}var f=0,c=0;for(e=0;e<u;e++)a[e]>f&&(f=a[e],c=e);i[r]=h[c]}return i},r.skewness=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=t.length,i=n.length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0;l<o;l++){var f=t[l][s]-n[s];h+=f*f,u+=f*f*f}var c=h/o,m=u/o/Math.pow(c,1.5);if(e){var w=Math.sqrt(o*(o-1)),g=o-2;a[s]=w/g*m}else a[s]=m}return a},r.kurtosis=function(t,e){void 0===e&&(e=!0);for(var n=r.mean(t),o=t.length,i=t[0].length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0;l<o;l++){var f=t[l][s]-n[s];h+=f*f,u+=f*f*f*f}var c=h/o,m=u/o;if(e){var w=h/(o-1),g=o*(o+1)/((o-1)*(o-2)*(o-3)),v=u/(w*w),d=(o-1)*(o-1)/((o-2)*(o-3));a[s]=g*v-3*d}else a[s]=m/(c*c)-3}return a},r.standardError=function(t){for(var e=t.length,n=r.standardDeviation(t),o=n.length,i=new Array(o),a=Math.sqrt(e),s=0;s<o;s++)i[s]=n[s]/a;return i},r.covariance=function(t,e){return r.scatter(t,void 0,e)},r.scatter=function(t,e,n){void 0===n&&(n=0),void 0===e&&(0===n?e=t.length-1:1===n&&(e=t[0].length-1));var o=r.mean(t,n),i=t.length;if(0===i)return[[]];var a,s,h,u,l,f=t[0].length;if(0===n){for(a=new Array(f),s=0;s<f;s++)a[s]=new Array(f);for(s=0;s<f;s++)for(h=s;h<f;h++){for(u=0,l=0;l<i;l++)u+=(t[l][h]-o[h])*(t[l][s]-o[s]);u/=e,a[s][h]=u,a[h][s]=u}}else{if(1!==n)throw new Error("Invalid dimension");for(a=new Array(i),s=0;s<i;s++)a[s]=new Array(i);for(s=0;s<i;s++)for(h=s;h<i;h++){for(u=0,l=0;l<f;l++)u+=(t[h][l]-o[h])*(t[s][l]-o[s]);u/=e,a[s][h]=u,a[h][s]=u}}return a},r.correlation=function(t){var e,n,o=r.mean(t),i=r.standardDeviation(t,!0,o),a=r.zScores(t,o,i),s=t.length,h=t[0].length,u=new Array(h);for(e=0;e<h;e++)u[e]=new Array(h);for(e=0;e<h;e++)for(n=e;n<h;n++){for(var l=0,f=0,c=a.length;f<c;f++)l+=a[f][n]*a[f][e];l/=s-1,u[e][n]=l,u[n][e]=l}return u},r.zScores=function(t,e,n){return e=e||r.mean(t),void 0===n&&(n=r.standardDeviation(t,!0,e)),r.standardize(r.center(t,e,!1),n,!0)},r.center=function(t,e,n){e=e||r.mean(t);var o,i,a,s=t,h=t.length;if(!n)for(s=new Array(h),o=0;o<h;o++)s[o]=new Array(t[o].length);for(o=0;o<h;o++){var u=s[o];for(i=0,a=u.length;i<a;i++)u[i]=t[o][i]-e[i]}return s},r.standardize=function(t,e,n){void 0===e&&(e=r.standardDeviation(t));var o,i,a,s=t,h=t.length;if(!n)for(s=new Array(h),o=0;o<h;o++)s[o]=new Array(t[o].length);for(o=0;o<h;o++){var u=s[o],l=t[o];for(i=0,a=u.length;i<a;i++)0===e[i]||isNaN(e[i])||(u[i]=l[i]/e[i])}return s},r.weightedVariance=function(t,e){var n=r.mean(t),o=t.length;if(0===o)return[];for(var i=t[0].length,a=new Array(i),s=0;s<i;s++){for(var h=0,u=0,l=0,f=0;f<o;f++){var c=t[f][s]-n[s],m=e[f];h+=m*(c*c),l+=m,u+=m*m}a[s]=h*(l/(l*l-u))}return a},r.weightedMean=function(t,r,e){void 0===e&&(e=0);var o=t.length;if(0===o)return[];var i,a,s,h,u,l,f=t[0].length;if(0===e){for(i=new Array(f),a=0;a<f;a++)i[a]=0;for(a=0;a<o;a++)for(l=t[a],u=r[a],h=0;h<f;h++)i[h]+=l[h]*u}else{if(1!==e)throw new Error("Invalid dimension");for(i=new Array(o),a=0;a<o;a++)i[a]=0;for(h=0;h<o;h++)for(l=t[h],u=r[h],a=0;a<f;a++)i[h]+=l[a]*u}var c=n.sum(r);if(0!==c)for(a=0,s=i.length;a<s;a++)i[a]/=c;return i},r.weightedCovariance=function(t,e,n,o){o=o||0,n=n||r.weightedMean(t,e,o);for(var i=0,a=0,s=0,h=e.length;s<h;s++)i+=e[s],a+=e[s]*e[s];var u=i/(i*i-a);return r.weightedScatter(t,e,n,u,o)},r.weightedScatter=function(t,e,n,o,i){i=i||0,n=n||r.weightedMean(t,e,i),void 0===o&&(o=1);var a=t.length;if(0===a)return[[]];var s,h,u,l,f,c=t[0].length;if(0===i){for(s=new Array(c),h=0;h<c;h++)s[h]=new Array(c);for(h=0;h<c;h++)for(u=h;u<c;u++){for(f=0,l=0;l<a;l++)f+=e[l]*(t[l][u]-n[u])*(t[l][h]-n[h]);s[h][u]=f*o,s[u][h]=f*o}}else{if(1!==i)throw new Error("Invalid dimension");for(s=new Array(a),h=0;h<a;h++)s[h]=new Array(a);for(h=0;h<a;h++)for(u=h;u<a;u++){for(f=0,l=0;l<c;l++)f+=e[l]*(t[u][l]-n[u])*(t[h][l]-n[h]);s[h][u]=f*o,s[u][h]=f*o}}return s}},function(t,r,e){"use strict";let n=e(7);function o(t,r,e,n,o){let i=e.length,a=[],s=[],h=Math.sign(e[1]-e[0]);-1===h&&(o[0]=e.length-1);let u=Math.abs(r-t)/2,l=(t+r)/2,f=!1,c=o[0];for(;!f&&c<i&&c>=0;)Math.abs(e[c]-l)<=u?(a.push(e[c]),s.push(n[c]),c+=h):1===Math.sign(l-e[c])?c+=h:f=!0;return o[0]=c,[a,s]}t.exports=function(t,r,e,i,a){let s,h,u,l,f,c=[0],m=function(t,r){let e,n,o,i,a=[],s=[],h=[t[0].x,r*t[0].width];for(e=0;e<t.length;e++)Math.abs(t[e].x-h[0])<r*t[e].width+h[1]?(a.push(t[e]),o=h[0]+h[1],t[e].x+r*t[e].width>o&&(o=t[e].x+r*t[e].width),i=h[0]-h[1],t[e].x-r*t[e].width<i&&(i=t[e].x-r*t[e].width),h=[(o+i)/2,Math.abs(o-i)/2]):(s.push({limits:h,group:a}),a=[t[e]],h=[t[e].x,r*t[e].width]);for(s.push({limits:h,group:a}),e=s.length-2;e>=0;e--)if(Math.abs(s[e].limits[0]-s[e+1].limits[0])<(s[e].limits[1]+s[e+1].limits[1])/2){for(n=0;n<s[e+1].group.length;n++)s[e].group.push(s[e+1].group[n]);o=s[e].limits[0]+s[e].limits[1],s[e+1].limits[0]+s[e+1].limits[1]>o&&(o=s[e+1].limits[0]+s[e+1].limits[1]),i=s[e].limits[0]-s[e].limits[1],s[e+1].limits[0]-s[e+1].limits[1]<i&&(i=s[e+1].limits[0]-s[e+1].limits[1]),s[e].limits=[(o+i)/2,Math.abs(o-i)/2],s.splice(e+1,1)}return s}(t,i),w=[],g=1;for("gaussian"===a&&(g=1.17741),s=0;s<m.length;s++){let t=m[s].group;if(t.length>1){if((u=o(m[s].limits[0]-m[s].limits[1],m[s].limits[0]+m[s].limits[1],r,e,c))[0].length>5){f=[3,100,l=t[0].width/1e3,l,l,10*l,10*l,11,9,1];let r=[];for("gaussian"===a?r=n.optimizeGaussianSum(u,t,f):"lorentzian"===a&&(r=n.optimizeLorentzianSum(u,t,f)),h=0;h<r.length;h++)w.push({x:r[h][0][0],y:r[h][1][0],width:r[h][2][0]*g})}}else if((u=o((t=t[0]).x-i*t.width,t.x+i*t.width,r,e,c))[0].length>5){f=[3,100,l=t.width/1e3,l,l,10*l,10*l,11,9,1];let r=[];"gaussian"===a?r=n.optimizeSingleGaussian([u[0],u[1]],t,f):"lorentzian"===a&&(r=n.optimizeSingleLorentzian([u[0],u[1]],t,f)),w.push({x:r[0][0],y:r[1][0],width:r[2][0]*g})}}return w}},function(t,r,e){"use strict";t.exports=e(19),t.exports.Matrix=e(2),t.exports.Matrix.algebra=e(11)},function(t,r,e){var n=e(2),o=e(11),i={optimize:function(t,r,e,i,a,s,h,u,l,f){var c=0;if("object"!=typeof r[0])for(var m=0;m<r.length;m++)r[m]=[r[m]];var w=r.length,g=i.length,v=n.zeros(w,1),d=n.zeros(g,1),p=-2e-4,M=-2e-4,x=n.zeros(g,w);if(e.length==i.length){a=a||Math.sqrt((g-w+1)/o.multiply(o.transpose(i),i)),s=s||.001,h=h||o.multiply(Math.abs(r),-100),u=u||o.multiply(Math.abs(r),100),l=l||1;(f=f||[3,10*w,.001,.001,.001,.01,.01,11,9,1])[0];var y=f[1],b=f[2],A=(f[3],f[4],f[5]),S=f[6],k=f[7],R=f[8],_=f[9];if(!s.length||1==s.length){var V=new Array(w);for(m=0;m<w;m++)V[m]=[s];s=V}var z=[];for(m=0;m<s.length;m++)0!=s[m][0]&&z.push(m);var C=z.length,E=!1,j=null;if(!a.length||a.length<g){var I=o.multiply(n.ones(g,1),a[0]);j=o.dotMultiply(I,I)}else j=o.dotMultiply(a,a);var q=this.lm_matx(t,e,v,d,1,x,r,i,j,s,l),D=q.JtWJ,O=q.JtWdy,W=(p=q.Chi_sq,q.y_hat);x=q.J;switch(Math.max(Math.abs(O))<b&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",b),E=!0),_){case 1:lambda=S;break;default:lambda=S*Math.max(o.diag(D)),nu=2}M=p;for(var T=null;!E&&c<=y;){switch(c+=1,_){case 1:T=o.solve(o.add(D,o.multiply(o.diag(o.diag(D)),lambda)),O);break;default:T=o.solve(o.add(D,o.multiply(n.eye(w),lambda)),O)}var L=new Array(z.length);for(G=0;G<z.length;G++)L[G]=T[z[G]];var F=o.add(r,L);for(G=0;G<F.length;G++)F[G][0]=Math.min(Math.max(h[G][0],F[G][0]),u[G][0]);var N=o.subtract(i,t(e,F,l)),P=o.multiply(o.transpose(N),o.dotMultiply(N,j));if(2==_){var U=o.multiply(o.transpose(O),T),J=o.multiply(U,o.inv(o.add(o.multiply(o.subtract(P-p),.5)),o.multiply(U,2)));T=o.multiply(J,T);for(var G=0;G<z.length;G++)L[G]=T[z[G]];F=o.add(r,L),F=o.min(o.max(h,F),u),N=o.subtract(i,t(e,F,l)),P=o.multiply(o.transpose(N),mat.dotMultiply(N,j))}var X=(p-P)/o.multiply(o.multiply(o.transpose(T),2),o.add(o.multiply(lambda,T),O));if(X>A)switch(dX2=p-M,M=p,v=r,d=W,r=F,D=(q=this.lm_matx(t,e,v,d,dX2,x,r,i,j,s,l)).JtWJ,O=q.JtWdy,p=q.Chi_sq,W=q.y_hat,x=q.J,_){case 1:lambda=Math.max(lambda/R,1e-7);break;case 2:lambda=Math.max(lambda/(1+J),1e-7);break;case 3:lambda=o.multiply(Math.max(1/3,1-(2*X-1)^3),lambda),nu=2}else switch(p=M,c%(2*w)==0&&(D=(q=this.lm_matx(t,e,v,d,-1,x,r,i,j,s,l)).JtWJ,O=q.JtWdy,dX2=q.Chi_sq,W=q.y_hat,x=q.J),_){case 1:lambda=Math.min(lambda*k,1e7);break;case 2:lambda+=Math.abs((P-p)/2/J);break;case 3:lambda*=nu,nu*=2}}return(j=o.multiply(o.multiply(o.transpose(N),N),n.ones(g,1))).apply((function(t,r){j[t][r]=(g-C+1)/j[t][r]})),D=(q=this.lm_matx(t,e,v,d,-1,x,r,i,j,s,l)).JtWJ,O=q.JtWdy,p=q.Chi_sq,W=q.y_hat,x=q.J,{p:r,X2:p}}console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=e.length,length_y_dat=i.length;var p=0},lm_FD_J:function(t,r,e,i,a,s){var h=i.length,u=e.length;a=a||o.multiply(n.ones(u,1),.001);for(var l=e.clone(),f=new n(h,u),c=new Array(u),m=0;m<u;m++){if(c[m]=a[m]*(1+Math.abs(e[m][0])),e[m]=[l[m][0]+c[m]],0!=c[m])if(y1=t(r,e,s),a[m][0]<0)for(var w=o.dotDivide(o.subtract(y1,i),c[m]),g=0;g<h;g++)f[g][m]=w[g][0];else{e[m][0]=l[m][0]-c[m];for(w=o.dotDivide(o.subtract(y1,t(r,e,s)),2*c[m]),g=0;g<h;g++)f[g][m]=w[g][0]}e[m]=l[m]}return f},lm_Broyden_J:function(t,r,e,n,i){var a=o.subtract(n,t),s=o.transpose(a);return s.div(o.multiply(s,a)),e=o.add(e,o.multiply(o.subtract(i,o.add(r,o.multiply(e,a))),s))},lm_matx:function(t,r,e,i,a,s,h,u,l,f,c,m){u.length;var w=h.length;f=f||.001;var g=t(r,h,c);s=m%(2*w)==0||a>0?this.lm_FD_J(t,r,h,g,f,c):this.lm_Broyden_J(e,i,s,h,g);var v=o.subtract(u,g),d=o.multiply(o.transpose(v),o.dotMultiply(v,l)),p=o.transpose(s);return{JtWJ:o.multiply(p,o.dotMultiply(s,o.multiply(l,n.ones(1,w)))),JtWdy:o.multiply(p,o.dotMultiply(l,v)),Chi_sq:d,y_hat:g,J:s}}};t.exports=i},function(t,r,e){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},function(t,r,e){t.exports=r=e(22),r.getEquallySpacedData=e(23).getEquallySpacedData,r.SNV=e(24).SNV},function(t,r,e){"use strict";const n=e(4).array;function o(t){for(var r=new Array(t[0].length),e=0;e<r.length;++e)r[e]=new Array(t.length);for(e=0;e<t.length;++e)for(var n=0;n<t[0].length;++n)r[n][e]=t[e][n];return r}t.exports={coordArrayToPoints:function(t,r){if(t.length%r!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var e=t.length/r,n=new Array(e),o=0,i=0;i<t.length;i+=r){for(var a=new Array(r),s=0;s<r;++s)a[s]=t[i+s];n[o]=a,o++}return n},coordArrayToCoordMatrix:function(t,r){if(t.length%r!=0)throw new RangeError("Dimensions number must be accordance with the size of the array.");for(var e=new Array(r),n=t.length/r,o=0;o<e.length;o++)e[o]=new Array(n);for(o=0;o<t.length;o+=r)for(var i=0;i<r;++i){var a=Math.floor(o/r);e[i][a]=t[o+i]}return e},coordMatrixToCoordArray:function(t){for(var r=new Array(t.length*t[0].length),e=0,n=0;n<t[0].length;++n)for(var o=0;o<t.length;++o)r[e]=t[o][n],++e;return r},coordMatrixToPoints:o,pointsToCoordArray:function(t){for(var r=new Array(t.length*t[0].length),e=0,n=0;n<t.length;++n)for(var o=0;o<t[0].length;++o)r[e]=t[n][o],++e;return r},pointsToCoordMatrix:o,applyDotProduct:function(t,r){var e,n;t.length<=r.length?(n=t,e=r):(n=r,e=t);for(var o=e.length-n.length+1,i=new Array(o),a=0;a<o;++a){for(var s=0,h=0;h<n.length;++h)s+=n[h]*e[a+h];i[a]=s}return i},scale:function(t,r){var e;e=r.inPlace?t:new Array(t.length);const o=r.max,i=r.min;if("number"==typeof o)if("number"==typeof i)for(var a=n.minMax(t),s=(o-i)/(a.max-a.min),h=0;h<e.length;h++)e[h]=(t[h]-a.min)*s+i;else for(s=o/n.max(t),h=0;h<e.length;h++)e[h]=t[h]*s;else if("number"==typeof i)for(s=i/n.min(t),h=0;h<e.length;h++)e[h]=t[h]*s;return e}}},function(t,r,e){"use strict";function n(t,r,e,n){return.5*e*r*r+n*r-(.5*e*t*t+n*t)}r.getEquallySpacedData=function(t,r,e){if(t.length>1&&t[0]>t[1]&&(t=t.slice().reverse(),r=r.slice().reverse()),t.length!==r.length)throw new RangeError("the x and y vector doesn't have the same size.");void 0===e&&(e={});var o=void 0===e.from?t[0]:e.from;if(isNaN(o)||!isFinite(o))throw new RangeError("'From' value must be a number");var i=void 0===e.to?t[t.length-1]:e.to;if(isNaN(i)||!isFinite(i))throw new RangeError("'To' value must be a number");var a=o>i;if(a){var s=o;o=i,i=s}var h=void 0===e.numberOfPoints?100:e.numberOfPoints;if(isNaN(h)||!isFinite(h))throw new RangeError("'Number of points' value must be a number");if(h<1)throw new RangeError("the number of point must be higher than 1");var u="slot"===("slot"===e.variant?"slot":"smooth")?function(t,r,e,n,o){var i=t.length,a=(n-e)/(o-1),s=a/2,h=t[t.length-1]-t[t.length-2],u=e-s,l=new Array(o),f=u,c=u+a,m=-Number.MAX_VALUE,w=0,g=t[0],v=r[0],d=0,p=!0,M=0,x=0,y=1,b=0;t:for(;;){if(m>=g)throw new Error("x must be an increasing serie");for(;m-c>0;){if(p&&(x++,p=!1),l[b]=x<=0?0:M/x,++b===o)break t;f=c,c+=a,M=0,x=0}m>f&&(M+=w,x++),(m===-Number.MAX_VALUE||d>1)&&x--,m=g,w=v,y<i?(g=t[y],v=r[y],y++):(g+=h,v=0,d++)}return l}(t,r,o,i,h):function(t,r,e,o,i){var a=t.length,s=(o-e)/(i-1),h=e-s/2,u=new Array(i),l=t[1]-t[0],f=t[t.length-1]-t[t.length-2],c=h,m=h+s,w=Number.MIN_VALUE,g=0,v=t[0]-l,d=0,p=0,M=0,x=0,y=0,b=0,A=0,S=0;function k(t,r,e,n){return(n-r)/(e-t)}t:for(;;){for(;v-m>=0;){var R=n(0,m-w,M,g);if(b=p+R,u[S]=(b-y)/s,++S===i)break t;c=m,m+=s,y=b}w<=c&&c<=v&&(R=n(0,c-w,M,g),y=p+R),p+=n(w,v,M,x),w=v,g=d,A<a?(v=t[A],d=r[A],A++):A===a&&(v+=f,d=0),M=k(w,g,v,d),x=-M*w+g}return u}(t,r,o,i,h);return a?u.reverse():u},r.integral=n},function(t,r,e){"use strict";r.SNV=function(t){for(var r=n.mean(t),e=n.standardDeviation(t),o=t.slice(),i=0;i<t.length;i++)o[i]=(o[i]-r)/e;return o};var n=e(4).array},function(t,r,e){"use strict";var n=e(1);t.exports=class extends n{constructor(t){super(t,t.columns,t.rows)}set(t,r,e){return this.matrix.set(r,t,e),this}get(t,r){return this.matrix.get(r,t)}}},function(t,r,e){"use strict";var n=e(1);t.exports=class extends n{constructor(t,r){super(t,1,t.columns),this.row=r}set(t,r,e){return this.matrix.set(this.row,r,e),this}get(t,r){return this.matrix.get(this.row,r)}}},function(t,r,e){"use strict";var n=e(1),o=e(3);t.exports=class extends n{constructor(t,r,e,n,i){o.checkRange(t,r,e,n,i),super(t,e-r+1,i-n+1),this.startRow=r,this.startColumn=n}set(t,r,e){return this.matrix.set(this.startRow+t,this.startColumn+r,e),this}get(t,r){return this.matrix.get(this.startRow+t,this.startColumn+r)}}},function(t,r,e){"use strict";var n=e(1),o=e(3);t.exports=class extends n{constructor(t,r,e){var n=o.checkIndices(t,r,e);super(t,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(t,r,e){return this.matrix.set(this.rowIndices[t],this.columnIndices[r],e),this}get(t,r){return this.matrix.get(this.rowIndices[t],this.columnIndices[r])}}},function(t,r,e){"use strict";var n=e(1);t.exports=class extends n{constructor(t,r){super(t,t.rows,1),this.column=r}set(t,r,e){return this.matrix.set(t,this.column,e),this}get(t){return this.matrix.get(t,this.column)}}},function(t,r,e){"use strict";var n=e(1);t.exports=class extends n{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(this.rows-t-1,r,e),this}get(t,r){return this.matrix.get(this.rows-t-1,r)}}},function(t,r,e){"use strict";var n=e(1);t.exports=class extends n{constructor(t){super(t,t.rows,t.columns)}set(t,r,e){return this.matrix.set(t,this.columns-r-1,e),this}get(t,r){return this.matrix.get(t,this.columns-r-1)}}},function(t,r,e){"use strict";var n=e(0).Matrix,o=e(10),i=e(33),a=e(9),s=e(34),h=e(35);function u(t){return l(t=n.checkMatrix(t),n.eye(t.rows))}function l(t,r){return t=n.checkMatrix(t),r=n.checkMatrix(r),t.isSquare()?new a(t).solve(r):new s(t).solve(r)}n.inverse=n.inv=u,n.prototype.inverse=n.prototype.inv=function(){return u(this)},n.solve=l,n.prototype.solve=function(t){return l(this,t)},t.exports={SingularValueDecomposition:o,SVD:o,EigenvalueDecomposition:i,EVD:i,LuDecomposition:a,LU:a,QrDecomposition:s,QR:s,CholeskyDecomposition:h,CHO:h,inverse:u,solve:l}},function(t,r,e){"use strict";const n=e(0).Matrix,o=e(5),i=o.hypotenuse,a=o.getFilled2DArray,s={assumeSymmetric:!1};function h(t,r){if(r=Object.assign({},s,r),!(this instanceof h))return new h(t,r);if(!(t=n.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var e,o,l=t.columns,f=a(l,l,0),c=new Array(l),m=new Array(l),w=t;if(!!r.assumeSymmetric||t.isSymmetric()){for(e=0;e<l;e++)for(o=0;o<l;o++)f[e][o]=w.get(e,o);!function(t,r,e,n){var o,i,a,s,h,u,l,f;for(h=0;h<t;h++)e[h]=n[t-1][h];for(s=t-1;s>0;s--){for(f=0,a=0,u=0;u<s;u++)f+=Math.abs(e[u]);if(0===f)for(r[s]=e[s-1],h=0;h<s;h++)e[h]=n[s-1][h],n[s][h]=0,n[h][s]=0;else{for(u=0;u<s;u++)e[u]/=f,a+=e[u]*e[u];for(o=e[s-1],i=Math.sqrt(a),o>0&&(i=-i),r[s]=f*i,a-=o*i,e[s-1]=o-i,h=0;h<s;h++)r[h]=0;for(h=0;h<s;h++){for(o=e[h],n[h][s]=o,i=r[h]+n[h][h]*o,u=h+1;u<=s-1;u++)i+=n[u][h]*e[u],r[u]+=n[u][h]*o;r[h]=i}for(o=0,h=0;h<s;h++)r[h]/=a,o+=r[h]*e[h];for(l=o/(a+a),h=0;h<s;h++)r[h]-=l*e[h];for(h=0;h<s;h++){for(o=e[h],i=r[h],u=h;u<=s-1;u++)n[u][h]-=o*r[u]+i*e[u];e[h]=n[s-1][h],n[s][h]=0}}e[s]=a}for(s=0;s<t-1;s++){if(n[t-1][s]=n[s][s],n[s][s]=1,0!==(a=e[s+1])){for(u=0;u<=s;u++)e[u]=n[u][s+1]/a;for(h=0;h<=s;h++){for(i=0,u=0;u<=s;u++)i+=n[u][s+1]*n[u][h];for(u=0;u<=s;u++)n[u][h]-=i*e[u]}}for(u=0;u<=s;u++)n[u][s+1]=0}for(h=0;h<t;h++)e[h]=n[t-1][h],n[t-1][h]=0;n[t-1][t-1]=1,r[0]=0}(l,m,c,f),function(t,r,e,n){var o,a,s,h,u,l,f,c,m,w,g,v,d,p,M,x;for(s=1;s<t;s++)r[s-1]=r[s];r[t-1]=0;var y=0,b=0,A=Math.pow(2,-52);for(l=0;l<t;l++){for(b=Math.max(b,Math.abs(e[l])+Math.abs(r[l])),f=l;f<t&&!(Math.abs(r[f])<=A*b);)f++;if(f>l){0;do{for(1,o=e[l],c=(e[l+1]-o)/(2*r[l]),m=i(c,1),c<0&&(m=-m),e[l]=r[l]/(c+m),e[l+1]=r[l]*(c+m),w=e[l+1],a=o-e[l],s=l+2;s<t;s++)e[s]-=a;for(y+=a,c=e[f],v=g=1,d=g,p=r[l+1],M=0,x=0,s=f-1;s>=l;s--)for(d=v,v=g,x=M,o=g*r[s],a=g*c,m=i(c,r[s]),r[s+1]=M*m,M=r[s]/m,c=(g=c/m)*e[s]-M*o,e[s+1]=a+M*(g*o+M*e[s]),u=0;u<t;u++)a=n[u][s+1],n[u][s+1]=M*n[u][s]+g*a,n[u][s]=g*n[u][s]-M*a;c=-M*x*d*p*r[l]/w,r[l]=M*c,e[l]=g*c}while(Math.abs(r[l])>A*b)}e[l]=e[l]+y,r[l]=0}for(s=0;s<t-1;s++){for(u=s,c=e[s],h=s+1;h<t;h++)e[h]<c&&(u=h,c=e[h]);if(u!==s)for(e[u]=e[s],e[s]=c,h=0;h<t;h++)c=n[h][s],n[h][s]=n[h][u],n[h][u]=c}}(l,m,c,f)}else{var g=a(l,l,0),v=new Array(l);for(o=0;o<l;o++)for(e=0;e<l;e++)g[e][o]=w.get(e,o);!function(t,r,e,n){var o,i,a,s,h,u,l,f=t-1;for(u=1;u<=f-1;u++){for(l=0,s=u;s<=f;s++)l+=Math.abs(r[s][u-1]);if(0!==l){for(a=0,s=f;s>=u;s--)e[s]=r[s][u-1]/l,a+=e[s]*e[s];for(i=Math.sqrt(a),e[u]>0&&(i=-i),a-=e[u]*i,e[u]=e[u]-i,h=u;h<t;h++){for(o=0,s=f;s>=u;s--)o+=e[s]*r[s][h];for(o/=a,s=u;s<=f;s++)r[s][h]-=o*e[s]}for(s=0;s<=f;s++){for(o=0,h=f;h>=u;h--)o+=e[h]*r[s][h];for(o/=a,h=u;h<=f;h++)r[s][h]-=o*e[h]}e[u]=l*e[u],r[u][u-1]=l*i}}for(s=0;s<t;s++)for(h=0;h<t;h++)n[s][h]=s===h?1:0;for(u=f-1;u>=1;u--)if(0!==r[u][u-1]){for(s=u+1;s<=f;s++)e[s]=r[s][u-1];for(h=u;h<=f;h++){for(i=0,s=u;s<=f;s++)i+=e[s]*n[s][h];for(i=i/e[u]/r[u][u-1],s=u;s<=f;s++)n[s][h]+=i*e[s]}}}(l,g,v,f),function(t,r,e,n,o){var i,a,s,h,l,f,c,m,w,g,v,d,p,M,x,y=t-1,b=t-1,A=Math.pow(2,-52),S=0,k=0,R=0,_=0,V=0,z=0,C=0,E=0;for(i=0;i<t;i++)for((i<0||i>b)&&(e[i]=o[i][i],r[i]=0),a=Math.max(i-1,0);a<t;a++)k+=Math.abs(o[i][a]);for(;y>=0;){for(h=y;h>0&&(0===(z=Math.abs(o[h-1][h-1])+Math.abs(o[h][h]))&&(z=k),!(Math.abs(o[h][h-1])<A*z));)h--;if(h===y)o[y][y]=o[y][y]+S,e[y]=o[y][y],r[y]=0,y--,E=0;else if(h===y-1){if(c=o[y][y-1]*o[y-1][y],R=(o[y-1][y-1]-o[y][y])/2,_=R*R+c,C=Math.sqrt(Math.abs(_)),o[y][y]=o[y][y]+S,o[y-1][y-1]=o[y-1][y-1]+S,m=o[y][y],_>=0){for(C=R>=0?R+C:R-C,e[y-1]=m+C,e[y]=e[y-1],0!==C&&(e[y]=m-c/C),r[y-1]=0,r[y]=0,m=o[y][y-1],z=Math.abs(m)+Math.abs(C),R=m/z,_=C/z,V=Math.sqrt(R*R+_*_),R/=V,_/=V,a=y-1;a<t;a++)C=o[y-1][a],o[y-1][a]=_*C+R*o[y][a],o[y][a]=_*o[y][a]-R*C;for(i=0;i<=y;i++)C=o[i][y-1],o[i][y-1]=_*C+R*o[i][y],o[i][y]=_*o[i][y]-R*C;for(i=0;i<=b;i++)C=n[i][y-1],n[i][y-1]=_*C+R*n[i][y],n[i][y]=_*n[i][y]-R*C}else e[y-1]=m+R,e[y]=m+R,r[y-1]=C,r[y]=-C;y-=2,E=0}else{if(m=o[y][y],w=0,c=0,h<y&&(w=o[y-1][y-1],c=o[y][y-1]*o[y-1][y]),10===E){for(S+=m,i=0;i<=y;i++)o[i][i]-=m;z=Math.abs(o[y][y-1])+Math.abs(o[y-1][y-2]),m=w=.75*z,c=-.4375*z*z}if(30===E&&(z=(z=(w-m)/2)*z+c)>0){for(z=Math.sqrt(z),w<m&&(z=-z),z=m-c/((w-m)/2+z),i=0;i<=y;i++)o[i][i]-=z;S+=z,m=w=c=.964}for(E+=1,l=y-2;l>=h&&(C=o[l][l],R=((V=m-C)*(z=w-C)-c)/o[l+1][l]+o[l][l+1],_=o[l+1][l+1]-C-V-z,V=o[l+2][l+1],z=Math.abs(R)+Math.abs(_)+Math.abs(V),R/=z,_/=z,V/=z,l!==h)&&!(Math.abs(o[l][l-1])*(Math.abs(_)+Math.abs(V))<A*(Math.abs(R)*(Math.abs(o[l-1][l-1])+Math.abs(C)+Math.abs(o[l+1][l+1]))));)l--;for(i=l+2;i<=y;i++)o[i][i-2]=0,i>l+2&&(o[i][i-3]=0);for(s=l;s<=y-1&&(M=s!==y-1,s!==l&&(R=o[s][s-1],_=o[s+1][s-1],V=M?o[s+2][s-1]:0,0!==(m=Math.abs(R)+Math.abs(_)+Math.abs(V))&&(R/=m,_/=m,V/=m)),0!==m);s++)if(z=Math.sqrt(R*R+_*_+V*V),R<0&&(z=-z),0!==z){for(s!==l?o[s][s-1]=-z*m:h!==l&&(o[s][s-1]=-o[s][s-1]),m=(R+=z)/z,w=_/z,C=V/z,_/=R,V/=R,a=s;a<t;a++)R=o[s][a]+_*o[s+1][a],M&&(R+=V*o[s+2][a],o[s+2][a]=o[s+2][a]-R*C),o[s][a]=o[s][a]-R*m,o[s+1][a]=o[s+1][a]-R*w;for(i=0;i<=Math.min(y,s+3);i++)R=m*o[i][s]+w*o[i][s+1],M&&(R+=C*o[i][s+2],o[i][s+2]=o[i][s+2]-R*V),o[i][s]=o[i][s]-R,o[i][s+1]=o[i][s+1]-R*_;for(i=0;i<=b;i++)R=m*n[i][s]+w*n[i][s+1],M&&(R+=C*n[i][s+2],n[i][s+2]=n[i][s+2]-R*V),n[i][s]=n[i][s]-R,n[i][s+1]=n[i][s+1]-R*_}}}if(0===k)return;for(y=t-1;y>=0;y--)if(R=e[y],0===(_=r[y]))for(h=y,o[y][y]=1,i=y-1;i>=0;i--){for(c=o[i][i]-R,V=0,a=h;a<=y;a++)V+=o[i][a]*o[a][y];if(r[i]<0)C=c,z=V;else if(h=i,0===r[i]?o[i][y]=0!==c?-V/c:-V/(A*k):(m=o[i][i+1],w=o[i+1][i],_=(e[i]-R)*(e[i]-R)+r[i]*r[i],f=(m*z-C*V)/_,o[i][y]=f,o[i+1][y]=Math.abs(m)>Math.abs(C)?(-V-c*f)/m:(-z-w*f)/C),f=Math.abs(o[i][y]),A*f*f>1)for(a=i;a<=y;a++)o[a][y]=o[a][y]/f}else if(_<0)for(h=y-1,Math.abs(o[y][y-1])>Math.abs(o[y-1][y])?(o[y-1][y-1]=_/o[y][y-1],o[y-1][y]=-(o[y][y]-R)/o[y][y-1]):(x=u(0,-o[y-1][y],o[y-1][y-1]-R,_),o[y-1][y-1]=x[0],o[y-1][y]=x[1]),o[y][y-1]=0,o[y][y]=1,i=y-2;i>=0;i--){for(g=0,v=0,a=h;a<=y;a++)g+=o[i][a]*o[a][y-1],v+=o[i][a]*o[a][y];if(c=o[i][i]-R,r[i]<0)C=c,V=g,z=v;else if(h=i,0===r[i]?(x=u(-g,-v,c,_),o[i][y-1]=x[0],o[i][y]=x[1]):(m=o[i][i+1],w=o[i+1][i],d=(e[i]-R)*(e[i]-R)+r[i]*r[i]-_*_,p=2*(e[i]-R)*_,0===d&&0===p&&(d=A*k*(Math.abs(c)+Math.abs(_)+Math.abs(m)+Math.abs(w)+Math.abs(C))),x=u(m*V-C*g+_*v,m*z-C*v-_*g,d,p),o[i][y-1]=x[0],o[i][y]=x[1],Math.abs(m)>Math.abs(C)+Math.abs(_)?(o[i+1][y-1]=(-g-c*o[i][y-1]+_*o[i][y])/m,o[i+1][y]=(-v-c*o[i][y]-_*o[i][y-1])/m):(x=u(-V-w*o[i][y-1],-z-w*o[i][y],C,_),o[i+1][y-1]=x[0],o[i+1][y]=x[1])),f=Math.max(Math.abs(o[i][y-1]),Math.abs(o[i][y])),A*f*f>1)for(a=i;a<=y;a++)o[a][y-1]=o[a][y-1]/f,o[a][y]=o[a][y]/f}for(i=0;i<t;i++)if(i<0||i>b)for(a=i;a<t;a++)n[i][a]=o[i][a];for(a=t-1;a>=0;a--)for(i=0;i<=b;i++){for(C=0,s=0;s<=Math.min(a,b);s++)C+=n[i][s]*o[s][a];n[i][a]=C}}(l,m,c,f,g)}this.n=l,this.e=m,this.d=c,this.V=f}function u(t,r,e,n){var o,i;return Math.abs(e)>Math.abs(n)?[(t+(o=n/e)*r)/(i=e+o*n),(r-o*t)/i]:[((o=e/n)*t+r)/(i=n+o*e),(o*r-t)/i]}h.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return n.isMatrix(this.V)||(this.V=new n(this.V)),this.V},get diagonalMatrix(){var t,r,e=this.n,o=this.e,i=this.d,a=new n(e,e);for(t=0;t<e;t++){for(r=0;r<e;r++)a[t][r]=0;a[t][t]=i[t],o[t]>0?a[t][t+1]=o[t]:o[t]<0&&(a[t][t-1]=o[t])}return a}},t.exports=h},function(t,r,e){"use strict";var n=e(0).Matrix,o=e(5).hypotenuse;function i(t){if(!(this instanceof i))return new i(t);var r,e,a,s,h=(t=n.checkMatrix(t)).clone(),u=t.rows,l=t.columns,f=new Array(l);for(a=0;a<l;a++){var c=0;for(r=a;r<u;r++)c=o(c,h[r][a]);if(0!==c){for(h[a][a]<0&&(c=-c),r=a;r<u;r++)h[r][a]/=c;for(h[a][a]+=1,e=a+1;e<l;e++){for(s=0,r=a;r<u;r++)s+=h[r][a]*h[r][e];for(s=-s/h[a][a],r=a;r<u;r++)h[r][e]+=s*h[r][a]}}f[a]=-c}this.QR=h,this.Rdiag=f}i.prototype={solve:function(t){t=n.checkMatrix(t);var r=this.QR,e=r.rows;if(t.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var o,i,a,s,h=t.columns,u=t.clone(),l=r.columns;for(a=0;a<l;a++)for(i=0;i<h;i++){for(s=0,o=a;o<e;o++)s+=r[o][a]*u[o][i];for(s=-s/r[a][a],o=a;o<e;o++)u[o][i]+=s*r[o][a]}for(a=l-1;a>=0;a--){for(i=0;i<h;i++)u[a][i]/=this.Rdiag[a];for(o=0;o<a;o++)for(i=0;i<h;i++)u[o][i]-=u[a][i]*r[o][a]}return u.subMatrix(0,l-1,0,h-1)},isFullRank:function(){for(var t=this.QR.columns,r=0;r<t;r++)if(0===this.Rdiag[r])return!1;return!0},get upperTriangularMatrix(){var t,r,e=this.QR,o=e.columns,i=new n(o,o);for(t=0;t<o;t++)for(r=0;r<o;r++)i[t][r]=t<r?e[t][r]:t===r?this.Rdiag[t]:0;return i},get orthogonalMatrix(){var t,r,e,o,i=this.QR,a=i.rows,s=i.columns,h=new n(a,s);for(e=s-1;e>=0;e--){for(t=0;t<a;t++)h[t][e]=0;for(h[e][e]=1,r=e;r<s;r++)if(0!==i[e][e]){for(o=0,t=e;t<a;t++)o+=i[t][e]*h[t][r];for(o=-o/i[e][e],t=e;t<a;t++)h[t][r]+=o*i[t][e]}}return h}},t.exports=i},function(t,r,e){"use strict";var n=e(0).Matrix;function o(t){if(!(this instanceof o))return new o(t);if(!(t=n.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var r,e,i,a=t,s=a.rows,h=new n(s,s),u=!0;for(e=0;e<s;e++){var l=h[e],f=0;for(i=0;i<e;i++){var c=h[i],m=0;for(r=0;r<i;r++)m+=c[r]*l[r];l[i]=m=(a[e][i]-m)/h[i][i],f+=m*m}for(u&=(f=a[e][e]-f)>0,h[e][e]=Math.sqrt(Math.max(f,0)),i=e+1;i<s;i++)h[e][i]=0}if(!u)throw new Error("Matrix is not positive definite");this.L=h}o.prototype={get lowerTriangularMatrix(){return this.L},solve:function(t){t=n.checkMatrix(t);var r=this.L,e=r.rows;if(t.rows!==e)throw new Error("Matrix dimensions do not match");var o,i,a,s=t.columns,h=t.clone();for(a=0;a<e;a++)for(i=0;i<s;i++){for(o=0;o<a;o++)h[a][i]-=h[o][i]*r[a][o];h[a][i]/=r[a][a]}for(a=e-1;a>=0;a--)for(i=0;i<s;i++){for(o=a+1;o<e;o++)h[a][i]-=h[o][i]*r[o][a];h[a][i]/=r[a][a]}return h}},t.exports=o},function(t,r,e){"use strict";let n=e(7);t.exports=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=r.width,o=[],i=0,a=0,s=1;for(let r=t.length-1;r>=0;r--)t[r].soft&&o.push(t.splice(r,1)[0]);o.push({x:Number.MAX_VALUE});let h=[[o[0].x,o[0].y]],u=[0];for(let r=1;r<o.length;r++)if(Math.abs(o[r-1].x-o[r].x)<e)h.push([o[r].x,o[r].y]),o[r].y>i&&(i=o[r].y,a=r),u.push(r),s++;else{if(s>2){let r=n.optimizeSingleLorentzian(h,{x:o[a].x,y:i,width:Math.abs(h[0][0]-h[h.length-1][0])});t.push({x:r[0][0],y:r[1][0],width:r[2][0],soft:!1})}else u.forEach(r=>{t.push(o[r])});h=[[o[r].x,o[r].y]],u=[r],i=o[r].y,a=r,s=1}return t.sort((function(t,r){return t.x-r.x})),t}},function(t,r,e){"use strict";t.exports=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{factor:e=2,overlap:n=!1}=r;for(let r of t)r.from=r.x-r.width/2*e,r.to=r.x+r.width/2*e;if(!n)for(let r=0;r<t.length-1;r++){let e=t[r],n=t[r+1];e.to>n.from&&(e.to=n.from=(e.to+n.from)/2)}for(let r of t)r.width=r.to-r.from;return t}}])}));
//# sourceMappingURL=ml-gsd.min.js.map