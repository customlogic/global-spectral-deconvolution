!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.GSD=t():r.GSD=t()}(this,function(){return function(r){function t(n){if(o[n])return o[n].exports;var e=o[n]={exports:{},id:n,loaded:!1};return r[n].call(e.exports,e,e.exports,t),e.loaded=!0,e.exports}var o={};return t.m=r,t.c=o,t.p="",t(0)}([function(r,t,o){r.exports.optimize=o(1),r.exports.gsd=o(15)},function(r,t,o){function n(r,t,o,n,e){var i=o.length,s=[],a=[],f=Math.sign(o[1]-o[0]);-1==f&&(e[0]=o.length-1);for(var u=Math.abs(t-r)/2,h=(r+t)/2,c=!1,l=e[0];!c&&i>l&&l>=0;)Math.abs(o[l]-h)<=u?(s.push(o[l]),a.push(n[l]),l+=f):1==Math.sign(h-o[l])?l+=f:c=!0;return e[0]=l,[s,a]}function e(r,t,o,e,a){var f,u,h=[0],c=i(r,e),l=[],m=1;for("gaussian"==a&&(m=1.17741),f=0;f<c.length;f++){var p=c[f].group;if(p.length>1){var w=n(c[f].limits[0]-c[f].limits[1],c[f].limits[0]+c[f].limits[1],t,o,h);if(w[0].length>5){var v=p[0].width/1e3,d=[3,100,v,v,v,10*v,10*v,11,9,1],y=[];for("gaussian"==a?y=s.optimizeGaussianSum(w,p,d):"lorentzian"==a&&(y=s.optimizeLorentzianSum(w,p,d)),u=0;u<y.length;u++)l.push({x:y[u][0][0],y:y[u][1][0],width:y[u][2][0]*m})}}else{p=p[0];var w=n(p.x-e*p.width,p.x+e*p.width,t,o,h);if(w[0].length>5){var v=p.width/1e3,d=[3,100,v,v,v,10*v,10*v,11,9,1],g=[];if("gaussian"==a)var g=s.optimizeSingleGaussian([w[0],w[1]],p,d);else if("lorentzian"==a)var g=s.optimizeSingleLorentzian([w[0],w[1]],p,d);l.push({x:g[0][0],y:g[1][0],width:g[2][0]*m})}}}return l}function i(r,t){var o,n,e,i,s=[],a=[],f=[r[0].x,t*r[0].width];for(o=0;o<r.length;o++)Math.abs(r[o].x-f[0])<t*r[o].width+f[1]?(s.push(r[o]),e=f[0]+f[1],r[o].x+t*r[o].width>e&&(e=r[o].x+t*r[o].width),i=f[0]-f[1],r[o].x-t*r[o].width<i&&(i=r[o].x-t*r[o].width),f=[(e+i)/2,Math.abs(e-i)/2]):(a.push({limits:f,group:s}),s=[r[o]],f=[r[o].x,t*r[o].width]);for(a.push({limits:f,group:s}),o=a.length-2;o>=0;o--)if(Math.abs(a[o].limits[0]-a[o+1].limits[0])<(a[o].limits[1]+a[o+1].limits[1])/2){for(n=0;n<a[o+1].group.length;n++)a[o].group.push(a[o+1].group[n]);e=a[o].limits[0]+a[o].limits[1],a[o+1].limits[0]+a[o+1].limits[1]>e&&(e=a[o+1].limits[0]+a[o+1].limits[1]),i=a[o].limits[0]-a[o].limits[1],a[o+1].limits[0]-a[o+1].limits[1]<i&&(i=a[o+1].limits[0]-a[o+1].limits[1]),a[o].limits=[(e+i)/2,Math.abs(e-i)/2],a.splice(o+1,1)}return a}var s=o(2);r.exports=e},function(r,t,o){"use strict";function n(r,t,o){var n,e,i,s,a=t.length/3,f=r.rows,u=m.zeros(r.length,1);for(e=0;a>e;e++)for(s=Math.pow(t[e+2*a][0]/2,2),n=t[e+a][0]*s,i=0;f>i;i++)u[i][0]+=n/(Math.pow(r[i][0]-t[e][0],2)+s);return u}function e(r,t,o){for(var n=t[1][0]*Math.pow(t[2][0]/2,2),e=r.rows,i=new m(r.rows,r.columns),s=0;e>s;s++)i[s][0]=n/(Math.pow(r[s][0]-t[0][0],2)+Math.pow(t[2][0]/2,2));return i}function i(r,t,o){for(var n=t[2][0]*t[2][0]/2,e=r.rows,i=new m(r.rows,r.columns),s=0;e>s;s++)i[s][0]=t[1][0]*Math.exp(-(r[s][0]-t[0][0])*(r[s][0]-t[0][0])/n);return i}function s(r,t,o){var n=h(r),i=n[0],s=n[1],a=n[2],f=i.columns,u=[f/Math.sqrt(s.dot(s))],o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,1]),l=[],p=Math.abs(i[0][0]-i[1][0]),w=new m([[-p/1e4],[-.001],[-p/1e4]]),v=new m([[t.x],[1],[t.width]]),d=new m([[t.x-p],[.75],[t.width/4]]),y=new m([[t.x+p],[1.25],[4*t.width]]),g=c.optimize(e,v,i,s,u,w,d,y,l,o);return g=g.p,[g[0],[g[1][0]*a],g[2]]}function a(r,t,o){var n=h(r),e=n[0],s=n[1],a=n[2],f=e.columns,u=[f/Math.sqrt(s.dot(s))],o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,1]),l=[],p=Math.abs(e[0][0]-e[1][0]),w=new m([[-p/1e4],[-.001],[-p/1e4]]),w=new m([[-Math.abs(e[0][0]-e[1][0])/1e3],[-.001],[-t.width/1e3]]),v=new m([[t.x],[1],[t.width]]),d=new m([[t.x-p],[.75],[t.width/4]]),y=new m([[t.x+p],[1.25],[4*t.width]]),g=c.optimize(i,v,e,s,u,w,d,y,l,o);return g=g.p,[g[0],[g[1][0]*a],g[2]]}function f(r,t,o){var e,i=h(r),s=i[0],a=i[1],f=i[2],u=s.columns,p=[u/l.sqrt(a.dot(a))],o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,1]),w=[],v=t.length,d=new m(3*v,1),y=new m(3*v,1),g=new m(3*v,1),M=new m(3*v,1),b=Math.abs(s[0][0]-s[1][0]);for(e=0;v>e;e++)d[e][0]=t[e].x,d[e+v][0]=1,d[e+2*v][0]=t[e].width,y[e][0]=t[e].x-b,y[e+v][0]=0,y[e+2*v][0]=t[e].width/4,g[e][0]=t[e].x+b,g[e+v][0]=1.5,g[e+2*v][0]=4*t[e].width,M[e][0]=-b/1e3,M[e+v][0]=-.001,M[e+2*v][0]=-b/1e3;var M=-Math.abs(s[0][0]-s[1][0])/1e4,x=c.optimize(n,d,s,a,p,M,y,g,w,o);x=x.p;var A=new Array(v);for(e=0;v>e;e++)A[e]=[x[e],[x[e+v][0]*f],x[e+2*v]];return A}function u(r,t,o){var e,i=h(r),s=i[0],a=i[1],f=i[2],u=s.rows,p=new m(u,1),w=u/l.sqrt(a.dot(a));for(e=0;u>e;e++)p[e][0]=w;var o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,2]),v=[],d=t.length,y=new m(3*d,1),g=new m(3*d,1),M=new m(3*d,1),b=new m(3*d,1),x=Math.abs(s[0][0]-s[1][0]);for(e=0;d>e;e++)y[e][0]=t[e].x,y[e+d][0]=t[e].y/f,y[e+2*d][0]=t[e].width,g[e][0]=t[e].x-x,g[e+d][0]=.8*t[e].y/f,g[e+2*d][0]=t[e].width/2,M[e][0]=t[e].x+x,M[e+d][0]=1.2*t[e].y/f,M[e+2*d][0]=2*t[e].width,b[e][0]=-x/1e3,b[e+d][0]=-.001,b[e+2*d][0]=-x/1e3;var A=c.optimize(n,y,s,a,p,b,g,M,v,o);A=A.p;var R=new Array(d);for(e=0;d>e;e++)R[e]=[A[e],[A[e+d][0]*f],A[e+2*d]];return R}function h(r){var t,o,n,e=r.length,i=null,s=null,a=0;if(2==e){var f=r[0].length;if(3>f)throw new SizeException(f);if(i=new m(f,1),s=new m(f,1),t=r[0],o=r[1],"number"==typeof t[0])for(n=0;f>n;n++)i[n][0]=t[n],s[n][0]=o[n],o[n]>a&&(a=o[n]);else if("object"==typeof t[0])for(n=0;f>n;n++)i[n][0]=t[n][0],s[n][0]=o[n][0],o[n][0]>a&&(a=o[n][0])}else{var f=e;if(3>f)throw new SizeException(f);for(i=new m(f,1),s=new m(f,1),n=0;f>n;n++)i[n][0]=r[n][0],s[n][0]=r[n][1],s[n][0]>a&&(a=s[n][0])}for(n=0;f>n;n++)s[n][0]/=a;return[i,s,a]}var c=o(3),l=c.Matrix.algebra,m=o(5);r.exports.optimizeSingleLorentzian=s,r.exports.optimizeLorentzianSum=f,r.exports.optimizeSingleGaussian=a,r.exports.optimizeGaussianSum=u,r.exports.singleGaussian=i,r.exports.singleLorentzian=e},function(r,t,o){"use strict";r.exports=o(4),r.exports.Matrix=o(5),r.exports.Matrix.algebra=o(14)},function(r,t,o){var n=o(5),e=o(14),i={optimize:function(r,t,o,i,s,a,f,u,h,c){var l=0,m=0;if("object"!=typeof t[0])for(var p=0;p<t.length;p++)t[p]=[t[p]];var p,w,v=-50,d=t.length,y=i.length,g=n.zeros(d,1),M=n.zeros(y,1),b=.01/v,x=.01/v,A=n.zeros(y,d);if(o.length!=i.length){console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=o.length,length_y_dat=i.length;var b=0;if(!l)return}s=s||Math.sqrt((y-d+1)/e.multiply(e.transpose(i),i)),a=a||.001,f=f||e.multiply(Math.abs(t),-100),u=u||e.multiply(Math.abs(t),100),h=h||1,c=c||[3,10*d,.001,.001,.001,.01,.01,11,9,1];var R=c[0],k=c[1],z=c[2],j=(c[3],c[4],c[5]),C=c[6],E=c[7],V=c[8],q=c[9];if(l&&3==R&&(R=2),!a.length||1==a.length){for(var D=new Array(d),p=0;d>p;p++)D[p]=[a];a=D}var S=[];for(p=0;p<a.length;p++)0!=a[p][0]&&S.push(p);var I=S.length,O=!1,_=null;if(!s.length||s.length<y){var L=e.multiply(n.ones(y,1),s[0]);_=e.dotMultiply(L,L)}else _=e.dotMultiply(s,s);var J=this.lm_matx(r,o,g,M,1,A,t,i,_,a,h),U=J.JtWJ,T=J.JtWdy,b=J.Chi_sq,W=J.y_hat,A=J.J;switch(Math.max(Math.abs(T))<z&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",z),O=!0),q){case 1:lambda=C;break;default:lambda=C*Math.max(e.diag(U)),nu=2}x=b;for(var G=null;!O&&k>=m;){switch(m+=1,q){case 1:G=e.solve(e.add(U,e.multiply(e.diag(e.diag(U)),lambda)),T);break;default:G=e.solve(e.add(U,e.multiply(n.eye(d),lambda)),T)}var Q=new Array(S.length);for(w=0;w<S.length;w++)Q[w]=G[S[w]];var F=e.add(t,Q);for(w=0;w<F.length;w++)F[w][0]=Math.min(Math.max(f[w][0],F[w][0]),u[w][0]);var P=e.subtract(i,r(o,F,h)),X=e.multiply(e.transpose(P),e.dotMultiply(P,_));if(2==q){var Y=e.multiply(e.transpose(T),G),N=e.multiply(Y,e.inv(e.add(e.multiply(e.subtract(X-b),.5)),e.multiply(Y,2)));G=e.multiply(N,G);for(var w=0;w<S.length;w++)Q[w]=G[S[w]];F=e.add(t,Q),F=e.min(e.max(f,F),u),P=e.subtract(i,r(o,F,h)),X=e.multiply(e.transpose(P),mat.dotMultiply(P,_))}var B=(b-X)/e.multiply(e.multiply(e.transpose(G),2),e.add(e.multiply(lambda,G),T));if(B>j)switch(dX2=b-x,x=b,g=t,M=W,t=F,J=this.lm_matx(r,o,g,M,dX2,A,t,i,_,a,h),U=J.JtWJ,T=J.JtWdy,b=J.Chi_sq,W=J.y_hat,A=J.J,q){case 1:lambda=Math.max(lambda/V,1e-7);break;case 2:lambda=Math.max(lambda/(1+N),1e-7);break;case 3:lambda=e.multiply(Math.max(1/3,1-(2*B-1)^3),lambda),nu=2}else switch(b=x,m%(2*d)==0&&(J=this.lm_matx(r,o,g,M,-1,A,t,i,_,a,h),U=J.JtWJ,T=J.JtWdy,dX2=J.Chi_sq,W=J.y_hat,A=J.J),q){case 1:lambda=Math.min(lambda*E,1e7);break;case 2:lambda+=Math.abs((X-b)/2/N);break;case 3:lambda*=nu,nu=2*nu}}return _=e.multiply(e.multiply(e.transpose(P),P),n.ones(y,1)),_.apply(function(r,t){_[r][t]=(y-I+1)/_[r][t]}),J=this.lm_matx(r,o,g,M,-1,A,t,i,_,a,h),U=J.JtWJ,T=J.JtWdy,b=J.Chi_sq,W=J.y_hat,A=J.J,{p:t,X2:b}},lm_FD_J:function(r,t,o,i,s,a){var f=i.length,u=o.length;s=s||e.multiply(n.ones(u,1),.001);for(var h=o.clone(),c=new n(f,u),l=new Array(u),m=0;u>m;m++){if(l[m]=s[m]*(1+Math.abs(o[m][0])),o[m]=[h[m][0]+l[m]],0!=l[m])if(y1=r(t,o,a),s[m][0]<0)for(var p=e.dotDivide(e.subtract(y1,i),l[m]),w=0;f>w;w++)c[w][m]=p[w][0];else{o[m][0]=h[m][0]-l[m];for(var p=e.dotDivide(e.subtract(y1,r(t,o,a)),2*l[m]),w=0;f>w;w++)c[w][m]=p[w][0]}o[m]=h[m]}return c},lm_Broyden_J:function(r,t,o,n,i){var s=e.subtract(n,r),a=e.transpose(s);return a.div(e.multiply(a,s)),o=e.add(o,e.multiply(e.subtract(i,e.add(t,e.multiply(o,s))),a))},lm_matx:function(r,t,o,i,s,a,f,u,h,c,l,m){var p=(u.length,f.length);c=c||.001;var w=r(t,f,l);a=m%(2*p)==0||s>0?this.lm_FD_J(r,t,f,w,c,l):this.lm_Broyden_J(o,i,a,f,w);var v=e.subtract(u,w),d=e.multiply(e.transpose(v),e.dotMultiply(v,h)),y=e.transpose(a),g=e.multiply(y,e.dotMultiply(a,e.multiply(h,n.ones(1,p)))),M=e.multiply(y,e.dotMultiply(h,v));return{JtWJ:g,JtWdy:M,Chi_sq:d,y_hat:w,J:a}}};r.exports=i},function(r,t,o){"use strict";r.exports=o(6),r.exports.Decompositions=r.exports.DC=o(7)},function(r,t){"use strict";function o(r){for(var t=0,o=r.length,n=new Array(o);o>t;t++)n[t]=r[t];return n}function n(r,t){var e,i,s=0;if(Array.isArray(r)){if(i=t,e=i?o(r):r,r=e.length,t=e[0].length,"undefined"==typeof t)throw new TypeError("Data must be a 2D array");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(;r>s;s++){if(e[s].length!==t)throw new RangeError("Inconsistent array dimensions");i&&(e[s]=o(e[s]))}}else{if("number"!=typeof r)throw new TypeError("Invalid arguments");if(!(r>0&&t>0))throw new RangeError("Invalid dimensions: "+r+"x"+t);for(e=new Array(r);r>s;s++)e[s]=new Array(t)}return Object.defineProperty(e,"rows",{writable:!0,value:r}),Object.defineProperty(e,"columns",{writable:!0,value:t}),e.__proto__=n.prototype,e}var e=Array.prototype.splice,i=Array.prototype.concat;n.from1DArray=function(r,t,o){var e,i,s=0;if(e=r*t,e!==o.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(r);r>s;s++)i[s]=o.slice(s*t,(s+1)*t);return new n(i)},n.rowVector=function(r){return new n([r])},n.columnVector=function(r){for(var t=r.length,o=new Array(t),e=0;t>e;e++)o[e]=[r[e]];return new n(o)},n.empty=function(r,t){return new n(r,t)},n.zeros=function(r,t){return n.empty(r,t).fill(0)},n.ones=function(r,t){return n.empty(r,t).fill(1)},n.rand=function(r,t){for(var o=n.empty(r,t),e=0,i=o.rows;i>e;e++)for(var s=0,a=o.columns;a>s;s++)o[e][s]=Math.random();return o},n.eye=function(r){for(var t=n.zeros(r,r),o=t.rows,e=0;o>e;e++)t[e][e]=1;return t},n.diag=function(r){for(var t=r.length,o=n.zeros(t,t),e=0;t>e;e++)o[e][e]=r[e];return o},n.indices=function(r,t){for(var o=new Array(t-r),n=0;n<o.length;n++)o[n]=r++;return o},n.stack=function(r){var t,o,e;if(n.isMatrix(r)){var i=0,s=0;for(t=0;t<arguments.length;t++)i+=arguments[t].rows,arguments[t].columns>s&&(s=arguments[t].columns);var a=n.zeros(i,s),f=0;for(t=0;t<arguments.length;t++){var u=arguments[t];for(o=0;o<u.rows;o++){for(e=0;e<u.columns;e++)a[f][e]=u[o][e];f++}}return a}if(Array.isArray(r)){var h=n.empty(arguments.length,r.length);for(t=0;t<arguments.length;t++)h.setRow(t,arguments[t]);return h}},n.expand=function(r,t){for(var o=[],e=0;e<t.length;e++)for(var i=0;i<t[e];i++)o.push(r[e]);return new n(o)},n.checkMatrix=function(r){if(!r)throw new TypeError("Argument has to be a matrix");return"Matrix"!==r.klass&&(r=new n(r)),r},n.isMatrix=function(r){return r?"Matrix"===r.klass:!1},Object.defineProperty(n.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(n.prototype,"size",{get:function(){return this.rows*this.columns}}),n.prototype.checkRowIndex=function(r){if(0>r||r>this.rows-1)throw new RangeError("Row index out of range.")},n.prototype.checkColumnIndex=function(r){if(0>r||r>this.columns-1)throw new RangeError("Column index out of range.")},n.prototype.checkDimensions=function(r){if(this.rows!==r.rows||this.columns!==r.columns)throw new RangeError("Matrices dimensions must be equal.")},n.prototype.apply=function(r){for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)r.call(this,n,e);return this},n.prototype.clone=function(){return new n(this.to2DArray())},n.prototype.to1DArray=function(){return i.apply([],this)},n.prototype.to2DArray=function(){for(var r=this.rows,t=new Array(r),n=0;r>n;n++)t[n]=o(this[n]);return t},n.prototype.isRowVector=function(){return 1===this.rows},n.prototype.isColumnVector=function(){return 1===this.columns},n.prototype.isVector=function(){return 1===this.rows||1===this.columns},n.prototype.isSquare=function(){return this.rows===this.columns},n.prototype.isSymmetric=function(){if(this.isSquare()){for(var r=this.rows,t=0;r>t;t++)for(var o=0;t>=o;o++)if(this[t][o]!==this[o][t])return!1;return!0}return!1},n.prototype.set=function(r,t,o){return this[r][t]=o,this},n.prototype.get=function(r,t){return this[r][t]},n.prototype.fill=function(r){for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]=r;return this},n.prototype.neg=function(){return this.mulS(-1)},n.prototype.add=function(r){return"number"==typeof r?this.addS(r):(r=n.checkMatrix(r),this.addM(r))},n.prototype.addS=function(r){for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]+=r;return this},n.prototype.addM=function(r){this.checkDimensions(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]+=r[n][e];return this},n.prototype.sub=function(r){return"number"==typeof r?this.subS(r):(r=n.checkMatrix(r),this.subM(r))},n.prototype.subS=function(r){for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]-=r;return this},n.prototype.subM=function(r){this.checkDimensions(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]-=r[n][e];return this},n.prototype.mul=function(r){return"number"==typeof r?this.mulS(r):(r=n.checkMatrix(r),this.mulM(r))},n.prototype.mulS=function(r){for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]*=r;return this},n.prototype.mulM=function(r){this.checkDimensions(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]*=r[n][e];return this},n.prototype.div=function(r){return"number"==typeof r?this.divS(r):(r=n.checkMatrix(r),this.divM(r))},n.prototype.divS=function(r){for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]/=r;return this},n.prototype.divM=function(r){this.checkDimensions(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]/=r[n][e];return this},n.prototype.getRow=function(r){return this.checkRowIndex(r),o(this[r])},n.prototype.getRowVector=function(r){return n.rowVector(this.getRow(r))},n.prototype.setRow=function(r,t){if(this.checkRowIndex(r),n.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return this[r]=o(t),this},n.prototype.removeRow=function(r){if(this.checkRowIndex(r),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return e.call(this,r,1),this.rows-=1,this},n.prototype.addRow=function(r,t){if("undefined"==typeof t&&(t=r,r=this.rows),0>r||r>this.rows)throw new RangeError("Row index out of range.");if(n.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("Invalid row size");return e.call(this,r,0,o(t)),this.rows+=1,this},n.prototype.swapRows=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);var o=this[r];return this[r]=this[t],this[t]=o,this},n.prototype.getColumn=function(r){this.checkColumnIndex(r);for(var t=this.rows,o=new Array(t),n=0;t>n;n++)o[n]=this[n][r];return o},n.prototype.getColumnVector=function(r){return n.columnVector(this.getColumn(r))},n.prototype.setColumn=function(r,t){this.checkColumnIndex(r),n.isMatrix(t)&&(t=t.to1DArray());var o=this.rows;if(t.length!==o)throw new RangeError("Invalid column size");for(var e=0;o>e;e++)this[e][r]=t[e];return this},n.prototype.removeColumn=function(r){if(this.checkColumnIndex(r),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0,o=this.rows;o>t;t++)this[t].splice(r,1);return this.columns-=1,this},n.prototype.addColumn=function(r,t){if("undefined"==typeof t&&(t=r,r=this.columns),0>r||r>this.columns)throw new RangeError("Column index out of range.");n.isMatrix(t)&&(t=t.to1DArray());var o=this.rows;if(t.length!==o)throw new RangeError("Invalid column size");for(var e=0;o>e;e++)this[e].splice(r,0,t[e]);return this.columns+=1,this},n.prototype.swapColumns=function(r,t){this.checkRowIndex(r),this.checkRowIndex(t);for(var o,n,e=this.rows,i=0;e>i;i++)n=this[i],o=n[r],n[r]=n[t],n[t]=o;return this},n.prototype.checkRowVector=function(r){if(n.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return r},n.prototype.checkColumnVector=function(r){if(n.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return r},n.prototype.addRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]+=r[e];return this},n.prototype.subRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]-=r[e];return this},n.prototype.mulRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]*=r[e];return this},n.prototype.divRowVector=function(r){r=this.checkRowVector(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]/=r[e];return this},n.prototype.addColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]+=r[n];return this},n.prototype.subColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]-=r[n];return this},n.prototype.mulColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]*=r[n];return this},n.prototype.divColumnVector=function(r){r=this.checkColumnVector(r);for(var t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]/=r[n];return this},n.prototype.mulRow=function(r,t){this.checkRowIndex(r);for(var o=0,n=this.columns;n>o;o++)this[r][o]*=t;return this},n.prototype.mulColumn=function(r,t){this.checkColumnIndex(r);for(var o=0,n=this.rows;n>o;o++)this[o][r]*=t},n.prototype.max=function(){for(var r=-(1/0),t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]>r&&(r=this[n][e]);return r},n.prototype.maxIndex=function(){for(var r=-(1/0),t={},o=this.rows,n=this.columns,e=0;o>e;e++)for(var i=0;n>i;i++)this[e][i]>r&&(r=this[e][i],t.row=e,t.column=i);return t},n.prototype.min=function(){for(var r=1/0,t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)this[n][e]<r&&(r=this[n][e]);return r},n.prototype.minIndex=function(){for(var r=1/0,t={},o=this.rows,n=this.columns,e=0;o>e;e++)for(var i=0;n>i;i++)this[e][i]<r&&(r=this[e][i],t.row=e,t.column=i);return t},n.prototype.maxRow=function(r){this.checkRowIndex(r);for(var t=-(1/0),o=0,n=this.columns;n>o;o++)this[r][o]>t&&(t=this[r][o]);return t},n.prototype.maxRowIndex=function(r){this.checkRowIndex(r);for(var t=-(1/0),o={row:r},n=0,e=this.columns;e>n;n++)this[r][n]>t&&(t=this[r][n],o.column=n);return o},n.prototype.minRow=function(r){this.checkRowIndex(r);for(var t=1/0,o=0,n=this.columns;n>o;o++)this[r][o]<t&&(t=this[r][o]);return t},n.prototype.minRowIndex=function(r){this.checkRowIndex(r);for(var t=1/0,o={row:r,column:0},n=0,e=this.columns;e>n;n++)this[r][n]<t&&(t=this[r][n],o.column=n);return o},n.prototype.maxColumn=function(r){this.checkColumnIndex(r);for(var t=-(1/0),o=0,n=this.rows;n>o;o++)this[o][r]>t&&(t=this[o][r]);return t},n.prototype.maxColumnIndex=function(r){this.checkColumnIndex(r);for(var t=-(1/0),o={row:0,column:r},n=0,e=this.rows;e>n;n++)this[n][r]>t&&(t=this[n][r],o.row=n);return o},n.prototype.minColumn=function(r){this.checkColumnIndex(r);for(var t=1/0,o=0,n=this.rows;n>o;o++)this[o][r]<t&&(t=this[o][r]);return t},n.prototype.minColumnIndex=function(r){this.checkColumnIndex(r);for(var t=1/0,o={row:0,column:r},n=0,e=this.rows;e>n;n++)this[n][r]<t&&(t=this[n][r],o.row=n);return o},n.prototype.diag=function s(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var s=new Array(this.rows),r=0,t=this.rows;t>r;r++)s[r]=this[r][r];return s},n.prototype.sum=function(){for(var r=0,t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)r+=this[n][e];return r},n.prototype.mean=function(){return this.sum()/this.size},n.prototype.prod=function a(){for(var a=1,r=this.rows,t=this.columns,o=0;r>o;o++)for(var n=0;t>n;n++)a*=this[o][n];return a},n.prototype.cumulativeSum=function(){for(var r=0,t=this.rows,o=this.columns,n=0;t>n;n++)for(var e=0;o>e;e++)r+=this[n][e],this[n][e]=r;return this},n.prototype.dot=function f(r){if(this.size!==r.size)throw new RangeError("vectors do not have the same size");for(var t=this.to1DArray(),o=r.to1DArray(),f=0,n=t.length,e=0;n>e;e++)f+=t[e]*o[e];return f},n.prototype.mmul=function(r){if(!n.isMatrix(r))throw new TypeError('parameter "other" must be a matrix');this.columns!==r.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var t,o,e,i=this.rows,s=this.columns,a=r.columns,f=new n(i,a),u=new Array(s);for(o=0;a>o;o++){for(e=0;s>e;e++)u[e]=r[e][o];for(t=0;i>t;t++){var h=this[t],c=0;for(e=0;s>e;e++)c+=h[e]*u[e];f[t][o]=c}}return f},n.prototype.sortRows=function(r){for(var t=0,o=this.rows;o>t;t++)this[t].sort(r);return this},n.prototype.sortColumns=function(r){for(var t=0,o=this.columns;o>t;t++)this.setColumn(t,this.getColumn(t).sort(r));return this},n.prototype.transpose=function(){for(var r=new n(this.columns,this.rows),t=this.rows,o=this.columns,e=0;t>e;e++)for(var i=0;o>i;i++)r[i][e]=this[e][i];return r},n.prototype.subMatrix=function(r,t,o,e){if(r>t||o>e||0>r||r>=this.rows||0>t||t>=this.rows||0>o||o>=this.columns||0>e||e>=this.columns)throw new RangeError("Argument out of range");for(var i=new n(t-r+1,e-o+1),s=r;t>=s;s++)for(var a=o;e>=a;a++)i[s-r][a-o]=this[s][a];return i},n.prototype.subMatrixRow=function(r,t,o){if("undefined"==typeof t?(t=0,o=this.columns-1):"undefined"==typeof o&&(o=this.columns-1),t>o||0>t||t>=this.columns||0>o||o>=this.columns)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.rows,s=new n(e,o-t+1),a=0;e>a;a++)for(var f=t;o>=f;f++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[a][f-t]=this[r[a]][f]}return s},n.prototype.subMatrixColumn=function(r,t,o){if("undefined"==typeof t?(t=0,o=this.rows-1):"undefined"==typeof o&&(o=this.rows-1),t>o||0>t||t>=this.rows||0>o||o>=this.rows)throw new RangeError("Argument out of range.");for(var e=r.length,i=this.columns,s=new n(o-t+1,e),a=0;e>a;a++)for(var f=t;o>=f;f++){if(r[a]<0||r[a]>=i)throw new RangeError("Argument out of range.");s[f-t][a]=this[f][r[a]]}return s},n.prototype.trace=function u(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var u=0,r=0,t=this.rows;t>r;r++)u+=this[r][r];return u},n.prototype.abs=function(){for(var r=this.rows,t=this.columns,o=0;r>o;o++)for(var n=0;t>n;n++)this[o][n]=Math.abs(this[o][n])},r.exports=n},function(r,t,o){"use strict";function n(r){return e(r,i.eye(r.rows))}function e(r,t){return r.isSquare()?new f(r).solve(t):new u(r).solve(t)}var i=o(6),s=o(8),a=o(10),f=o(11),u=o(12),h=o(13);i.prototype.inverse=function(){return n(this)},i.prototype.solve=function(r){return e(this,r)},r.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:f,LU:f,QrDecomposition:u,QR:u,CholeskyDecomposition:h,CHO:h,inverse:n,solve:e}},function(r,t,o){"use strict";function n(r,t){if(!(this instanceof n))return new n(r,t);r=e.checkMatrix(r),t=t||{};var o=r.clone(),s=r.rows,a=r.columns,f=Math.min(s,a),u=!0,h=!0;t.computeLeftSingularVectors===!1&&(u=!1),t.computeRightSingularVectors===!1&&(h=!1);var c=t.autoTranspose===!0,l=!1;if(a>s)if(c){o=o.transpose(),s=o.rows,a=o.columns,l=!0;var m=u;u=h,h=m}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,w,v,d,y,g,M,b,x,A,R,k,z,j,C,E,V,q,D,S,I,O=new Array(Math.min(s+1,a)),_=e.zeros(s,f),L=e.zeros(a,a),J=new Array(a),U=new Array(s),T=Math.min(s-1,a),W=Math.max(0,Math.min(a-2,s));for(v=0,A=Math.max(T,W);A>v;v++){if(T>v){for(O[v]=0,p=v;s>p;p++)O[v]=i(O[v],o[p][v]);if(0!==O[v]){for(o[v][v]<0&&(O[v]=-O[v]),p=v;s>p;p++)o[p][v]/=O[v];o[v][v]+=1}O[v]=-O[v]}for(w=v+1;a>w;w++){if(T>v&&0!==O[v]){for(y=0,p=v;s>p;p++)y+=o[p][v]*o[p][w];for(y=-y/o[v][v],p=v;s>p;p++)o[p][w]+=y*o[p][v]}J[w]=o[v][w]}if(u&&T>v)for(p=v;s>p;p++)_[p][v]=o[p][v];if(W>v){for(J[v]=0,p=v+1;a>p;p++)J[v]=i(J[v],J[p]);if(0!==J[v]){for(J[v+1]<0&&(J[v]=-J[v]),p=v+1;a>p;p++)J[p]/=J[v];J[v+1]+=1}if(J[v]=-J[v],s>v+1&&0!==J[v]){for(p=v+1;s>p;p++)U[p]=0;for(w=v+1;a>w;w++)for(p=v+1;s>p;p++)U[p]+=J[w]*o[p][w];for(w=v+1;a>w;w++)for(y=-J[w]/J[v+1],p=v+1;s>p;p++)o[p][w]+=y*U[p]}if(h)for(p=v+1;a>p;p++)L[p][v]=J[p]}}if(d=Math.min(a,s+1),a>T&&(O[T]=o[T][T]),d>s&&(O[d-1]=0),d>W+1&&(J[W]=o[W][d-1]),J[d-1]=0,u){for(w=T;f>w;w++){for(p=0;s>p;p++)_[p][w]=0;_[w][w]=1}for(v=T-1;v>=0;v--)if(0!==O[v]){for(w=v+1;f>w;w++){for(y=0,p=v;s>p;p++)y+=_[p][v]*_[p][w];for(y=-y/_[v][v],p=v;s>p;p++)_[p][w]+=y*_[p][v]}for(p=v;s>p;p++)_[p][v]=-_[p][v];for(_[v][v]=1+_[v][v],p=0;v-1>p;p++)_[p][v]=0}else{for(p=0;s>p;p++)_[p][v]=0;_[v][v]=1}}if(h)for(v=a-1;v>=0;v--){if(W>v&&0!==J[v])for(w=v+1;a>w;w++){for(y=0,p=v+1;a>p;p++)y+=L[p][v]*L[p][w];for(y=-y/L[v+1][v],p=v+1;a>p;p++)L[p][w]+=y*L[p][v]}for(p=0;a>p;p++)L[p][v]=0;L[v][v]=1}for(var G=d-1,Q=0,F=Math.pow(2,-52);d>0;){for(v=d-2;v>=-1&&-1!==v;v--)if(Math.abs(J[v])<=F*(Math.abs(O[v])+Math.abs(O[v+1]))){J[v]=0;break}if(v===d-2)R=4;else{for(g=d-1;g>=v&&g!==v;g--)if(y=(g!==d?Math.abs(J[g]):0)+(g!==v+1?Math.abs(J[g-1]):0),Math.abs(O[g])<=F*y){O[g]=0;break}g===v?R=3:g===d-1?R=1:(R=2,v=g)}switch(v++,R){case 1:for(M=J[d-2],J[d-2]=0,w=d-2;w>=v;w--)if(y=i(O[w],M),b=O[w]/y,x=M/y,O[w]=y,w!==v&&(M=-x*J[w-1],J[w-1]=b*J[w-1]),h)for(p=0;a>p;p++)y=b*L[p][w]+x*L[p][d-1],L[p][d-1]=-x*L[p][w]+b*L[p][d-1],L[p][w]=y;break;case 2:for(M=J[v-1],J[v-1]=0,w=v;d>w;w++)if(y=i(O[w],M),b=O[w]/y,x=M/y,O[w]=y,M=-x*J[w],J[w]=b*J[w],u)for(p=0;s>p;p++)y=b*_[p][w]+x*_[p][v-1],_[p][v-1]=-x*_[p][w]+b*_[p][v-1],_[p][w]=y;break;case 3:for(k=Math.max(Math.max(Math.max(Math.max(Math.abs(O[d-1]),Math.abs(O[d-2])),Math.abs(J[d-2])),Math.abs(O[v])),Math.abs(J[v])),z=O[d-1]/k,j=O[d-2]/k,C=J[d-2]/k,E=O[v]/k,V=J[v]/k,q=((j+z)*(j-z)+C*C)/2,D=z*C*(z*C),S=0,(0!==q||0!==D)&&(S=Math.sqrt(q*q+D),0>q&&(S=-S),S=D/(q+S)),M=(E+z)*(E-z)+S,I=E*V,w=v;d-1>w;w++){if(y=i(M,I),b=M/y,x=I/y,w!==v&&(J[w-1]=y),M=b*O[w]+x*J[w],J[w]=b*J[w]-x*O[w],I=x*O[w+1],O[w+1]=b*O[w+1],h)for(p=0;a>p;p++)y=b*L[p][w]+x*L[p][w+1],L[p][w+1]=-x*L[p][w]+b*L[p][w+1],L[p][w]=y;if(y=i(M,I),b=M/y,x=I/y,O[w]=y,M=b*J[w]+x*O[w+1],O[w+1]=-x*J[w]+b*O[w+1],I=x*J[w+1],J[w+1]=b*J[w+1],u&&s-1>w)for(p=0;s>p;p++)y=b*_[p][w]+x*_[p][w+1],_[p][w+1]=-x*_[p][w]+b*_[p][w+1],_[p][w]=y}J[d-2]=M,Q+=1;break;case 4:if(O[v]<=0&&(O[v]=O[v]<0?-O[v]:0,h))for(p=0;G>=p;p++)L[p][v]=-L[p][v];for(;G>v&&!(O[v]>=O[v+1]);){if(y=O[v],O[v]=O[v+1],O[v+1]=y,h&&a-1>v)for(p=0;a>p;p++)y=L[p][v+1],L[p][v+1]=L[p][v],L[p][v]=y;if(u&&s-1>v)for(p=0;s>p;p++)y=_[p][v+1],_[p][v+1]=_[p][v],_[p][v]=y;v++}Q=0,d--}}if(l){var P=L;L=_,_=P}this.m=s,this.n=a,this.s=O,this.U=_,this.V=L}var e=o(6),i=o(9).hypotenuse;n.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var r=Math.pow(2,-52),t=Math.max(this.m,this.n)*this.s[0]*r,o=0,n=this.s,e=0,i=n.length;i>e;e++)n[e]>t&&o++;return o},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(r){var t,o=r,n=this.threshold,i=this.s.length,s=e.zeros(i,i);for(t=0;i>t;t++)Math.abs(this.s[t])<=n?s[t][t]=0:s[t][t]=1/this.s[t];var a,f,u,h=this.V.mmul(s),c=this.V.rows,l=this.U.rows,m=e.zeros(c,l);for(t=0;c>t;t++)for(a=0;l>a;a++){for(u=0,f=0;i>f;f++)u+=h[t][f]*this.U[a][f];m[t][a]=u}return m.mmul(o)},solveForDiagonal:function(r){return this.solve(e.diag(r))},inverse:function(){var r,t,o=this.threshold,n=this.V.rows,i=this.V.columns,s=new e(n,this.s.length);for(r=0;n>r;r++)for(t=0;i>t;t++)Math.abs(this.s[t])>o?s[r][t]=this.V[r][t]/this.s[t]:s[r][t]=0;var a,f,u=this.U.rows,h=this.U.columns,c=new e(n,u);for(r=0;n>r;r++)for(t=0;u>t;t++){for(f=0,a=0;h>a;a++)f+=s[r][a]*this.U[t][a];c[r][t]=f}return c}},r.exports=n},function(r,t){"use strict";t.hypotenuse=function(r,t){var o;return Math.abs(r)>Math.abs(t)?(o=t/r,Math.abs(r)*Math.sqrt(1+o*o)):0!==t?(o=r/t,Math.abs(t)*Math.sqrt(1+o*o)):0}},function(r,t,o){"use strict";function n(r){if(!(this instanceof n))return new n(r);if(r=u.checkMatrix(r),!r.isSquare())throw new Error("Matrix is not a square matrix");var t,o,f=r.columns,h=u.zeros(f,f),c=new Array(f),l=new Array(f),m=r;if(r.isSymmetric()){for(t=0;f>t;t++)for(o=0;f>o;o++)h[t][o]=m[t][o];e(f,l,c,h),i(f,l,c,h)}else{var p=u.zeros(f,f),w=new Array(f);for(o=0;f>o;o++)for(t=0;f>t;t++)p[t][o]=m[t][o];s(f,p,w,h),a(f,l,c,h,p)}this.n=f,this.e=l,this.d=c,this.V=h}function e(r,t,o,n){var e,i,s,a,f,u,h,c;for(f=0;r>f;f++)o[f]=n[r-1][f];for(a=r-1;a>0;a--){for(c=0,s=0,u=0;a>u;u++)c+=Math.abs(o[u]);if(0===c)for(t[a]=o[a-1],f=0;a>f;f++)o[f]=n[a-1][f],n[a][f]=0,n[f][a]=0;else{for(u=0;a>u;u++)o[u]/=c,s+=o[u]*o[u];for(e=o[a-1],i=Math.sqrt(s),e>0&&(i=-i),t[a]=c*i,s-=e*i,o[a-1]=e-i,f=0;a>f;f++)t[f]=0;for(f=0;a>f;f++){for(e=o[f],n[f][a]=e,i=t[f]+n[f][f]*e,u=f+1;a-1>=u;u++)i+=n[u][f]*o[u],t[u]+=n[u][f]*e;t[f]=i}for(e=0,f=0;a>f;f++)t[f]/=s,e+=t[f]*o[f];for(h=e/(s+s),f=0;a>f;f++)t[f]-=h*o[f];for(f=0;a>f;f++){for(e=o[f],i=t[f],u=f;a-1>=u;u++)n[u][f]-=e*t[u]+i*o[u];o[f]=n[a-1][f],n[a][f]=0}}o[a]=s}for(a=0;r-1>a;a++){if(n[r-1][a]=n[a][a],n[a][a]=1,s=o[a+1],0!==s){for(u=0;a>=u;u++)o[u]=n[u][a+1]/s;for(f=0;a>=f;f++){for(i=0,u=0;a>=u;u++)i+=n[u][a+1]*n[u][f];for(u=0;a>=u;u++)n[u][f]-=i*o[u]}}for(u=0;a>=u;u++)n[u][a+1]=0}for(f=0;r>f;f++)o[f]=n[r-1][f],n[r-1][f]=0;n[r-1][r-1]=1,t[0]=0}function i(r,t,o,n){var e,i,s,a,f,u,c,l,m,p,w,v,d,y,g,M,b;for(s=1;r>s;s++)t[s-1]=t[s];t[r-1]=0;var x=0,A=0,R=Math.pow(2,-52);for(u=0;r>u;u++){for(A=Math.max(A,Math.abs(o[u])+Math.abs(t[u])),c=u;r>c&&!(Math.abs(t[c])<=R*A);)c++;if(c>u){b=0;do{for(b+=1,e=o[u],l=(o[u+1]-e)/(2*t[u]),m=h(l,1),0>l&&(m=-m),o[u]=t[u]/(l+m),o[u+1]=t[u]*(l+m),p=o[u+1],i=e-o[u],s=u+2;r>s;s++)o[s]-=i;for(x+=i,l=o[c],w=1,v=w,d=w,y=t[u+1],g=0,M=0,s=c-1;s>=u;s--)for(d=v,v=w,M=g,e=w*t[s],i=w*l,m=h(l,t[s]),t[s+1]=g*m,g=t[s]/m,w=l/m,l=w*o[s]-g*e,o[s+1]=i+g*(w*e+g*o[s]),f=0;r>f;f++)i=n[f][s+1],n[f][s+1]=g*n[f][s]+w*i,n[f][s]=w*n[f][s]-g*i;l=-g*M*d*y*t[u]/p,t[u]=g*l,o[u]=w*l}while(Math.abs(t[u])>R*A)}o[u]=o[u]+x,t[u]=0}for(s=0;r-1>s;s++){for(f=s,l=o[s],a=s+1;r>a;a++)o[a]<l&&(f=a,l=o[a]);if(f!==s)for(o[f]=o[s],o[s]=l,a=0;r>a;a++)l=n[a][s],
n[a][s]=n[a][f],n[a][f]=l}}function s(r,t,o,n){var e,i,s,a,f,u,h,c=0,l=r-1;for(u=c+1;l-1>=u;u++){for(h=0,a=u;l>=a;a++)h+=Math.abs(t[a][u-1]);if(0!==h){for(s=0,a=l;a>=u;a--)o[a]=t[a][u-1]/h,s+=o[a]*o[a];for(i=Math.sqrt(s),o[u]>0&&(i=-i),s-=o[u]*i,o[u]=o[u]-i,f=u;r>f;f++){for(e=0,a=l;a>=u;a--)e+=o[a]*t[a][f];for(e/=s,a=u;l>=a;a++)t[a][f]-=e*o[a]}for(a=0;l>=a;a++){for(e=0,f=l;f>=u;f--)e+=o[f]*t[a][f];for(e/=s,f=u;l>=f;f++)t[a][f]-=e*o[f]}o[u]=h*o[u],t[u][u-1]=h*i}}for(a=0;r>a;a++)for(f=0;r>f;f++)n[a][f]=a===f?1:0;for(u=l-1;u>=c+1;u--)if(0!==t[u][u-1]){for(a=u+1;l>=a;a++)o[a]=t[a][u-1];for(f=u;l>=f;f++){for(i=0,a=u;l>=a;a++)i+=o[a]*n[a][f];for(i=i/o[u]/t[u][u-1],a=u;l>=a;a++)n[a][f]+=i*o[a]}}}function a(r,t,o,n,e){var i,s,a,u,h,c,l,m,p,w,v,d,y,g,M,b=r-1,x=0,A=r-1,R=Math.pow(2,-52),k=0,z=0,j=0,C=0,E=0,V=0,q=0,D=0;for(i=0;r>i;i++)for((x>i||i>A)&&(o[i]=e[i][i],t[i]=0),s=Math.max(i-1,0);r>s;s++)z+=Math.abs(e[i][s]);for(;b>=x;){for(u=b;u>x&&(V=Math.abs(e[u-1][u-1])+Math.abs(e[u][u]),0===V&&(V=z),!(Math.abs(e[u][u-1])<R*V));)u--;if(u===b)e[b][b]=e[b][b]+k,o[b]=e[b][b],t[b]=0,b--,D=0;else if(u===b-1){if(l=e[b][b-1]*e[b-1][b],j=(e[b-1][b-1]-e[b][b])/2,C=j*j+l,q=Math.sqrt(Math.abs(C)),e[b][b]=e[b][b]+k,e[b-1][b-1]=e[b-1][b-1]+k,m=e[b][b],C>=0){for(q=j>=0?j+q:j-q,o[b-1]=m+q,o[b]=o[b-1],0!==q&&(o[b]=m-l/q),t[b-1]=0,t[b]=0,m=e[b][b-1],V=Math.abs(m)+Math.abs(q),j=m/V,C=q/V,E=Math.sqrt(j*j+C*C),j/=E,C/=E,s=b-1;r>s;s++)q=e[b-1][s],e[b-1][s]=C*q+j*e[b][s],e[b][s]=C*e[b][s]-j*q;for(i=0;b>=i;i++)q=e[i][b-1],e[i][b-1]=C*q+j*e[i][b],e[i][b]=C*e[i][b]-j*q;for(i=x;A>=i;i++)q=n[i][b-1],n[i][b-1]=C*q+j*n[i][b],n[i][b]=C*n[i][b]-j*q}else o[b-1]=m+j,o[b]=m+j,t[b-1]=q,t[b]=-q;b-=2,D=0}else{if(m=e[b][b],p=0,l=0,b>u&&(p=e[b-1][b-1],l=e[b][b-1]*e[b-1][b]),10===D){for(k+=m,i=x;b>=i;i++)e[i][i]-=m;V=Math.abs(e[b][b-1])+Math.abs(e[b-1][b-2]),m=p=.75*V,l=-.4375*V*V}if(30===D&&(V=(p-m)/2,V=V*V+l,V>0)){for(V=Math.sqrt(V),m>p&&(V=-V),V=m-l/((p-m)/2+V),i=x;b>=i;i++)e[i][i]-=V;k+=V,m=p=l=.964}for(D+=1,h=b-2;h>=u&&(q=e[h][h],E=m-q,V=p-q,j=(E*V-l)/e[h+1][h]+e[h][h+1],C=e[h+1][h+1]-q-E-V,E=e[h+2][h+1],V=Math.abs(j)+Math.abs(C)+Math.abs(E),j/=V,C/=V,E/=V,h!==u)&&!(Math.abs(e[h][h-1])*(Math.abs(C)+Math.abs(E))<R*(Math.abs(j)*(Math.abs(e[h-1][h-1])+Math.abs(q)+Math.abs(e[h+1][h+1]))));)h--;for(i=h+2;b>=i;i++)e[i][i-2]=0,i>h+2&&(e[i][i-3]=0);for(a=h;b-1>=a&&(g=a!==b-1,a!==h&&(j=e[a][a-1],C=e[a+1][a-1],E=g?e[a+2][a-1]:0,m=Math.abs(j)+Math.abs(C)+Math.abs(E),0!==m&&(j/=m,C/=m,E/=m)),0!==m);a++)if(V=Math.sqrt(j*j+C*C+E*E),0>j&&(V=-V),0!==V){for(a!==h?e[a][a-1]=-V*m:u!==h&&(e[a][a-1]=-e[a][a-1]),j+=V,m=j/V,p=C/V,q=E/V,C/=j,E/=j,s=a;r>s;s++)j=e[a][s]+C*e[a+1][s],g&&(j+=E*e[a+2][s],e[a+2][s]=e[a+2][s]-j*q),e[a][s]=e[a][s]-j*m,e[a+1][s]=e[a+1][s]-j*p;for(i=0;i<=Math.min(b,a+3);i++)j=m*e[i][a]+p*e[i][a+1],g&&(j+=q*e[i][a+2],e[i][a+2]=e[i][a+2]-j*E),e[i][a]=e[i][a]-j,e[i][a+1]=e[i][a+1]-j*C;for(i=x;A>=i;i++)j=m*n[i][a]+p*n[i][a+1],g&&(j+=q*n[i][a+2],n[i][a+2]=n[i][a+2]-j*E),n[i][a]=n[i][a]-j,n[i][a+1]=n[i][a+1]-j*C}}}if(0!==z){for(b=r-1;b>=0;b--)if(j=o[b],C=t[b],0===C)for(u=b,e[b][b]=1,i=b-1;i>=0;i--){for(l=e[i][i]-j,E=0,s=u;b>=s;s++)E+=e[i][s]*e[s][b];if(t[i]<0)q=l,V=E;else if(u=i,0===t[i]?e[i][b]=0!==l?-E/l:-E/(R*z):(m=e[i][i+1],p=e[i+1][i],C=(o[i]-j)*(o[i]-j)+t[i]*t[i],c=(m*V-q*E)/C,e[i][b]=c,e[i+1][b]=Math.abs(m)>Math.abs(q)?(-E-l*c)/m:(-V-p*c)/q),c=Math.abs(e[i][b]),R*c*c>1)for(s=i;b>=s;s++)e[s][b]=e[s][b]/c}else if(0>C)for(u=b-1,Math.abs(e[b][b-1])>Math.abs(e[b-1][b])?(e[b-1][b-1]=C/e[b][b-1],e[b-1][b]=-(e[b][b]-j)/e[b][b-1]):(M=f(0,-e[b-1][b],e[b-1][b-1]-j,C),e[b-1][b-1]=M[0],e[b-1][b]=M[1]),e[b][b-1]=0,e[b][b]=1,i=b-2;i>=0;i--){for(w=0,v=0,s=u;b>=s;s++)w+=e[i][s]*e[s][b-1],v+=e[i][s]*e[s][b];if(l=e[i][i]-j,t[i]<0)q=l,E=w,V=v;else if(u=i,0===t[i]?(M=f(-w,-v,l,C),e[i][b-1]=M[0],e[i][b]=M[1]):(m=e[i][i+1],p=e[i+1][i],d=(o[i]-j)*(o[i]-j)+t[i]*t[i]-C*C,y=2*(o[i]-j)*C,0===d&&0===y&&(d=R*z*(Math.abs(l)+Math.abs(C)+Math.abs(m)+Math.abs(p)+Math.abs(q))),M=f(m*E-q*w+C*v,m*V-q*v-C*w,d,y),e[i][b-1]=M[0],e[i][b]=M[1],Math.abs(m)>Math.abs(q)+Math.abs(C)?(e[i+1][b-1]=(-w-l*e[i][b-1]+C*e[i][b])/m,e[i+1][b]=(-v-l*e[i][b]-C*e[i][b-1])/m):(M=f(-E-p*e[i][b-1],-V-p*e[i][b],q,C),e[i+1][b-1]=M[0],e[i+1][b]=M[1])),c=Math.max(Math.abs(e[i][b-1]),Math.abs(e[i][b])),R*c*c>1)for(s=i;b>=s;s++)e[s][b-1]=e[s][b-1]/c,e[s][b]=e[s][b]/c}for(i=0;r>i;i++)if(x>i||i>A)for(s=i;r>s;s++)n[i][s]=e[i][s];for(s=r-1;s>=x;s--)for(i=x;A>=i;i++){for(q=0,a=x;a<=Math.min(s,A);a++)q+=n[i][a]*e[a][s];n[i][s]=q}}}function f(r,t,o,n){var e,i;return Math.abs(o)>Math.abs(n)?(e=n/o,i=o+e*n,[(r+e*t)/i,(t-e*r)/i]):(e=o/n,i=n+e*o,[(e*r+t)/i,(e*t-r)/i])}var u=o(6),h=o(9).hypotenuse;n.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var r,t,o=this.n,n=this.e,e=this.d,i=new u(o,o);for(r=0;o>r;r++){for(t=0;o>t;t++)i[r][t]=0;i[r][r]=e[r],n[r]>0?i[r][r+1]=n[r]:n[r]<0&&(i[r][r-1]=n[r])}return i}},r.exports=n},function(r,t,o){"use strict";function n(r){if(!(this instanceof n))return new n(r);r=e.checkMatrix(r);var t,o,i,s,a,f,u,h,c,l,m=r.clone(),p=m.rows,w=m.columns,v=new Array(p),d=1;for(t=0;p>t;t++)v[t]=t;for(c=new Array(p),o=0;w>o;o++){for(t=0;p>t;t++)c[t]=m[t][o];for(t=0;p>t;t++){for(h=m[t],l=Math.min(t,o),a=0,i=0;l>i;i++)a+=h[i]*c[i];h[o]=c[t]-=a}for(s=o,t=o+1;p>t;t++)Math.abs(c[t])>Math.abs(c[s])&&(s=t);if(s!==o){for(i=0;w>i;i++)f=m[s][i],m[s][i]=m[o][i],m[o][i]=f;u=v[s],v[s]=v[o],v[o]=u,d=-d}if(p>o&&0!==m[o][o])for(t=o+1;p>t;t++)m[t][o]/=m[o][o]}this.LU=m,this.pivotVector=v,this.pivotSign=d}var e=o(6);n.prototype={isSingular:function(){for(var r=this.LU,t=r.columns,o=0;t>o;o++)if(0===r[o][o])return!0;return!1},get determinant(){var r=this.LU;if(!r.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,o=r.columns,n=0;o>n;n++)t*=r[n][n];return t},get lowerTriangularFactor(){for(var r=this.LU,t=r.rows,o=r.columns,n=new e(t,o),i=0;t>i;i++)for(var s=0;o>s;s++)i>s?n[i][s]=r[i][s]:i===s?n[i][s]=1:n[i][s]=0;return n},get upperTriangularFactor(){for(var r=this.LU,t=r.rows,o=r.columns,n=new e(t,o),i=0;t>i;i++)for(var s=0;o>s;s++)s>=i?n[i][s]=r[i][s]:n[i][s]=0;return n},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(r){r=e.checkMatrix(r);var t=this.LU,o=t.rows;if(o!==r.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,i,s,a=r.columns,f=r.subMatrixRow(this.pivotVector,0,a-1),u=t.columns;for(s=0;u>s;s++)for(n=s+1;u>n;n++)for(i=0;a>i;i++)f[n][i]-=f[s][i]*t[n][s];for(s=u-1;s>=0;s--){for(i=0;a>i;i++)f[s][i]/=t[s][s];for(n=0;s>n;n++)for(i=0;a>i;i++)f[n][i]-=f[s][i]*t[n][s]}return f}},r.exports=n},function(r,t,o){"use strict";function n(r){if(!(this instanceof n))return new n(r);r=e.checkMatrix(r);var t,o,s,a,f=r.clone(),u=r.rows,h=r.columns,c=new Array(h);for(s=0;h>s;s++){var l=0;for(t=s;u>t;t++)l=i(l,f[t][s]);if(0!==l){for(f[s][s]<0&&(l=-l),t=s;u>t;t++)f[t][s]/=l;for(f[s][s]+=1,o=s+1;h>o;o++){for(a=0,t=s;u>t;t++)a+=f[t][s]*f[t][o];for(a=-a/f[s][s],t=s;u>t;t++)f[t][o]+=a*f[t][s]}}c[s]=-l}this.QR=f,this.Rdiag=c}var e=o(6),i=o(9).hypotenuse;n.prototype={solve:function(r){r=e.checkMatrix(r);var t=this.QR,o=t.rows;if(r.rows!==o)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,i,s,a,f=r.columns,u=r.clone(),h=t.columns;for(s=0;h>s;s++)for(i=0;f>i;i++){for(a=0,n=s;o>n;n++)a+=t[n][s]*u[n][i];for(a=-a/t[s][s],n=s;o>n;n++)u[n][i]+=a*t[n][s]}for(s=h-1;s>=0;s--){for(i=0;f>i;i++)u[s][i]/=this.Rdiag[s];for(n=0;s>n;n++)for(i=0;f>i;i++)u[n][i]-=u[s][i]*t[n][s]}return u.subMatrix(0,h-1,0,f-1)},isFullRank:function(){for(var r=this.QR.columns,t=0;r>t;t++)if(0===this.Rdiag[t])return!1;return!0},get upperTriangularFactor(){var r,t,o=this.QR,n=o.columns,i=new e(n,n);for(r=0;n>r;r++)for(t=0;n>t;t++)t>r?i[r][t]=o[r][t]:r===t?i[r][t]=this.Rdiag[r]:i[r][t]=0;return i},get orthogonalFactor(){var r,t,o,n,i=this.QR,s=i.rows,a=i.columns,f=new e(s,a);for(o=a-1;o>=0;o--){for(r=0;s>r;r++)f[r][o]=0;for(f[o][o]=1,t=o;a>t;t++)if(0!==i[o][o]){for(n=0,r=o;s>r;r++)n+=i[r][o]*f[r][t];for(n=-n/i[o][o],r=o;s>r;r++)f[r][t]+=n*i[r][o]}}return f}},r.exports=n},function(r,t,o){"use strict";function n(r){if(!(this instanceof n))return new n(r);if(r=e.checkMatrix(r),!r.isSymmetric())throw new Error("Matrix is not symmetric");var t,o,i,s=r,a=s.rows,f=new e(a,a),u=!0;for(o=0;a>o;o++){var h=f[o],c=0;for(i=0;o>i;i++){var l=f[i],m=0;for(t=0;i>t;t++)m+=l[t]*h[t];h[i]=m=(s[o][i]-m)/f[i][i],c+=m*m}for(c=s[o][o]-c,u&=c>0,f[o][o]=Math.sqrt(Math.max(c,0)),i=o+1;a>i;i++)f[o][i]=0}if(!u)throw new Error("Matrix is not positive definite");this.L=f}var e=o(6);n.prototype={get leftTriangularFactor(){return this.L},solve:function(r){r=e.checkMatrix(r);var t=this.L,o=t.rows;if(r.rows!==o)throw new Error("Matrix dimensions do not match");var n,i,s,a=r.columns,f=r.clone();for(s=0;o>s;s++)for(i=0;a>i;i++){for(n=0;s>n;n++)f[s][i]-=f[n][i]*t[s][n];f[s][i]/=t[s][s]}for(s=o-1;s>=0;s--)for(i=0;a>i;i++){for(n=s+1;o>n;n++)f[s][i]-=f[n][i]*t[n][s];f[s][i]/=t[s][s]}return f}},r.exports=n},function(r,t,o){"use strict";function n(r,t){return new A(r,t)}function e(r,t){return A.ones(r,t)}function i(r,t){return A.eye(r,t)}function s(r,t){return A.zeros(r,t)}function a(r,t){return A.rand(r,t)}function f(r){if("number"==typeof r)return r;var t=r.clone();return t.transpose()}function u(r,t){if("number"==typeof r&&"number"==typeof t)return r+t;if("number"==typeof r)return this.add(t,r);var o=r.clone();return o.add(t)}function h(r,t){if("number"==typeof r&&"number"==typeof t)return r-t;if("number"==typeof r)return this.subtract(t,r);var o=r.clone();return o.sub(t)}function c(r,t){if("number"==typeof r&&"number"==typeof t)return r*t;if("number"==typeof r)return this.multiply(t,r);var o=r.clone();return"number"==typeof t?o.mul(t):o=o.mmul(t),1==o.rows&&1==o.columns?o[0][0]:o}function l(r,t){var o=r.clone();return o.mul(t)}function m(r,t){var o=r.clone();return o.div(t)}function p(r){var t,o,n=null,e=r.rows,i=r.columns;if("undefined"==typeof i&&"object"==typeof r)if(r[0]&&r[0].length)for(e=r.length,i=r[0].length,o=Math.min(e,i),n=A.zeros(i,i),t=0;i>t;t++)n[t][t]=r[t][t];else for(i=r.length,n=A.zeros(i,i),t=0;i>t;t++)n[t][t]=r[t];if(1==e)for(n=A.zeros(i,i),t=0;i>t;t++)n[t][t]=r[0][t];else if(e>0&&i>0)for(o=Math.min(e,i),n=new Array(o),t=0;o>t;t++)n[t]=r[t][t];return n}function w(r,t){if("number"==typeof r&&"number"==typeof t)return Math.min(r,t);for(var o=r.rows,n=r.columns,e=new A(o,n),i=0;o>i;i++)for(var s=0;n>s;s++)r[i][s]<t[i][s]?e[i][s]=r[i][s]:e[i][s]=t[i][s];return e}function v(r,t){if("number"==typeof r&&"number"==typeof t)return Math.max(r,t);for(var o=r.rows,n=r.columns,e=new A(o,n),i=0;o>i;i++)for(var s=0;n>s;s++)r[i][s]>t[i][s]?e[i][s]=r[i][s]:e[i][s]=t[i][s];return e}function d(r){if("number"==typeof r)return Math.sqrt(r);for(var t=r.rows,o=r.columns,n=new A(t,o),e=0;t>e;e++)for(var i=0;o>i;i++)n[e][i]=Math.sqrt(r[e][i]);return n}function y(r){if("number"==typeof r)return Math.abs(r);for(var t=r.rows,o=r.columns,n=new A(t,o),e=0;t>e;e++)for(var i=0;o>i;i++)n[e][i]=Math.abs(r[e][i]);return n}function g(r){if("number"==typeof r)return Math.sqrt(r);for(var t=r.rows,o=r.columns,n=new A(t,o),e=0;t>e;e++)for(var i=0;o>i;i++)n[e][i]=Math.exp(r[e][i]);return n}function M(r,t){if("number"==typeof r)return Math.pow(r,t);for(var o=r.rows,n=r.columns,e=new A(o,n),i=0;o>i;i++)for(var s=0;n>s;s++)e[i][s]=Math.pow(r[i][s],t);return e}function b(r,t){return r.solve(t)}function x(r){return"number"==typeof r?1/r:r.inverse()}var A=o(5);r.exports={transpose:f,add:u,subtract:h,multiply:c,dotMultiply:l,dotDivide:m,diag:p,min:w,max:v,solve:b,inv:x,sqrt:d,exp:g,dotPow:M,abs:y,matrix:n,ones:e,zeros:s,random:a,eye:i}},function(r,t,o){function n(r,t,o){var o=Object.create(o||{});void 0===o.minMaxRatio&&(o.minMaxRatio=25e-5),void 0===o.broadRatio&&(o.broadRatio=0),void 0===o.noiseLevel&&(o.noiseLevel=0),void 0===o.maxCriteria&&(o.maxCriteria=!0),void 0===o.smoothY&&(o.smoothY=!0),void 0===o.realTopDetection&&(o.realTopDetection=!1);var n={m:1,b:0};if(!o.maxCriteria||o.noiseLevel>0){if(t=[].concat(t),!o.maxCriteria){n={m:-1,b:i.array.max(t)};for(var s=0;s<t.length;s++)t[s]=-t[s]+n.b;o.noiseLevel=-o.noiseLevel+n.b}if(o.noiseLevel>0)for(var s=0;s<t.length;s++)Math.abs(t[s])<o.noiseLevel&&(t[s]=0)}for(var a=[],f=r.length-4,u=new Array(f),h=new Array(f),c=new Array(f),l=r[1]-r[0],m=2;f+2>m;m++)l=r[m]-r[m-1],o.smoothY?u[m-2]=1/35*(-3*t[m-2]+12*t[m-1]+17*t[m]+12*t[m+1]-3*t[m+2]):u[m-2]=t[m],a[m-2]=r[m],h[m-2]=1/(12*l)*(t[m-2]-8*t[m-1]+8*t[m+1]-t[m+2]),c[m-2]=1/(7*l*l)*(2*t[m-2]-t[m-1]-2*t[m]-t[m+1]+2*t[m+2]);for(var p=0,w=0,s=0;s<u.length;s++)Math.abs(c[s])>p&&(p=Math.abs(c[s])),Math.abs(u[s])>w&&(w=Math.abs(u[s]));for(var v=[],d=[],y=null,g=null,M=new Array,s=1;s<u.length-1;s++)(h[s]<h[s-1]&&h[s]<=h[s+1]||h[s]<=h[s-1]&&h[s]<h[s+1])&&(g=a[s],l>0&&null!=y&&d.push([y,g])),(h[s]>=h[s-1]&&h[s]>h[s+1]||h[s]>h[s-1]&&h[s]>=h[s+1])&&(y=a[s],0>l&&null!=g&&d.push([y,g])),c[s]<c[s-1]&&c[s]<c[s+1]&&(v.push([a[s],u[s],s]),Math.abs(c[s])>o.broadRatio*p?M.push(!1):M.push(!0));o.realTopDetection&&e(v,a,u);for(var b=[],m=0;m<v.length;m++){for(var x=v[m],A=x[0],R=[],k=0;k<d.length;k++){var s=d[k];Math.abs(A-(s[0]+s[1])/2)<Math.abs(s[0]-s[1])/2&&R.push(s)}if(R.length>0&&1==R.length){var z=R[0],j=Math.abs(z[1]-z[0]),C=x[1];Math.abs(C)>o.minMaxRatio*w&&b.push({x:A,y:(C-n.b)/n.m,width:j,soft:M[m]})}}return b.sort(function(r,t){return r.x-t.x}),b}function e(r,t,o){for(var n,e,i,s,a,f=0;f<r.length;f++)a=r[f][2],o[a-1]>=o[a-2]&&o[a-1]>=o[a]?a--:o[a+1]>=o[a]&&o[a+1]>=o[a+2]?a++:o[a-2]>=o[a-3]&&o[a-2]>=o[a-1]?a-=2:o[a+2]>=o[a+1]&&o[a+2]>=o[a+3]&&(a+=2),o[a-1]>0&&o[a+1]>0&&o[a]>=o[a-1]&&o[a]>=o[a+1]&&(n=20*Math.log10(o[a-1]),e=20*Math.log10(o[a]),i=20*Math.log10(o[a+1]),s=.5*(n-i)/(n-2*e+i),r[f][0]=t[a]+(t[a]-t[a-1])*s,r[f][1]=o[a]-.25*(o[a-1]-[a+1])*s)}var i=(o(2),o(16));r.exports=n},function(r,t,o){"use strict";t.array=o(17),t.matrix=o(18)},function(r,t){"use strict";function o(r,t){return r-t}t.sum=function n(r){for(var n=0,t=0;t<r.length;t++)n+=r[t];return n},t.max=function e(r){for(var e=-(1/0),t=r.length,o=0;t>o;o++)r[o]>e&&(e=r[o]);return e},t.min=function i(r){for(var i=1/0,t=r.length,o=0;t>o;o++)r[o]<i&&(i=r[o]);return i},t.minMax=function(r){for(var t=1/0,o=-(1/0),n=r.length,e=0;n>e;e++)r[e]<t&&(t=r[e]),r[e]>o&&(o=r[e]);return{min:t,max:o}},t.arithmeticMean=function(r){for(var t=0,o=r.length,n=0;o>n;n++)t+=r[n];return t/o},t.mean=t.arithmeticMean,t.geometricMean=function(r){for(var t=1,o=r.length,n=0;o>n;n++)t*=r[n];return Math.pow(t,1/o)},t.logMean=function(r){for(var t=0,o=r.length,n=0;o>n;n++)t+=Math.log(r[n]);return t/o},t.grandMean=function(r,t){for(var o=0,n=0,e=r.length,i=0;e>i;i++)o+=t[i]*r[i],n+=t[i];return o/n},t.truncatedMean=function(r,t,n){void 0===n&&(n=!1),n||(r=r.slice().sort(o));for(var e=r.length,i=Math.floor(e*t),s=0,a=i;e-i>a;a++)s+=r[a];return s/(e-2*i)},t.harmonicMean=function(r){for(var t=0,o=r.length,n=0;o>n;n++){if(0===r[n])throw new RangeError("value at index "+n+"is zero");t+=1/r[n]}return o/t},t.contraHarmonicMean=function(r){for(var t=0,o=0,n=r.length,e=0;n>e;e++)t+=r[e]*r[e],o+=r[e];if(0>o)throw new RangeError("sum of values is negative");return t/o},t.median=function(r,t){void 0===t&&(t=!1),t||(r=r.slice().sort(o));var n=r.length,e=Math.floor(n/2);return n%2===0?.5*(r[e-1]+r[e]):r[e]},t.variance=function(r,o){void 0===o&&(o=!0);for(var n=t.mean(r),e=0,i=r.length,s=0;i>s;s++){var a=r[s]-n;e+=a*a}return o?e/(i-1):e/i},t.standardDeviation=function(r,o){return Math.sqrt(t.variance(r,o))},t.standardError=function(r){return t.standardDeviation(r)/Math.sqrt(r.length)},t.quartiles=function(r,n){"undefined"==typeof n&&(n=!1),n||(r=r.slice(),r.sort(o));var e=r.length/4,i=r[Math.ceil(e)-1],s=t.median(r,!0),a=r[Math.ceil(3*e)-1];return{q1:i,q2:s,q3:a}},t.pooledStandardDeviation=function(r,o){return Math.sqrt(t.pooledVariance(r,o))},t.pooledVariance=function(r,o){"undefined"==typeof o&&(o=!0);for(var n=0,e=0,i=r.length,s=0;i>s;s++){var a=r[s],f=t.variance(a);n+=(a.length-1)*f,e+=o?a.length-1:a.length}return n/e},t.mode=function(r){var t,o=r.length,n=new Array(o);for(t=0;o>t;t++)n[t]=0;var e=new Array(o),i=0;for(t=0;o>t;t++){var s=e.indexOf(r[t]);s>=0?n[s]++:(e[i]=r[t],n[i]=1,i++)}var a=0,f=0;for(t=0;i>t;t++)n[t]>a&&(a=n[t],f=t);return e[f]},t.covariance=function(r,o,n){"undefined"==typeof n&&(n=!0);var e=t.mean(r),i=t.mean(o);if(r.length!==o.length)throw"Vectors do not have the same dimensions";for(var s=0,a=r.length,f=0;a>f;f++){var u=r[f]-e,h=o[f]-i;s+=u*h}return n?s/(a-1):s/a},t.skewness=function(r,o){"undefined"==typeof o&&(o=!0);for(var n=t.mean(r),e=0,i=0,s=r.length,a=0;s>a;a++){var f=r[a]-n;e+=f*f,i+=f*f*f}var u=e/s,h=i/s,c=h/Math.pow(u,1.5);if(o){var l=Math.sqrt(s*(s-1)),m=s-2;return l/m*c}return c},t.kurtosis=function(r,o){"undefined"==typeof o&&(o=!0);for(var n=t.mean(r),e=r.length,i=0,s=0,a=0;e>a;a++){var f=r[a]-n;i+=f*f,s+=f*f*f*f}var u=i/e,h=s/e;if(o){var c=i/(e-1),l=e*(e+1)/((e-1)*(e-2)*(e-3)),m=s/(c*c),p=(e-1)*(e-1)/((e-2)*(e-3));return l*m-3*p}return h/(u*u)-3},t.entropy=function(r,t){"undefined"==typeof t&&(t=0);for(var o=0,n=r.length,e=0;n>e;e++)o+=r[e]*Math.log(r[e]+t);return-o},t.weightedMean=function(r,t){for(var o=0,n=r.length,e=0;n>e;e++)o+=r[e]*t[e];return o},t.weightedStandardDeviation=function(r,o){return Math.sqrt(t.weightedVariance(r,o))},t.weightedVariance=function(r,o){for(var n=t.weightedMean(r,o),e=0,i=r.length,s=0,a=0,f=0;i>f;f++){var u=r[f]-n,h=o[f];e+=h*(u*u),a+=h,s+=h*h}return e*(a/(a*a-s))},t.center=function(r,o){"undefined"==typeof o&&(o=!1);var n=r;o||(n=r.slice());for(var e=t.mean(n),i=n.length,s=0;i>s;s++)n[s]-=e},t.standardize=function(r,o,n){"undefined"==typeof o&&(o=t.standardDeviation(r)),"undefined"==typeof n&&(n=!1);for(var e=r.length,i=n?r:new Array(e),s=0;e>s;s++)i[s]=r[s]/o;return i},t.cumulativeSum=function(r){var t=r.length,o=new Array(t);o[0]=r[0];for(var n=1;t>n;n++)o[n]=o[n-1]+r[n];return o}},function(r,t,o){"use strict";function n(r,t){"undefined"==typeof t&&(t=0);for(var o=0,n=r.length,e=r[0].length,i=0;n>i;i++)for(var s=0;e>s;s++)o+=r[i][s]*Math.log(r[i][s]+t);return-o}function e(r,t){"undefined"==typeof t&&(t=0);var o,n,e,i,s=r.length,a=r[0].length;if(-1===t){for(o=[0],n=s*a,e=0;s>e;e++)for(i=0;a>i;i++)o[0]+=r[e][i];o[0]/=n}else if(0===t)for(o=new Array(a),n=s,i=0;a>i;i++){for(o[i]=0,e=0;s>e;e++)o[i]+=r[e][i];o[i]/=n}else{if(1!==t)throw new Error("Invalid dimension");for(o=new Array(s),n=a,i=0;s>i;i++){for(o[i]=0,e=0;a>e;e++)o[i]+=r[i][e];o[i]/=n}}return o}function i(r,t,o){for(var n=s(r,t,o),e=n.length,i=0;e>i;i++)n[i]=Math.sqrt(n[i]);return n}function s(r,t,o){"undefined"==typeof o&&(o=!0),t=t||e(r);var n=r.length;if(0===n)return[];for(var i=r[0].length,s=new Array(i),a=0;i>a;a++){for(var f=0,u=0,h=0,c=0;n>c;c++)h=r[c][a]-t[a],f+=h,u+=h*h;o?s[a]=(u-f*f/n)/(n-1):s[a]=(u-f*f/n)/n}return s}function a(r){for(var t=r.length,o=r[0].length,n=new Array(o),e=0;o>e;e++){for(var i=new Array(t),s=0;t>s;s++)i[s]=r[s][e];i.sort();var a=i.length;a%2===0?n[e]=.5*(i[a/2]+i[a/2-1]):n[e]=i[Math.floor(a/2)]}return n}function f(r){var t,o,n=r.length,e=r[0].length,i=new Array(e);for(t=0;e>t;t++){for(var s=new Array(n),a=0;n>a;a++)s[a]=0;var f=new Array(n),u=0;for(o=0;n>o;o++){var h=f.indexOf(r[o][t]);h>=0?s[h]++:(f[u]=r[o][t],s[u]=1,u++)}var c=0,l=0;for(o=0;u>o;o++)s[o]>c&&(c=s[o],l=o);i[t]=f[l]}return i}function u(r,t){"undefined"==typeof t&&(t=!0);for(var o=e(r),n=r.length,i=o.length,s=new Array(i),a=0;i>a;a++){for(var f=0,u=0,h=0;n>h;h++){var c=r[h][a]-o[a];f+=c*c,u+=c*c*c}var l=f/n,m=u/n,p=m/Math.pow(l,1.5);if(t){var w=Math.sqrt(n*(n-1)),v=n-2;s[a]=w/v*p}else s[a]=p}return s}function h(r,t){"undefined"==typeof t&&(t=!0);for(var o=e(r),n=r.length,i=r[0].length,s=new Array(i),a=0;i>a;a++){for(var f=0,u=0,h=0;n>h;h++){var c=r[h][a]-o[a];f+=c*c,u+=c*c*c*c}var l=f/n,m=u/n;if(t){var p=f/(n-1),w=n*(n+1)/((n-1)*(n-2)*(n-3)),v=u/(p*p),d=(n-1)*(n-1)/((n-2)*(n-3));s[a]=w*v-3*d}else s[a]=m/(l*l)-3}return s}function c(r){for(var t=r.length,o=i(r),n=o.length,e=new Array(n),s=Math.sqrt(t),a=0;n>a;a++)e[a]=o[a]/s;return e}function l(r,t){return m(r,void 0,t)}function m(r,t,o){"undefined"==typeof o&&(o=0),"undefined"==typeof t&&(0===o?t=r.length-1:1===o&&(t=r[0].length-1));var n=e(r,o),i=r.length;if(0===i)return[[]];var s,a,f,u,h,c=r[0].length;if(0===o){for(s=new Array(c),a=0;c>a;a++)s[a]=new Array(c);for(a=0;c>a;a++)for(f=a;c>f;f++){for(u=0,h=0;i>h;h++)u+=(r[h][f]-n[f])*(r[h][a]-n[a]);u/=t,s[a][f]=u,s[f][a]=u}}else{if(1!==o)throw new Error("Invalid dimension");for(s=new Array(i),a=0;i>a;a++)s[a]=new Array(i);for(a=0;i>a;a++)for(f=a;i>f;f++){for(u=0,h=0;c>h;h++)u+=(r[f][h]-n[f])*(r[a][h]-n[a]);u/=t,s[a][f]=u,s[f][a]=u}}return s}function p(r){var t,o,n=e(r),s=i(r,!0,n),a=w(r,n,s),f=r.length,u=r[0].length,h=new Array(u);for(t=0;u>t;t++)h[t]=new Array(u);for(t=0;u>t;t++)for(o=t;u>o;o++){for(var c=0,l=0,m=a.length;m>l;l++)c+=a[l][o]*a[l][t];c/=f-1,h[t][o]=c,h[o][t]=c}return h}function w(r,t,o){return t=t||e(r),"undefined"==typeof o&&(o=i(r,!0,t)),d(v(r,t,!1),o,!0)}function v(r,t,o){t=t||e(r);var n,i,s,a=r,f=r.length;if(!o)for(a=new Array(f),n=0;f>n;n++)a[n]=new Array(r[n].length);for(n=0;f>n;n++){var u=a[n];for(i=0,s=u.length;s>i;i++)u[i]=r[n][i]-t[i]}return a}function d(r,t,o){"undefined"==typeof t&&(t=i(r));var n,e,s,a=r,f=r.length;if(!o)for(a=new Array(f),n=0;f>n;n++)a[n]=new Array(r[n].length);for(n=0;f>n;n++){var u=a[n],h=r[n];for(e=0,s=u.length;s>e;e++)0===t[e]||isNaN(t[e])||(u[e]=h[e]/t[e])}return a}function y(r,t){var o=e(r),n=r.length;if(0===n)return[];for(var i=r[0].length,s=new Array(i),a=0;i>a;a++){for(var f=0,u=0,h=0,c=0;n>c;c++){var l=r[c][a]-o[a],m=t[c];f+=m*(l*l),h+=m,u+=m*m}s[a]=f*(h/(h*h-u))}return s}function g(r,t,o){"undefined"==typeof o&&(o=0);var n=r.length;if(0===n)return[];var e,i,s,a,f,u,h=r[0].length;if(0===o){for(e=new Array(h),i=0;h>i;i++)e[i]=0;for(i=0;n>i;i++)for(u=r[i],f=t[i],a=0;h>a;a++)e[a]+=u[a]*f}else{if(1!==o)throw new Error("Invalid dimension");for(e=new Array(n),i=0;n>i;i++)e[i]=0;for(a=0;n>a;a++)for(u=r[a],f=t[a],i=0;h>i;i++)e[a]+=u[i]*f}var c=x.sum(t);if(0!==c)for(i=0,s=e.length;s>i;i++)e[i]/=c;return e}function M(r,t,o,n){n=n||0,o=o||g(r,t,n);for(var e=0,i=0,s=0,a=t.length;a>s;s++)e+=t[s],i+=t[s]*t[s];var f=e/(e*e-i);return b(r,t,o,f,n)}function b(r,t,o,n,e){e=e||0,o=o||g(r,t,e),"undefined"==typeof n&&(n=1);var i=r.length;if(0===i)return[[]];var s,a,f,u,h,c=r[0].length;if(0===e){for(s=new Array(c),a=0;c>a;a++)s[a]=new Array(c);for(a=0;c>a;a++)for(f=a;c>f;f++){for(h=0,u=0;i>u;u++)h+=t[u]*(r[u][f]-o[f])*(r[u][a]-o[a]);s[a][f]=h*n,s[f][a]=h*n}}else{if(1!==e)throw new Error("Invalid dimension");for(s=new Array(i),a=0;i>a;a++)s[a]=new Array(i);for(a=0;i>a;a++)for(f=a;i>f;f++){for(h=0,u=0;c>u;u++)h+=t[u]*(r[f][u]-o[f])*(r[a][u]-o[a]);s[a][f]=h*n,s[f][a]=h*n}}return s}var x=o(17);r.exports={entropy:n,mean:e,standardDeviation:i,variance:s,median:a,mode:f,skewness:u,kurtosis:h,standardError:c,covariance:l,scatter:m,correlation:p,zScores:w,center:v,standardize:d,weightedVariance:y,weightedMean:g,weightedCovariance:M,weightedScatter:b}}])});
//# sourceMappingURL=ml-gsd.min.js.map