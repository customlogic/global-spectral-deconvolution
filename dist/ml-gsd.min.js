// ml-gsd@v0.0.1, MIT licensed. https://github.com/mljs/global-spectra-deconvolution
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r;"undefined"!=typeof window?r=window:"undefined"!=typeof global?r=global:"undefined"!=typeof self&&(r=self),r.mlGsd=t()}}(function(){return function t(r,o,n){function e(s,a){if(!o[s]){if(!r[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var f=o[s]={exports:{}};r[s][0].call(f.exports,function(t){var o=r[s][1][t];return e(o?o:t)},f,f.exports,t,r,o,n)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)e(n[s]);return e}({1:[function(t,r,o){r.exports.optimize=t("../src/optimize"),r.exports.gsd=t("../src/gsd")},{"../src/gsd":15,"../src/optimize":16}],2:[function(t,r,o){var n=t("ml-matrix"),e=t("./algebra"),i={optimize:function(t,r,o,i,s,a,u,h,f,c){var l=0,m=0;if("object"!=typeof r[0])for(var p=0;p<r.length;p++)r[p]=[r[p]];var p,w,v=-50,y=r.length,d=i.length,b=n.zeros(y,1),M=n.zeros(d,1),g=.01/v,x=.01/v,R=n.zeros(d,y);if(o.length!=i.length){console.log("lm.m error: the length of t must equal the length of y_dat"),length_t=o.length,length_y_dat=i.length;var g=0;if(!l)return}s=s||Math.sqrt((d-y+1)/e.multiply(e.transpose(i),i)),a=a||.001,u=u||e.multiply(Math.abs(r),-100),h=h||e.multiply(Math.abs(r),100),f=f||1,c=c||[3,10*y,.001,.001,.001,.01,.01,11,9,1];var k=c[0],z=c[1],A=c[2],C=(c[3],c[4],c[5]),j=c[6],E=c[7],V=c[8],q=c[9];if(l&&3==k&&(k=2),!a.length||1==a.length){for(var S=new Array(y),p=0;y>p;p++)S[p]=[a];a=S}var D=[];for(p=0;p<a.length;p++)0!=a[p][0]&&D.push(p);var I=D.length,_=!1,O=null;if(!s.length||s.length<d){var L=e.multiply(n.ones(d,1),s[0]);O=e.dotMultiply(L,L)}else O=e.dotMultiply(s,s);var J=this.lm_matx(t,o,b,M,1,R,r,i,O,a,f),U=J.JtWJ,T=J.JtWdy,g=J.Chi_sq,W=J.y_hat,R=J.J;switch(Math.max(Math.abs(T))<A&&(console.log(" *** Your Initial Guess is Extremely Close to Optimal ***"),console.log(" *** epsilon_1 = ",A),_=!0),q){case 1:lambda=j;break;default:lambda=j*Math.max(e.diag(U)),nu=2}x=g;for(var G=null;!_&&z>=m;){switch(m+=1,q){case 1:G=e.solve(e.add(U,e.multiply(e.diag(e.diag(U)),lambda)),T);break;default:G=e.solve(e.add(U,e.multiply(n.eye(y),lambda)),T)}var Q=new Array(D.length);for(w=0;w<D.length;w++)Q[w]=G[D[w]];var F=e.add(r,Q);for(w=0;w<F.length;w++)F[w][0]=Math.min(Math.max(u[w][0],F[w][0]),h[w][0]);var X=e.subtract(i,t(o,F,f)),P=e.multiply(e.transpose(X),e.dotMultiply(X,O));if(2==q){var N=e.multiply(e.transpose(T),G),Y=e.multiply(N,e.inv(e.add(e.multiply(e.subtract(P-g),.5)),e.multiply(N,2)));G=e.multiply(Y,G);for(var w=0;w<D.length;w++)Q[w]=G[D[w]];F=e.add(r,Q),F=e.min(e.max(u,F),h),X=e.subtract(i,t(o,F,f)),P=e.multiply(e.transpose(X),mat.dotMultiply(X,O))}var B=(g-P)/e.multiply(e.multiply(e.transpose(G),2),e.add(e.multiply(lambda,G),T));if(B>C)switch(dX2=g-x,x=g,b=r,M=W,r=F,J=this.lm_matx(t,o,b,M,dX2,R,r,i,O,a,f),U=J.JtWJ,T=J.JtWdy,g=J.Chi_sq,W=J.y_hat,R=J.J,q){case 1:lambda=Math.max(lambda/V,1e-7);break;case 2:lambda=Math.max(lambda/(1+Y),1e-7);break;case 3:lambda=e.multiply(Math.max(1/3,1-(2*B-1)^3),lambda),nu=2}else switch(g=x,m%(2*y)==0&&(J=this.lm_matx(t,o,b,M,-1,R,r,i,O,a,f),U=J.JtWJ,T=J.JtWdy,dX2=J.Chi_sq,W=J.y_hat,R=J.J),q){case 1:lambda=Math.min(lambda*E,1e7);break;case 2:lambda+=Math.abs((P-g)/2/Y);break;case 3:lambda*=nu,nu=2*nu}}return O=e.multiply(e.multiply(e.transpose(X),X),n.ones(d,1)),O.apply(function(t,r){O[t][r]=(d-I+1)/O[t][r]}),J=this.lm_matx(t,o,b,M,-1,R,r,i,O,a,f),U=J.JtWJ,T=J.JtWdy,g=J.Chi_sq,W=J.y_hat,R=J.J,{p:r,X2:g}},lm_FD_J:function(t,r,o,i,s,a){var u=i.length,h=o.length;s=s||e.multiply(n.ones(h,1),.001);for(var f=o.clone(),c=new n(u,h),l=new Array(h),m=0;h>m;m++){if(l[m]=s[m]*(1+Math.abs(o[m][0])),o[m]=[f[m][0]+l[m]],0!=l[m])if(y1=t(r,o,a),s[m][0]<0)for(var p=e.dotDivide(e.subtract(y1,i),l[m]),w=0;u>w;w++)c[w][m]=p[w][0];else{o[m][0]=f[m][0]-l[m];for(var p=e.dotDivide(e.subtract(y1,t(r,o,a)),2*l[m]),w=0;u>w;w++)c[w][m]=p[w][0]}o[m]=f[m]}return c},lm_Broyden_J:function(t,r,o,n,i){var s=e.subtract(n,t),a=e.transpose(s);return a.div(e.multiply(a,s)),o=e.add(o,e.multiply(e.subtract(i,e.add(r,e.multiply(o,s))),a))},lm_matx:function(t,r,o,i,s,a,u,h,f,c,l,m){var p=(h.length,u.length);c=c||.001;var w=t(r,u,l);a=m%(2*p)==0||s>0?this.lm_FD_J(t,r,u,w,c,l):this.lm_Broyden_J(o,i,a,u,w);var v=e.subtract(h,w),y=e.multiply(e.transpose(v),e.dotMultiply(v,f)),d=e.transpose(a),b=e.multiply(d,e.dotMultiply(a,e.multiply(f,n.ones(1,p)))),M=e.multiply(d,e.dotMultiply(f,v));return{JtWJ:b,JtWdy:M,Chi_sq:y,y_hat:w,J:a}}};r.exports=i},{"./algebra":3,"ml-matrix":12}],3:[function(t,r,o){"use strict";function n(t,r){return new R(t,r)}function e(t,r){return R.ones(t,r)}function i(t,r){return R.eye(t,r)}function s(t,r){return R.zeros(t,r)}function a(t,r){return R.rand(t,r)}function u(t){if("number"==typeof t)return t;var r=t.clone();return r.transpose()}function h(t,r){if("number"==typeof t&&"number"==typeof r)return t+r;if("number"==typeof t)return this.add(r,t);var o=t.clone();return o.add(r)}function f(t,r){if("number"==typeof t&&"number"==typeof r)return t-r;if("number"==typeof t)return this.subtract(r,t);var o=t.clone();return o.sub(r)}function c(t,r){if("number"==typeof t&&"number"==typeof r)return t*r;if("number"==typeof t)return this.multiply(r,t);var o=t.clone();return"number"==typeof r?o.mul(r):o=o.mmul(r),1==o.rows&&1==o.columns?o[0][0]:o}function l(t,r){var o=t.clone();return o.mul(r)}function m(t,r){var o=t.clone();return o.div(r)}function p(t){var r,o,n=null,e=t.rows,i=t.columns;if("undefined"==typeof i&&"object"==typeof t)if(t[0]&&t[0].length)for(e=t.length,i=t[0].length,o=Math.min(e,i),n=R.zeros(i,i),r=0;i>r;r++)n[r][r]=t[r][r];else for(i=t.length,n=R.zeros(i,i),r=0;i>r;r++)n[r][r]=t[r];if(1==e)for(n=R.zeros(i,i),r=0;i>r;r++)n[r][r]=t[0][r];else if(e>0&&i>0)for(o=Math.min(e,i),n=new Array(o),r=0;o>r;r++)n[r]=t[r][r];return n}function w(t,r){if("number"==typeof t&&"number"==typeof r)return Math.min(t,r);for(var o=t.rows,n=t.columns,e=new R(o,n),i=0;o>i;i++)for(var s=0;n>s;s++)t[i][s]<r[i][s]?e[i][s]=t[i][s]:e[i][s]=r[i][s];return e}function v(t,r){if("number"==typeof t&&"number"==typeof r)return Math.max(t,r);for(var o=t.rows,n=t.columns,e=new R(o,n),i=0;o>i;i++)for(var s=0;n>s;s++)t[i][s]>r[i][s]?e[i][s]=t[i][s]:e[i][s]=r[i][s];return e}function y(t){if("number"==typeof t)return Math.sqrt(t);for(var r=t.rows,o=t.columns,n=new R(r,o),e=0;r>e;e++)for(var i=0;o>i;i++)n[e][i]=Math.sqrt(t[e][i]);return n}function d(t){if("number"==typeof t)return Math.abs(t);for(var r=t.rows,o=t.columns,n=new R(r,o),e=0;r>e;e++)for(var i=0;o>i;i++)n[e][i]=Math.abs(t[e][i]);return n}function b(t){if("number"==typeof t)return Math.sqrt(t);for(var r=t.rows,o=t.columns,n=new R(r,o),e=0;r>e;e++)for(var i=0;o>i;i++)n[e][i]=Math.exp(t[e][i]);return n}function M(t,r){if("number"==typeof t)return Math.pow(t,r);for(var o=t.rows,n=t.columns,e=new R(o,n),i=0;o>i;i++)for(var s=0;n>s;s++)e[i][s]=Math.pow(t[i][s],r);return e}function g(t,r){return t.solve(r)}function x(t){return"number"==typeof t?1/t:t.inverse()}var R=t("ml-matrix");r.exports={transpose:u,add:h,subtract:f,multiply:c,dotMultiply:l,dotDivide:m,diag:p,min:w,max:v,solve:g,inv:x,sqrt:y,exp:b,dotPow:M,abs:d,matrix:n,ones:e,zeros:s,random:a,eye:i}},{"ml-matrix":12}],4:[function(t,r,o){"use strict";r.exports=t("./LM"),r.exports.Matrix=t("ml-matrix"),r.exports.Matrix.algebra=t("./algebra")},{"./LM":2,"./algebra":3,"ml-matrix":12}],5:[function(t,r,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);if(t=e.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");var r,o,i,s=t,a=s.rows,u=new e(a,a),h=!0;for(o=0;a>o;o++){var f=u[o],c=0;for(i=0;o>i;i++){var l=u[i],m=0;for(r=0;i>r;r++)m+=l[r]*f[r];f[i]=m=(s[o][i]-m)/u[i][i],c+=m*m}for(c=s[o][o]-c,h&=c>0,u[o][o]=Math.sqrt(Math.max(c,0)),i=o+1;a>i;i++)u[o][i]=0}if(!h)throw new Error("Matrix is not positive definite");this.L=u}var e=t("../matrix");n.prototype={get leftTriangularFactor(){return this.L},solve:function(t){t=e.checkMatrix(t);var r=this.L,o=r.rows;if(t.rows!==o)throw new Error("Matrix dimensions do not match");var n,i,s,a=t.columns,u=t.clone();for(s=0;o>s;s++)for(i=0;a>i;i++){for(n=0;s>n;n++)u[s][i]-=u[n][i]*r[s][n];u[s][i]/=r[s][s]}for(s=o-1;s>=0;s--)for(i=0;a>i;i++){for(n=s+1;o>n;n++)u[s][i]-=u[n][i]*r[n][s];u[s][i]/=r[s][s]}return u}},r.exports=n},{"../matrix":13}],6:[function(t,r,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);if(t=h.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");var r,o,u=t.columns,f=h.zeros(u,u),c=new Array(u),l=new Array(u),m=t;if(t.isSymmetric()){for(r=0;u>r;r++)for(o=0;u>o;o++)f[r][o]=m[r][o];e(u,l,c,f),i(u,l,c,f)}else{var p=h.zeros(u,u),w=new Array(u);for(o=0;u>o;o++)for(r=0;u>r;r++)p[r][o]=m[r][o];s(u,p,w,f),a(u,l,c,f,p)}this.n=u,this.e=l,this.d=c,this.V=f}function e(t,r,o,n){var e,i,s,a,u,h,f,c;for(u=0;t>u;u++)o[u]=n[t-1][u];for(a=t-1;a>0;a--){for(c=0,s=0,h=0;a>h;h++)c+=Math.abs(o[h]);if(0===c)for(r[a]=o[a-1],u=0;a>u;u++)o[u]=n[a-1][u],n[a][u]=0,n[u][a]=0;else{for(h=0;a>h;h++)o[h]/=c,s+=o[h]*o[h];for(e=o[a-1],i=Math.sqrt(s),e>0&&(i=-i),r[a]=c*i,s-=e*i,o[a-1]=e-i,u=0;a>u;u++)r[u]=0;for(u=0;a>u;u++){for(e=o[u],n[u][a]=e,i=r[u]+n[u][u]*e,h=u+1;a-1>=h;h++)i+=n[h][u]*o[h],r[h]+=n[h][u]*e;r[u]=i}for(e=0,u=0;a>u;u++)r[u]/=s,e+=r[u]*o[u];for(f=e/(s+s),u=0;a>u;u++)r[u]-=f*o[u];for(u=0;a>u;u++){for(e=o[u],i=r[u],h=u;a-1>=h;h++)n[h][u]-=e*r[h]+i*o[h];o[u]=n[a-1][u],n[a][u]=0}}o[a]=s}for(a=0;t-1>a;a++){if(n[t-1][a]=n[a][a],n[a][a]=1,s=o[a+1],0!==s){for(h=0;a>=h;h++)o[h]=n[h][a+1]/s;for(u=0;a>=u;u++){for(i=0,h=0;a>=h;h++)i+=n[h][a+1]*n[h][u];for(h=0;a>=h;h++)n[h][u]-=i*o[h]}}for(h=0;a>=h;h++)n[h][a+1]=0}for(u=0;t>u;u++)o[u]=n[t-1][u],n[t-1][u]=0;n[t-1][t-1]=1,r[0]=0}function i(t,r,o,n){var e,i,s,a,u,h,c,l,m,p,w,v,y,d,b,M,g;for(s=1;t>s;s++)r[s-1]=r[s];r[t-1]=0;var x=0,R=0,k=Math.pow(2,-52);for(h=0;t>h;h++){for(R=Math.max(R,Math.abs(o[h])+Math.abs(r[h])),c=h;t>c&&!(Math.abs(r[c])<=k*R);)c++;if(c>h){g=0;do{for(g+=1,e=o[h],l=(o[h+1]-e)/(2*r[h]),m=f(l,1),0>l&&(m=-m),o[h]=r[h]/(l+m),o[h+1]=r[h]*(l+m),p=o[h+1],i=e-o[h],s=h+2;t>s;s++)o[s]-=i;for(x+=i,l=o[c],w=1,v=w,y=w,d=r[h+1],b=0,M=0,s=c-1;s>=h;s--)for(y=v,v=w,M=b,e=w*r[s],i=w*l,m=f(l,r[s]),r[s+1]=b*m,b=r[s]/m,w=l/m,l=w*o[s]-b*e,o[s+1]=i+b*(w*e+b*o[s]),u=0;t>u;u++)i=n[u][s+1],n[u][s+1]=b*n[u][s]+w*i,n[u][s]=w*n[u][s]-b*i;l=-b*M*y*d*r[h]/p,r[h]=b*l,o[h]=w*l}while(Math.abs(r[h])>k*R)}o[h]=o[h]+x,r[h]=0}for(s=0;t-1>s;s++){for(u=s,l=o[s],a=s+1;t>a;a++)o[a]<l&&(u=a,l=o[a]);if(u!==s)for(o[u]=o[s],o[s]=l,a=0;t>a;a++)l=n[a][s],n[a][s]=n[a][u],n[a][u]=l}}function s(t,r,o,n){var e,i,s,a,u,h,f,c=0,l=t-1;for(h=c+1;l-1>=h;h++){for(f=0,a=h;l>=a;a++)f+=Math.abs(r[a][h-1]);if(0!==f){for(s=0,a=l;a>=h;a--)o[a]=r[a][h-1]/f,s+=o[a]*o[a];for(i=Math.sqrt(s),o[h]>0&&(i=-i),s-=o[h]*i,o[h]=o[h]-i,u=h;t>u;u++){for(e=0,a=l;a>=h;a--)e+=o[a]*r[a][u];for(e/=s,a=h;l>=a;a++)r[a][u]-=e*o[a]}for(a=0;l>=a;a++){for(e=0,u=l;u>=h;u--)e+=o[u]*r[a][u];for(e/=s,u=h;l>=u;u++)r[a][u]-=e*o[u]}o[h]=f*o[h],r[h][h-1]=f*i}}for(a=0;t>a;a++)for(u=0;t>u;u++)n[a][u]=a===u?1:0;for(h=l-1;h>=c+1;h--)if(0!==r[h][h-1]){for(a=h+1;l>=a;a++)o[a]=r[a][h-1];for(u=h;l>=u;u++){for(i=0,a=h;l>=a;a++)i+=o[a]*n[a][u];for(i=i/o[h]/r[h][h-1],a=h;l>=a;a++)n[a][u]+=i*o[a]}}}function a(t,r,o,n,e){var i,s,a,h,f,c,l,m,p,w,v,y,d,b,M,g=t-1,x=0,R=t-1,k=Math.pow(2,-52),z=0,A=0,C=0,j=0,E=0,V=0,q=0,S=0;for(i=0;t>i;i++)for((x>i||i>R)&&(o[i]=e[i][i],r[i]=0),s=Math.max(i-1,0);t>s;s++)A+=Math.abs(e[i][s]);for(;g>=x;){for(h=g;h>x&&(V=Math.abs(e[h-1][h-1])+Math.abs(e[h][h]),0===V&&(V=A),!(Math.abs(e[h][h-1])<k*V));)h--;if(h===g)e[g][g]=e[g][g]+z,o[g]=e[g][g],r[g]=0,g--,S=0;else if(h===g-1){if(l=e[g][g-1]*e[g-1][g],C=(e[g-1][g-1]-e[g][g])/2,j=C*C+l,q=Math.sqrt(Math.abs(j)),e[g][g]=e[g][g]+z,e[g-1][g-1]=e[g-1][g-1]+z,m=e[g][g],j>=0){for(q=C>=0?C+q:C-q,o[g-1]=m+q,o[g]=o[g-1],0!==q&&(o[g]=m-l/q),r[g-1]=0,r[g]=0,m=e[g][g-1],V=Math.abs(m)+Math.abs(q),C=m/V,j=q/V,E=Math.sqrt(C*C+j*j),C/=E,j/=E,s=g-1;t>s;s++)q=e[g-1][s],e[g-1][s]=j*q+C*e[g][s],e[g][s]=j*e[g][s]-C*q;for(i=0;g>=i;i++)q=e[i][g-1],e[i][g-1]=j*q+C*e[i][g],e[i][g]=j*e[i][g]-C*q;for(i=x;R>=i;i++)q=n[i][g-1],n[i][g-1]=j*q+C*n[i][g],n[i][g]=j*n[i][g]-C*q}else o[g-1]=m+C,o[g]=m+C,r[g-1]=q,r[g]=-q;g-=2,S=0}else{if(m=e[g][g],p=0,l=0,g>h&&(p=e[g-1][g-1],l=e[g][g-1]*e[g-1][g]),10===S){for(z+=m,i=x;g>=i;i++)e[i][i]-=m;V=Math.abs(e[g][g-1])+Math.abs(e[g-1][g-2]),m=p=.75*V,l=-.4375*V*V}if(30===S&&(V=(p-m)/2,V=V*V+l,V>0)){for(V=Math.sqrt(V),m>p&&(V=-V),V=m-l/((p-m)/2+V),i=x;g>=i;i++)e[i][i]-=V;z+=V,m=p=l=.964}for(S+=1,f=g-2;f>=h&&(q=e[f][f],E=m-q,V=p-q,C=(E*V-l)/e[f+1][f]+e[f][f+1],j=e[f+1][f+1]-q-E-V,E=e[f+2][f+1],V=Math.abs(C)+Math.abs(j)+Math.abs(E),C/=V,j/=V,E/=V,f!==h)&&!(Math.abs(e[f][f-1])*(Math.abs(j)+Math.abs(E))<k*(Math.abs(C)*(Math.abs(e[f-1][f-1])+Math.abs(q)+Math.abs(e[f+1][f+1]))));)f--;for(i=f+2;g>=i;i++)e[i][i-2]=0,i>f+2&&(e[i][i-3]=0);for(a=f;g-1>=a&&(b=a!==g-1,a!==f&&(C=e[a][a-1],j=e[a+1][a-1],E=b?e[a+2][a-1]:0,m=Math.abs(C)+Math.abs(j)+Math.abs(E),0!==m&&(C/=m,j/=m,E/=m)),0!==m);a++)if(V=Math.sqrt(C*C+j*j+E*E),0>C&&(V=-V),0!==V){for(a!==f?e[a][a-1]=-V*m:h!==f&&(e[a][a-1]=-e[a][a-1]),C+=V,m=C/V,p=j/V,q=E/V,j/=C,E/=C,s=a;t>s;s++)C=e[a][s]+j*e[a+1][s],b&&(C+=E*e[a+2][s],e[a+2][s]=e[a+2][s]-C*q),e[a][s]=e[a][s]-C*m,e[a+1][s]=e[a+1][s]-C*p;for(i=0;i<=Math.min(g,a+3);i++)C=m*e[i][a]+p*e[i][a+1],b&&(C+=q*e[i][a+2],e[i][a+2]=e[i][a+2]-C*E),e[i][a]=e[i][a]-C,e[i][a+1]=e[i][a+1]-C*j;for(i=x;R>=i;i++)C=m*n[i][a]+p*n[i][a+1],b&&(C+=q*n[i][a+2],n[i][a+2]=n[i][a+2]-C*E),n[i][a]=n[i][a]-C,n[i][a+1]=n[i][a+1]-C*j}}}if(0!==A){for(g=t-1;g>=0;g--)if(C=o[g],j=r[g],0===j)for(h=g,e[g][g]=1,i=g-1;i>=0;i--){for(l=e[i][i]-C,E=0,s=h;g>=s;s++)E+=e[i][s]*e[s][g];if(r[i]<0)q=l,V=E;else if(h=i,0===r[i]?e[i][g]=0!==l?-E/l:-E/(k*A):(m=e[i][i+1],p=e[i+1][i],j=(o[i]-C)*(o[i]-C)+r[i]*r[i],c=(m*V-q*E)/j,e[i][g]=c,e[i+1][g]=Math.abs(m)>Math.abs(q)?(-E-l*c)/m:(-V-p*c)/q),c=Math.abs(e[i][g]),k*c*c>1)for(s=i;g>=s;s++)e[s][g]=e[s][g]/c}else if(0>j)for(h=g-1,Math.abs(e[g][g-1])>Math.abs(e[g-1][g])?(e[g-1][g-1]=j/e[g][g-1],e[g-1][g]=-(e[g][g]-C)/e[g][g-1]):(M=u(0,-e[g-1][g],e[g-1][g-1]-C,j),e[g-1][g-1]=M[0],e[g-1][g]=M[1]),e[g][g-1]=0,e[g][g]=1,i=g-2;i>=0;i--){for(w=0,v=0,s=h;g>=s;s++)w+=e[i][s]*e[s][g-1],v+=e[i][s]*e[s][g];if(l=e[i][i]-C,r[i]<0)q=l,E=w,V=v;else if(h=i,0===r[i]?(M=u(-w,-v,l,j),e[i][g-1]=M[0],e[i][g]=M[1]):(m=e[i][i+1],p=e[i+1][i],y=(o[i]-C)*(o[i]-C)+r[i]*r[i]-j*j,d=2*(o[i]-C)*j,0===y&&0===d&&(y=k*A*(Math.abs(l)+Math.abs(j)+Math.abs(m)+Math.abs(p)+Math.abs(q))),M=u(m*E-q*w+j*v,m*V-q*v-j*w,y,d),e[i][g-1]=M[0],e[i][g]=M[1],Math.abs(m)>Math.abs(q)+Math.abs(j)?(e[i+1][g-1]=(-w-l*e[i][g-1]+j*e[i][g])/m,e[i+1][g]=(-v-l*e[i][g]-j*e[i][g-1])/m):(M=u(-E-p*e[i][g-1],-V-p*e[i][g],q,j),e[i+1][g-1]=M[0],e[i+1][g]=M[1])),c=Math.max(Math.abs(e[i][g-1]),Math.abs(e[i][g])),k*c*c>1)for(s=i;g>=s;s++)e[s][g-1]=e[s][g-1]/c,e[s][g]=e[s][g]/c}for(i=0;t>i;i++)if(x>i||i>R)for(s=i;t>s;s++)n[i][s]=e[i][s];for(s=t-1;s>=x;s--)for(i=x;R>=i;i++){for(q=0,a=x;a<=Math.min(s,R);a++)q+=n[i][a]*e[a][s];n[i][s]=q}}}function u(t,r,o,n){var e,i;return Math.abs(o)>Math.abs(n)?(e=n/o,i=o+e*n,[(t+e*r)/i,(r-e*t)/i]):(e=o/n,i=n+e*o,[(e*t+r)/i,(e*r-t)/i])}var h=t("../matrix"),f=t("./util").hypotenuse;n.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var t,r,o=this.n,n=this.e,e=this.d,i=new h(o,o);for(t=0;o>t;t++){for(r=0;o>r;r++)i[t][r]=0;i[t][t]=e[t],n[t]>0?i[t][t+1]=n[t]:n[t]<0&&(i[t][t-1]=n[t])}return i}},r.exports=n},{"../matrix":13,"./util":10}],7:[function(t,r,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=e.checkMatrix(t);var r,o,i,s,a,u,h,f,c,l,m=t.clone(),p=m.rows,w=m.columns,v=new Array(p),y=1;for(r=0;p>r;r++)v[r]=r;for(c=new Array(p),o=0;w>o;o++){for(r=0;p>r;r++)c[r]=m[r][o];for(r=0;p>r;r++){for(f=m[r],l=Math.min(r,o),a=0,i=0;l>i;i++)a+=f[i]*c[i];f[o]=c[r]-=a}for(s=o,r=o+1;p>r;r++)Math.abs(c[r])>Math.abs(c[s])&&(s=r);if(s!==o){for(i=0;w>i;i++)u=m[s][i],m[s][i]=m[o][i],m[o][i]=u;h=v[s],v[s]=v[o],v[o]=h,y=-y}if(p>o&&0!==m[o][o])for(r=o+1;p>r;r++)m[r][o]/=m[o][o]}this.LU=m,this.pivotVector=v,this.pivotSign=y}var e=t("../matrix");n.prototype={isSingular:function(){for(var t=this.LU,r=t.columns,o=0;r>o;o++)if(0===t[o][o])return!0;return!1},get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,o=t.columns,n=0;o>n;n++)r*=t[n][n];return r},get lowerTriangularFactor(){for(var t=this.LU,r=t.rows,o=t.columns,n=new e(r,o),i=0;r>i;i++)for(var s=0;o>s;s++)i>s?n[i][s]=t[i][s]:i===s?n[i][s]=1:n[i][s]=0;return n},get upperTriangularFactor(){for(var t=this.LU,r=t.rows,o=t.columns,n=new e(r,o),i=0;r>i;i++)for(var s=0;o>s;s++)s>=i?n[i][s]=t[i][s]:n[i][s]=0;return n},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(t){t=e.checkMatrix(t);var r=this.LU,o=r.rows;if(o!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,i,s,a=t.columns,u=t.subMatrixRow(this.pivotVector,0,a-1),h=r.columns;for(s=0;h>s;s++)for(n=s+1;h>n;n++)for(i=0;a>i;i++)u[n][i]-=u[s][i]*r[n][s];for(s=h-1;s>=0;s--){for(i=0;a>i;i++)u[s][i]/=r[s][s];for(n=0;s>n;n++)for(i=0;a>i;i++)u[n][i]-=u[s][i]*r[n][s]}return u}},r.exports=n},{"../matrix":13}],8:[function(t,r,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=e.checkMatrix(t);var r,o,s,a,u=t.clone(),h=t.rows,f=t.columns,c=new Array(f);for(s=0;f>s;s++){var l=0;for(r=s;h>r;r++)l=i(l,u[r][s]);if(0!==l){for(u[s][s]<0&&(l=-l),r=s;h>r;r++)u[r][s]/=l;for(u[s][s]+=1,o=s+1;f>o;o++){for(a=0,r=s;h>r;r++)a+=u[r][s]*u[r][o];for(a=-a/u[s][s],r=s;h>r;r++)u[r][o]+=a*u[r][s]}}c[s]=-l}this.QR=u,this.Rdiag=c}var e=t("../matrix"),i=t("./util").hypotenuse;n.prototype={solve:function(t){t=e.checkMatrix(t);var r=this.QR,o=r.rows;if(t.rows!==o)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,i,s,a,u=t.columns,h=t.clone(),f=r.columns;for(s=0;f>s;s++)for(i=0;u>i;i++){for(a=0,n=s;o>n;n++)a+=r[n][s]*h[n][i];for(a=-a/r[s][s],n=s;o>n;n++)h[n][i]+=a*r[n][s]}for(s=f-1;s>=0;s--){for(i=0;u>i;i++)h[s][i]/=this.Rdiag[s];for(n=0;s>n;n++)for(i=0;u>i;i++)h[n][i]-=h[s][i]*r[n][s]}return h.subMatrix(0,f-1,0,u-1)},isFullRank:function(){for(var t=this.QR.columns,r=0;t>r;r++)if(0===this.Rdiag[r])return!1;return!0},get upperTriangularFactor(){var t,r,o=this.QR,n=o.columns,i=new e(n,n);for(t=0;n>t;t++)for(r=0;n>r;r++)r>t?i[t][r]=o[t][r]:t===r?i[t][r]=this.Rdiag[t]:i[t][r]=0;return i},get orthogonalFactor(){var t,r,o,n,i=this.QR,s=i.rows,a=i.columns,u=new e(s,a);for(o=a-1;o>=0;o--){for(t=0;s>t;t++)u[t][o]=0;for(u[o][o]=1,r=o;a>r;r++)if(0!==i[o][o]){for(n=0,t=o;s>t;t++)n+=i[t][o]*u[t][r];for(n=-n/i[o][o],t=o;s>t;t++)u[t][r]+=n*i[t][o]}}return u}},r.exports=n},{"../matrix":13,"./util":10}],9:[function(t,r,o){"use strict";function n(t,r){if(!(this instanceof n))return new n(t,r);t=e.checkMatrix(t),r=r||{};var o=t.clone(),s=t.rows,a=t.columns,u=Math.min(s,a),h=!0,f=!0;r.computeLeftSingularVectors===!1&&(h=!1),r.computeRightSingularVectors===!1&&(f=!1);var c=r.autoTranspose===!0,l=!1;if(a>s)if(c){o=o.transpose(),s=o.rows,a=o.columns,l=!0;var m=h;h=f,f=m}else console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");var p,w,v,y,d,b,M,g,x,R,k,z,A,C,j,E,V,q,S,D,I,_=new Array(Math.min(s+1,a)),O=e.zeros(s,u),L=e.zeros(a,a),J=new Array(a),U=new Array(s),T=Math.min(s-1,a),W=Math.max(0,Math.min(a-2,s));for(v=0,R=Math.max(T,W);R>v;v++){if(T>v){for(_[v]=0,p=v;s>p;p++)_[v]=i(_[v],o[p][v]);if(0!==_[v]){for(o[v][v]<0&&(_[v]=-_[v]),p=v;s>p;p++)o[p][v]/=_[v];o[v][v]+=1}_[v]=-_[v]}for(w=v+1;a>w;w++){if(T>v&&0!==_[v]){for(d=0,p=v;s>p;p++)d+=o[p][v]*o[p][w];for(d=-d/o[v][v],p=v;s>p;p++)o[p][w]+=d*o[p][v]}J[w]=o[v][w]}if(h&&T>v)for(p=v;s>p;p++)O[p][v]=o[p][v];if(W>v){for(J[v]=0,p=v+1;a>p;p++)J[v]=i(J[v],J[p]);if(0!==J[v]){for(J[v+1]<0&&(J[v]=-J[v]),p=v+1;a>p;p++)J[p]/=J[v];J[v+1]+=1}if(J[v]=-J[v],s>v+1&&0!==J[v]){for(p=v+1;s>p;p++)U[p]=0;for(w=v+1;a>w;w++)for(p=v+1;s>p;p++)U[p]+=J[w]*o[p][w];for(w=v+1;a>w;w++)for(d=-J[w]/J[v+1],p=v+1;s>p;p++)o[p][w]+=d*U[p]}if(f)for(p=v+1;a>p;p++)L[p][v]=J[p]}}if(y=Math.min(a,s+1),a>T&&(_[T]=o[T][T]),y>s&&(_[y-1]=0),y>W+1&&(J[W]=o[W][y-1]),J[y-1]=0,h){for(w=T;u>w;w++){for(p=0;s>p;p++)O[p][w]=0;O[w][w]=1}for(v=T-1;v>=0;v--)if(0!==_[v]){for(w=v+1;u>w;w++){for(d=0,p=v;s>p;p++)d+=O[p][v]*O[p][w];for(d=-d/O[v][v],p=v;s>p;p++)O[p][w]+=d*O[p][v]}for(p=v;s>p;p++)O[p][v]=-O[p][v];for(O[v][v]=1+O[v][v],p=0;v-1>p;p++)O[p][v]=0}else{for(p=0;s>p;p++)O[p][v]=0;O[v][v]=1}}if(f)for(v=a-1;v>=0;v--){if(W>v&&0!==J[v])for(w=v+1;a>w;w++){for(d=0,p=v+1;a>p;p++)d+=L[p][v]*L[p][w];for(d=-d/L[v+1][v],p=v+1;a>p;p++)L[p][w]+=d*L[p][v]}for(p=0;a>p;p++)L[p][v]=0;L[v][v]=1}for(var G=y-1,Q=0,F=Math.pow(2,-52);y>0;){for(v=y-2;v>=-1&&-1!==v;v--)if(Math.abs(J[v])<=F*(Math.abs(_[v])+Math.abs(_[v+1]))){J[v]=0;break}if(v===y-2)k=4;else{for(b=y-1;b>=v&&b!==v;b--)if(d=(b!==y?Math.abs(J[b]):0)+(b!==v+1?Math.abs(J[b-1]):0),Math.abs(_[b])<=F*d){_[b]=0;break}b===v?k=3:b===y-1?k=1:(k=2,v=b)}switch(v++,k){case 1:for(M=J[y-2],J[y-2]=0,w=y-2;w>=v;w--)if(d=i(_[w],M),g=_[w]/d,x=M/d,_[w]=d,w!==v&&(M=-x*J[w-1],J[w-1]=g*J[w-1]),f)for(p=0;a>p;p++)d=g*L[p][w]+x*L[p][y-1],L[p][y-1]=-x*L[p][w]+g*L[p][y-1],L[p][w]=d;break;case 2:for(M=J[v-1],J[v-1]=0,w=v;y>w;w++)if(d=i(_[w],M),g=_[w]/d,x=M/d,_[w]=d,M=-x*J[w],J[w]=g*J[w],h)for(p=0;s>p;p++)d=g*O[p][w]+x*O[p][v-1],O[p][v-1]=-x*O[p][w]+g*O[p][v-1],O[p][w]=d;break;case 3:for(z=Math.max(Math.max(Math.max(Math.max(Math.abs(_[y-1]),Math.abs(_[y-2])),Math.abs(J[y-2])),Math.abs(_[v])),Math.abs(J[v])),A=_[y-1]/z,C=_[y-2]/z,j=J[y-2]/z,E=_[v]/z,V=J[v]/z,q=((C+A)*(C-A)+j*j)/2,S=A*j*(A*j),D=0,(0!==q||0!==S)&&(D=Math.sqrt(q*q+S),0>q&&(D=-D),D=S/(q+D)),M=(E+A)*(E-A)+D,I=E*V,w=v;y-1>w;w++){if(d=i(M,I),g=M/d,x=I/d,w!==v&&(J[w-1]=d),M=g*_[w]+x*J[w],J[w]=g*J[w]-x*_[w],I=x*_[w+1],_[w+1]=g*_[w+1],f)for(p=0;a>p;p++)d=g*L[p][w]+x*L[p][w+1],L[p][w+1]=-x*L[p][w]+g*L[p][w+1],L[p][w]=d;if(d=i(M,I),g=M/d,x=I/d,_[w]=d,M=g*J[w]+x*_[w+1],_[w+1]=-x*J[w]+g*_[w+1],I=x*J[w+1],J[w+1]=g*J[w+1],h&&s-1>w)for(p=0;s>p;p++)d=g*O[p][w]+x*O[p][w+1],O[p][w+1]=-x*O[p][w]+g*O[p][w+1],O[p][w]=d}J[y-2]=M,Q+=1;break;case 4:if(_[v]<=0&&(_[v]=_[v]<0?-_[v]:0,f))for(p=0;G>=p;p++)L[p][v]=-L[p][v];for(;G>v&&!(_[v]>=_[v+1]);){if(d=_[v],_[v]=_[v+1],_[v+1]=d,f&&a-1>v)for(p=0;a>p;p++)d=L[p][v+1],L[p][v+1]=L[p][v],L[p][v]=d;if(h&&s-1>v)for(p=0;s>p;p++)d=O[p][v+1],O[p][v+1]=O[p][v],O[p][v]=d;v++}Q=0,y--}}if(l){var X=L;L=O,O=X}this.m=s,this.n=a,this.s=_,this.U=O,this.V=L}var e=t("../matrix"),i=t("./util").hypotenuse;n.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var t=Math.pow(2,-52),r=Math.max(this.m,this.n)*this.s[0]*t,o=0,n=this.s,e=0,i=n.length;i>e;e++)n[e]>r&&o++;return o},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return e.diag(this.s)},solve:function(t){var r,o=t,n=this.threshold,i=this.s.length,s=e.zeros(i,i);for(r=0;i>r;r++)Math.abs(this.s[r])<=n?s[r][r]=0:s[r][r]=1/this.s[r];var a,u,h,f=this.V.mmul(s),c=this.V.rows,l=this.U.rows,m=e.zeros(c,l);for(r=0;c>r;r++)for(a=0;l>a;a++){for(h=0,u=0;i>u;u++)h+=f[r][u]*this.U[a][u];m[r][a]=h}return m.mmul(o)},solveForDiagonal:function(t){return this.solve(e.diag(t))},inverse:function(){var t,r,o=this.threshold,n=this.V.rows,i=this.V.columns,s=new e(n,this.s.length);for(t=0;n>t;t++)for(r=0;i>r;r++)Math.abs(this.s[r])>o?s[t][r]=this.V[t][r]/this.s[r]:s[t][r]=0;var a,u,h=this.U.rows,f=this.U.columns,c=new e(n,h);for(t=0;n>t;t++)for(r=0;h>r;r++){for(u=0,a=0;f>a;a++)u+=s[t][a]*this.U[r][a];c[t][r]=u}return c}},r.exports=n},{"../matrix":13,"./util":10}],10:[function(t,r,o){"use strict";o.hypotenuse=function(t,r){var o;return Math.abs(t)>Math.abs(r)?(o=r/t,Math.abs(t)*Math.sqrt(1+o*o)):0!==r?(o=t/r,Math.abs(r)*Math.sqrt(1+o*o)):0}},{}],11:[function(t,r,o){"use strict";function n(t){return e(t,i.eye(t.rows))}function e(t,r){return t.isSquare()?new u(t).solve(r):new h(t).solve(r)}var i=t("./matrix"),s=t("./dc/svd"),a=t("./dc/evd"),u=t("./dc/lu"),h=t("./dc/qr"),f=t("./dc/cholesky");i.prototype.inverse=function(){return n(this)},i.prototype.solve=function(t){return e(this,t)},r.exports={SingularValueDecomposition:s,SVD:s,EigenvalueDecomposition:a,EVD:a,LuDecomposition:u,LU:u,QrDecomposition:h,QR:h,CholeskyDecomposition:f,CHO:f,inverse:n,solve:e}},{"./dc/cholesky":5,"./dc/evd":6,"./dc/lu":7,"./dc/qr":8,"./dc/svd":9,"./matrix":13}],12:[function(t,r,o){"use strict";r.exports=t("./matrix"),r.exports.Decompositions=r.exports.DC=t("./decompositions")},{"./decompositions":11,"./matrix":13}],13:[function(t,r,o){"use strict";function n(t){for(var r=0,o=t.length,n=new Array(o);o>r;r++)n[r]=t[r];return n}function e(t,r){var o,i,s=0;if(Array.isArray(t)){if(i=r,o=i?n(t):t,t=o.length,r=o[0].length,"undefined"==typeof r)throw new TypeError("Data must be a 2D array");if(!(t>0&&r>0))throw new RangeError("Invalid dimensions: "+t+"x"+r);for(;t>s;s++){if(o[s].length!==r)throw new RangeError("Inconsistent array dimensions");i&&(o[s]=n(o[s]))}}else{if("number"!=typeof t)throw new TypeError("Invalid arguments");if(!(t>0&&r>0))throw new RangeError("Invalid dimensions: "+t+"x"+r);for(o=new Array(t);t>s;s++)o[s]=new Array(r)}return Object.defineProperty(o,"rows",{writable:!0,value:t}),Object.defineProperty(o,"columns",{writable:!0,value:r}),o.__proto__=e.prototype,o}var i=Array.prototype.splice,s=Array.prototype.concat;e.from1DArray=function(t,r,o){var n,i,s=0;if(n=t*r,n!==o.length)throw new RangeError("Data length does not match given dimensions");for(i=new Array(t);t>s;s++)i[s]=o.slice(s*r,(s+1)*r);return new e(i)},e.rowVector=function(t){return new e([t])},e.columnVector=function(t){for(var r=t.length,o=new Array(r),n=0;r>n;n++)o[n]=[t[n]];return new e(o)},e.empty=function(t,r){return new e(t,r)},e.zeros=function(t,r){return e.empty(t,r).fill(0)},e.ones=function(t,r){return e.empty(t,r).fill(1)},e.rand=function(t,r){for(var o=e.empty(t,r),n=0,i=o.rows;i>n;n++)for(var s=0,a=o.columns;a>s;s++)o[n][s]=Math.random();return o},e.eye=function(t){for(var r=e.zeros(t,t),o=r.rows,n=0;o>n;n++)r[n][n]=1;return r},e.diag=function(t){for(var r=t.length,o=e.zeros(r,r),n=0;r>n;n++)o[n][n]=t[n];return o},e.indices=function(t,r){for(var o=new Array(r-t),n=0;n<o.length;n++)o[n]=t++;return o},e.stack=function(t){var r,o,n;if(e.isMatrix(t)){var i=0,s=0;for(r=0;r<arguments.length;r++)i+=arguments[r].rows,arguments[r].columns>s&&(s=arguments[r].columns);var a=e.zeros(i,s),u=0;for(r=0;r<arguments.length;r++){var h=arguments[r];for(o=0;o<h.rows;o++){for(n=0;n<h.columns;n++)a[u][n]=h[o][n];u++}}return a}if(Array.isArray(t)){var f=e.empty(arguments.length,t.length);for(r=0;r<arguments.length;r++)f.setRow(r,arguments[r]);return f}},e.expand=function(t,r){for(var o=[],n=0;n<r.length;n++)for(var i=0;i<r[n];i++)o.push(t[n]);return new e(o)},e.checkMatrix=function(t){if(!t)throw new TypeError("Argument has to be a matrix");return"Matrix"!==t.klass&&(t=new e(t)),t},e.isMatrix=function(t){return t?"Matrix"===t.klass:!1},Object.defineProperty(e.prototype,"klass",{get:function(){return"Matrix"}}),Object.defineProperty(e.prototype,"size",{get:function(){return this.rows*this.columns}}),e.prototype.checkRowIndex=function(t){if(0>t||t>this.rows-1)throw new RangeError("Row index out of range.")},e.prototype.checkColumnIndex=function(t){if(0>t||t>this.columns-1)throw new RangeError("Column index out of range.")},e.prototype.checkDimensions=function(t){if(this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal.")},e.prototype.apply=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)t.call(this,n,e);return this},e.prototype.clone=function(){return new e(this.to2DArray())},e.prototype.to1DArray=function(){return s.apply([],this)},e.prototype.to2DArray=function(){for(var t=this.rows,r=new Array(t),o=0;t>o;o++)r[o]=n(this[o]);return r},e.prototype.isRowVector=function(){return 1===this.rows},e.prototype.isColumnVector=function(){return 1===this.columns},e.prototype.isVector=function(){return 1===this.rows||1===this.columns},e.prototype.isSquare=function(){return this.rows===this.columns},e.prototype.isSymmetric=function(){if(this.isSquare()){for(var t=this.rows,r=0;t>r;r++)for(var o=0;r>=o;o++)if(this[r][o]!==this[o][r])return!1;return!0}return!1},e.prototype.set=function(t,r,o){return this[t][r]=o,this},e.prototype.get=function(t,r){return this[t][r]},e.prototype.fill=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]=t;return this},e.prototype.neg=function(){return this.mulS(-1)},e.prototype.add=function(t){return"number"==typeof t?this.addS(t):(t=e.checkMatrix(t),this.addM(t))},e.prototype.addS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t;return this},e.prototype.addM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t[n][e];return this},e.prototype.sub=function(t){return"number"==typeof t?this.subS(t):(t=e.checkMatrix(t),this.subM(t))},e.prototype.subS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t;return this},e.prototype.subM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t[n][e];return this},e.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):(t=e.checkMatrix(t),this.mulM(t))},e.prototype.mulS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t;return this},e.prototype.mulM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t[n][e];return this},e.prototype.div=function(t){return"number"==typeof t?this.divS(t):(t=e.checkMatrix(t),this.divM(t))},e.prototype.divS=function(t){for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t;return this},e.prototype.divM=function(t){this.checkDimensions(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t[n][e];return this},e.prototype.getRow=function(t){return this.checkRowIndex(t),n(this[t])},e.prototype.getRowVector=function(t){return e.rowVector(this.getRow(t))},e.prototype.setRow=function(t,r){if(this.checkRowIndex(t),e.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("Invalid row size");return this[t]=n(r),this},e.prototype.removeRow=function(t){if(this.checkRowIndex(t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return i.call(this,t,1),this.rows-=1,this},e.prototype.addRow=function(t,r){if("undefined"==typeof r&&(r=t,t=this.rows),0>t||t>this.rows)throw new RangeError("Row index out of range.");if(e.isMatrix(r)&&(r=r.to1DArray()),r.length!==this.columns)throw new RangeError("Invalid row size");return i.call(this,t,0,n(r)),this.rows+=1,this},e.prototype.swapRows=function(t,r){this.checkRowIndex(t),this.checkRowIndex(r);var o=this[t];return this[t]=this[r],this[r]=o,this},e.prototype.getColumn=function(t){this.checkColumnIndex(t);for(var r=this.rows,o=new Array(r),n=0;r>n;n++)o[n]=this[n][t];return o},e.prototype.getColumnVector=function(t){return e.columnVector(this.getColumn(t))},e.prototype.setColumn=function(t,r){this.checkColumnIndex(t),e.isMatrix(r)&&(r=r.to1DArray());var o=this.rows;if(r.length!==o)throw new RangeError("Invalid column size");for(var n=0;o>n;n++)this[n][t]=r[n];return this},e.prototype.removeColumn=function(t){if(this.checkColumnIndex(t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");
for(var r=0,o=this.rows;o>r;r++)this[r].splice(t,1);return this.columns-=1,this},e.prototype.addColumn=function(t,r){if("undefined"==typeof r&&(r=t,t=this.columns),0>t||t>this.columns)throw new RangeError("Column index out of range.");e.isMatrix(r)&&(r=r.to1DArray());var o=this.rows;if(r.length!==o)throw new RangeError("Invalid column size");for(var n=0;o>n;n++)this[n].splice(t,0,r[n]);return this.columns+=1,this},e.prototype.swapColumns=function(t,r){this.checkRowIndex(t),this.checkRowIndex(r);for(var o,n,e=this.rows,i=0;e>i;i++)n=this[i],o=n[t],n[t]=n[r],n[r]=o;return this},e.prototype.checkRowVector=function(t){if(e.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.columns)throw new RangeError("vector size must be the same as the number of columns");return t},e.prototype.checkColumnVector=function(t){if(e.isMatrix(t)&&(t=t.to1DArray()),t.length!==this.rows)throw new RangeError("vector size must be the same as the number of rows");return t},e.prototype.addRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t[e];return this},e.prototype.subRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t[e];return this},e.prototype.mulRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t[e];return this},e.prototype.divRowVector=function(t){t=this.checkRowVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t[e];return this},e.prototype.addColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]+=t[n];return this},e.prototype.subColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]-=t[n];return this},e.prototype.mulColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]*=t[n];return this},e.prototype.divColumnVector=function(t){t=this.checkColumnVector(t);for(var r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]/=t[n];return this},e.prototype.mulRow=function(t,r){this.checkRowIndex(t);for(var o=0,n=this.columns;n>o;o++)this[t][o]*=r;return this},e.prototype.mulColumn=function(t,r){this.checkColumnIndex(t);for(var o=0,n=this.rows;n>o;o++)this[o][t]*=r},e.prototype.max=function(){for(var t=-(1/0),r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]>t&&(t=this[n][e]);return t},e.prototype.maxIndex=function(){for(var t=-(1/0),r={},o=this.rows,n=this.columns,e=0;o>e;e++)for(var i=0;n>i;i++)this[e][i]>t&&(t=this[e][i],r.row=e,r.column=i);return r},e.prototype.min=function(){for(var t=1/0,r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)this[n][e]<t&&(t=this[n][e]);return t},e.prototype.minIndex=function(){for(var t=1/0,r={},o=this.rows,n=this.columns,e=0;o>e;e++)for(var i=0;n>i;i++)this[e][i]<t&&(t=this[e][i],r.row=e,r.column=i);return r},e.prototype.maxRow=function(t){this.checkRowIndex(t);for(var r=-(1/0),o=0,n=this.columns;n>o;o++)this[t][o]>r&&(r=this[t][o]);return r},e.prototype.maxRowIndex=function(t){this.checkRowIndex(t);for(var r=-(1/0),o={row:t},n=0,e=this.columns;e>n;n++)this[t][n]>r&&(r=this[t][n],o.column=n);return o},e.prototype.minRow=function(t){this.checkRowIndex(t);for(var r=1/0,o=0,n=this.columns;n>o;o++)this[t][o]<r&&(r=this[t][o]);return r},e.prototype.minRowIndex=function(t){this.checkRowIndex(t);for(var r=1/0,o={row:t,column:0},n=0,e=this.columns;e>n;n++)this[t][n]<r&&(r=this[t][n],o.column=n);return o},e.prototype.maxColumn=function(t){this.checkColumnIndex(t);for(var r=-(1/0),o=0,n=this.rows;n>o;o++)this[o][t]>r&&(r=this[o][t]);return r},e.prototype.maxColumnIndex=function(t){this.checkColumnIndex(t);for(var r=-(1/0),o={row:0,column:t},n=0,e=this.rows;e>n;n++)this[n][t]>r&&(r=this[n][t],o.row=n);return o},e.prototype.minColumn=function(t){this.checkColumnIndex(t);for(var r=1/0,o=0,n=this.rows;n>o;o++)this[o][t]<r&&(r=this[o][t]);return r},e.prototype.minColumnIndex=function(t){this.checkColumnIndex(t);for(var r=1/0,o={row:0,column:t},n=0,e=this.rows;e>n;n++)this[n][t]<r&&(r=this[n][t],o.row=n);return o},e.prototype.diag=function a(){if(!this.isSquare())throw new TypeError("Only square matrices have a diagonal.");for(var a=new Array(this.rows),t=0,r=this.rows;r>t;t++)a[t]=this[t][t];return a},e.prototype.sum=function(){for(var t=0,r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)t+=this[n][e];return t},e.prototype.mean=function(){return this.sum()/this.size},e.prototype.prod=function u(){for(var u=1,t=this.rows,r=this.columns,o=0;t>o;o++)for(var n=0;r>n;n++)u*=this[o][n];return u},e.prototype.cumulativeSum=function(){for(var t=0,r=this.rows,o=this.columns,n=0;r>n;n++)for(var e=0;o>e;e++)t+=this[n][e],this[n][e]=t;return this},e.prototype.dot=function h(t){if(this.size!==t.size)throw new RangeError("vectors do not have the same size");for(var r=this.to1DArray(),o=t.to1DArray(),h=0,n=r.length,e=0;n>e;e++)h+=r[e]*o[e];return h},e.prototype.mmul=function(t){if(!e.isMatrix(t))throw new TypeError('parameter "other" must be a matrix');this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var r,o,n,i=this.rows,s=this.columns,a=t.columns,u=new e(i,a),h=new Array(s);for(o=0;a>o;o++){for(n=0;s>n;n++)h[n]=t[n][o];for(r=0;i>r;r++){var f=this[r],c=0;for(n=0;s>n;n++)c+=f[n]*h[n];u[r][o]=c}}return u},e.prototype.sortRows=function(t){for(var r=0,o=this.rows;o>r;r++)this[r].sort(t);return this},e.prototype.sortColumns=function(t){for(var r=0,o=this.columns;o>r;r++)this.setColumn(r,this.getColumn(r).sort(t));return this},e.prototype.transpose=function(){for(var t=new e(this.columns,this.rows),r=this.rows,o=this.columns,n=0;r>n;n++)for(var i=0;o>i;i++)t[i][n]=this[n][i];return t},e.prototype.subMatrix=function(t,r,o,n){if(t>r||o>n||0>t||t>=this.rows||0>r||r>=this.rows||0>o||o>=this.columns||0>n||n>=this.columns)throw new RangeError("Argument out of range");for(var i=new e(r-t+1,n-o+1),s=t;r>=s;s++)for(var a=o;n>=a;a++)i[s-t][a-o]=this[s][a];return i},e.prototype.subMatrixRow=function(t,r,o){if("undefined"==typeof r?(r=0,o=this.columns-1):"undefined"==typeof o&&(o=this.columns-1),r>o||0>r||r>=this.columns||0>o||o>=this.columns)throw new RangeError("Argument out of range.");for(var n=t.length,i=this.rows,s=new e(n,o-r+1),a=0;n>a;a++)for(var u=r;o>=u;u++){if(t[a]<0||t[a]>=i)throw new RangeError("Argument out of range.");s[a][u-r]=this[t[a]][u]}return s},e.prototype.subMatrixColumn=function(t,r,o){if("undefined"==typeof r?(r=0,o=this.rows-1):"undefined"==typeof o&&(o=this.rows-1),r>o||0>r||r>=this.rows||0>o||o>=this.rows)throw new RangeError("Argument out of range.");for(var n=t.length,i=this.columns,s=new e(o-r+1,n),a=0;n>a;a++)for(var u=r;o>=u;u++){if(t[a]<0||t[a]>=i)throw new RangeError("Argument out of range.");s[u-r][a]=this[u][t[a]]}return s},e.prototype.trace=function f(){if(!this.isSquare())throw new TypeError("The matrix is not square");for(var f=0,t=0,r=this.rows;r>t;t++)f+=this[t][t];return f},e.prototype.abs=function(){for(var t=this.rows,r=this.columns,o=0;t>o;o++)for(var n=0;r>n;n++)this[o][n]=Math.abs(this[o][n])},r.exports=e},{}],14:[function(t,r,o){"use strict";function n(t,r,o){var n,e,i,s,a=r.length/3,u=t.rows,h=m.zeros(t.length,1);for(e=0;a>e;e++)for(s=Math.pow(r[e+2*a][0]/2,2),n=r[e+a][0]*s,i=0;u>i;i++)h[i][0]+=n/(Math.pow(t[i][0]-r[e][0],2)+s);return h}function e(t,r,o){for(var n=r[1][0]*Math.pow(r[2][0]/2,2),e=t.rows,i=new m(t.rows,t.columns),s=0;e>s;s++)i[s][0]=n/(Math.pow(t[s][0]-r[0][0],2)+Math.pow(r[2][0]/2,2));return i}function i(t,r,o){for(var n=r[2][0]*r[2][0]/2,e=t.rows,i=new m(t.rows,t.columns),s=0;e>s;s++)i[s][0]=r[1][0]*Math.exp(-(t[s][0]-r[0][0])*(t[s][0]-r[0][0])/n);return i}function s(t,r,o){var n=f(t),i=n[0],s=n[1],a=n[2],u=i.columns,h=[u/Math.sqrt(s.dot(s))],o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,1]),l=[],p=Math.abs(i[0][0]-i[1][0]),w=new m([[-p/1e4],[-.001],[-p/1e4]]),v=new m([[r.x],[1],[r.width]]),y=new m([[r.x-p],[.75],[r.width/4]]),d=new m([[r.x+p],[1.25],[4*r.width]]),b=c.optimize(e,v,i,s,h,w,y,d,l,o);return b=b.p,[b[0],[b[1][0]*a],b[2]]}function a(t,r,o){var n=f(t),e=n[0],s=n[1],a=n[2],u=e.columns,h=[u/Math.sqrt(s.dot(s))],o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,1]),l=[],p=Math.abs(e[0][0]-e[1][0]),w=new m([[-p/1e4],[-.001],[-p/1e4]]),w=new m([[-Math.abs(e[0][0]-e[1][0])/1e3],[-.001],[-r.width/1e3]]),v=new m([[r.x],[1],[r.width]]),y=new m([[r.x-p],[.75],[r.width/4]]),d=new m([[r.x+p],[1.25],[4*r.width]]),b=c.optimize(i,v,e,s,h,w,y,d,l,o);return b=b.p,[b[0],[b[1][0]*a],b[2]]}function u(t,r,o){var e,i=f(t),s=i[0],a=i[1],u=i[2],h=s.columns,p=[h/l.sqrt(a.dot(a))],o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,1]),w=[],v=r.length,y=new m(3*v,1),d=new m(3*v,1),b=new m(3*v,1),M=new m(3*v,1),g=Math.abs(s[0][0]-s[1][0]);for(e=0;v>e;e++)y[e][0]=r[e].x,y[e+v][0]=1,y[e+2*v][0]=r[e].width,d[e][0]=r[e].x-g,d[e+v][0]=0,d[e+2*v][0]=r[e].width/4,b[e][0]=r[e].x+g,b[e+v][0]=1.5,b[e+2*v][0]=4*r[e].width,M[e][0]=-g/1e3,M[e+v][0]=-.001,M[e+2*v][0]=-g/1e3;var M=-Math.abs(s[0][0]-s[1][0])/1e4,x=c.optimize(n,y,s,a,p,M,d,b,w,o);x=x.p;var R=new Array(v);for(e=0;v>e;e++)R[e]=[x[e],[x[e+v][0]*u],x[e+2*v]];return R}function h(t,r,o){var e,i=f(t),s=i[0],a=i[1],u=i[2],h=s.rows,p=new m(h,1),w=h/l.sqrt(a.dot(a));for(e=0;h>e;e++)p[e][0]=w;var o=Object.create(o||[3,100,.001,.001,.001,.01,.01,11,9,2]),v=[],y=r.length,d=new m(3*y,1),b=new m(3*y,1),M=new m(3*y,1),g=new m(3*y,1),x=Math.abs(s[0][0]-s[1][0]);for(e=0;y>e;e++)d[e][0]=r[e].x,d[e+y][0]=r[e].y/u,d[e+2*y][0]=r[e].width,b[e][0]=r[e].x-x,b[e+y][0]=.8*r[e].y/u,b[e+2*y][0]=r[e].width/2,M[e][0]=r[e].x+x,M[e+y][0]=1.2*r[e].y/u,M[e+2*y][0]=2*r[e].width,g[e][0]=-x/1e3,g[e+y][0]=-.001,g[e+2*y][0]=-x/1e3;var R=c.optimize(n,d,s,a,p,g,b,M,v,o);R=R.p;var k=new Array(y);for(e=0;y>e;e++)k[e]=[R[e],[R[e+y][0]*u],R[e+2*y]];return k}function f(t){var r,o,n,e=t.length,i=null,s=null,a=0;if(2==e){var u=t[0].length;if(3>u)throw new SizeException(u);if(i=new m(u,1),s=new m(u,1),r=t[0],o=t[1],"number"==typeof r[0])for(n=0;u>n;n++)i[n][0]=r[n],s[n][0]=o[n],o[n]>a&&(a=o[n]);else if("object"==typeof r[0])for(n=0;u>n;n++)i[n][0]=r[n][0],s[n][0]=o[n][0],o[n][0]>a&&(a=o[n][0])}else{var u=e;if(3>u)throw new SizeException(u);for(i=new m(u,1),s=new m(u,1),n=0;u>n;n++)i[n][0]=t[n][0],s[n][0]=t[n][1],s[n][0]>a&&(a=s[n][0])}for(n=0;u>n;n++)s[n][0]/=a;return[i,s,a]}var c=t("ml-curve-fitting"),l=c.Matrix.algebra,m=t("ml-matrix");r.exports.optimizeSingleLorentzian=s,r.exports.optimizeLorentzianSum=u,r.exports.optimizeSingleGaussian=a,r.exports.optimizeGaussianSum=h,r.exports.singleGaussian=i,r.exports.singleLorentzian=e},{"ml-curve-fitting":4,"ml-matrix":12}],15:[function(t,r,o){function n(t,r,o){var o=Object.create(o||{});if(void 0===o.minMaxRatio&&(o.minMaxRatio=25e-5),void 0===o.broadRatio&&(o.broadRatio=0),void 0===o.noiseLevel&&(o.noiseLevel=0),void 0===o.maxCriteria&&(o.maxCriteria=!0),void 0===o.smoothY&&(o.smoothY=!0),o.noiseLevel>0){r=[].concat(r);for(var n=0;n<r.length;n++)Math.abs(r[n])<o.noiseLevel&&(r[n]=0)}for(var s=[],a=t.length-4,u=new Array(a),h=new Array(a),f=new Array(a),c=t[1]-t[0],l=2;a+2>l;l++)c=t[l]-t[l-1],o.smoothY?u[l-2]=1/35*(-3*r[l-2]+12*r[l-1]+17*r[l]+12*r[l+1]-3*r[l+2]):u[l-2]=r[l],s[l-2]=t[l],h[l-2]=1/(12*c)*(r[l-2]-8*r[l-1]+8*r[l+1]-r[l+2]),f[l-2]=1/(7*c*c)*(2*r[l-2]-r[l-1]-2*r[l]-r[l+1]+2*r[l+2]);for(var m=0,p=0,n=0;n<u.length;n++)Math.abs(f[n])>m&&(m=Math.abs(f[n])),Math.abs(u[n])>p&&(p=Math.abs(u[n]));for(var w=[],v=[],y=null,d=null,b=new Array,n=1;n<u.length-1;n++)(h[n]<h[n-1]&&h[n]<=h[n+1]||h[n]<=h[n-1]&&h[n]<h[n+1])&&(d=s[n],c>0&&null!=y&&v.push([y,d])),(h[n]>=h[n-1]&&h[n]>h[n+1]||h[n]>h[n-1]&&h[n]>=h[n+1])&&(y=s[n],0>c&&null!=d&&v.push([y,d])),o.maxCriteria?f[n]<f[n-1]&&f[n]<f[n+1]&&(w.push([s[n],u[n],n]),Math.abs(f[n])>o.broadRatio*m?b.push(!1):b.push(!0)):f[n]>f[n-1]&&f[n]>f[n+1]&&(w.push([s[n],u[n],n]),Math.abs(f[n])>o.broadRatio*m?b.push(!1):b.push(!0));e(w,s,u);for(var M=[],l=0;l<w.length;l++){for(var g=w[l],x=g[0],R=[],k=0;k<v.length;k++){var n=v[k];Math.abs(x-(n[0]+n[1])/2)<Math.abs(n[0]-n[1])/2&&R.push(n)}if(R.length>0&&1==R.length){var z=R[0],A=Math.abs(z[1]-z[0]),C=g[1];Math.abs(C)>o.minMaxRatio*p&&M.push({x:x,y:C,width:A})}}if(o.broadRatio>0)for(var j=[[Number.MAX_VALUE,0,0]],E=0,V=0,q=0,S=[],D=!1,n=j.length-1;n>0;n--)if(Math.abs(j[n-1][0]-j[n][0])<rangeX)S.push(j[n]),j[n][1]>E&&(E=j[n][1],V=n),q++;else{if(D=!0,q>30&&(D=!1),D)for(var l=0;l<S.length;l++)M.push([S[l][0],S[l][1],c]);else{var I=i.optimizeSingleLorentzian(S);M.push(I)}S=[],E=0,V=0,q=0}return M.sort(function(t,r){return t.x-r.x}),M}function e(t,r,o){for(var n,e,i,s,a,u=0;u<t.length;u++)a=t[u][2],o[a-1]>=o[a-2]&&o[a-1]>=o[a]?a--:o[a+1]>=o[a]&&o[a+1]>=o[a+2]?a++:o[a-2]>=o[a-3]&&o[a-2]>=o[a-1]?a-=2:o[a+2]>=o[a+1]&&o[a+2]>=o[a+3]&&(a+=2),o[a-1]>0&&o[a+1]>0&&o[a]>=o[a-1]&&o[a]>=o[a+1]&&(n=20*Math.log10(o[a-1]),e=20*Math.log10(o[a]),i=20*Math.log10(o[a+1]),s=.5*(n-i)/(n-2*e+i),t[u][0]=r[a]+(r[a]-r[a-1])*s,t[u][1]=o[a]-.25*(o[a-1]-[a+1])*s)}var i=t("../src/optimize");r.exports=n},{"../src/optimize":16}],16:[function(t,r,o){function n(t,r,o,n,e){for(var i=o.length,s=[],a=[],u=Math.sign(o[1]-o[0]),h=(r-t)/2,f=(t+r)/2,c=!1,l=e[0];!c&&i>l;)Math.abs(o[l]-f)<=h?(s.push(o[l]),a.push(n[l]),l++):Math.sign(f-o[l])==u?l++:c=!0;return e[0]=l,[s,a]}function e(t,r,o,e,a){var u,h,f=[0],c=i(t,e),l=[];for(u=0;u<c.length;u++){var m=c[u].group;if(m.length>1){var p=n(c[u].limits[0]-c[u].limits[1],c[u].limits[0]+c[u].limits[1],r,o,f);if(p[0].length>5){var w=m[0].width/1e3,v=[3,100,w,w,w,10*w,10*w,11,9,1],y=[];for("gaussian"==a?y=s.optimizeGaussianSum(p,m,v):"lorentzian"==a&&(y=s.optimizeLorentzianSum(p,m,v)),h=0;h<y.length;h++)l.push({x:y[h][0],y:y[h][1],width:y[h][2]})}}else{m=m[0];var p=n(m.x-e*m.width,m.x+e*m.width,r,o,f);if(p[0].length>5){var w=m.width/1e3,v=[3,100,w,w,w,10*w,10*w,11,9,1],d=[];if("gaussian"==a)var d=s.optimizeSingleGaussian([p[0],p[1]],m,v);else if("lorentzian"==a)var d=s.optimizeSingleLorentzian([p[0],p[1]],m,v);l.push({x:d[0],y:d[1],width:d[2]})}}}return l}function i(t,r){var o,n,e,i,s=[],a=[],u=[t[0].x,r*t[0].width];for(o=0;o<t.length;o++)Math.abs(t[o].x-u[0])<r*t[o].width+u[1]?(s.push(t[o]),e=u[0]+u[1],t[o].x+r*t[o].width>e&&(e=t[o].x+r*t[o].width),i=u[0]-u[1],t[o].x-r*t[o].width<i&&(i=t[o].x-r*t[o].width),u=[(e+i)/2,Math.abs(e-i)/2]):(a.push({limits:u,group:s}),s=[t[o]],u=[t[o].x,r*t[o].width]);for(a.push({limits:u,group:s}),o=a.length-2;o>=0;o--)if(Math.abs(a[o].limits[0]-a[o+1].limits[0])<(a[o].limits[1]+a[o+1].limits[1])/2){for(n=0;n<a[o+1].group.length;n++)a[o].group.push(a[o+1].group[n]);e=a[o].limits[0]+a[o].limits[1],a[o+1].limits[0]+a[o+1].limits[1]>e&&(e=a[o+1].limits[0]+a[o+1].limits[1]),i=a[o].limits[0]-a[o].limits[1],a[o+1].limits[0]-a[o+1].limits[1]<i&&(i=a[o+1].limits[0]-a[o+1].limits[1]),a[o].limits=[(e+i)/2,Math.abs(e-i)/2],a.splice(o+1,1)}return a}var s=t("ml-optimize-lorentzian");r.exports=e},{"ml-optimize-lorentzian":14}]},{},[1])(1)});
//# sourceMappingURL=ml-gsd.min.js.map